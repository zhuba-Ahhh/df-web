var __defProp=Object.defineProperty,__typeError=t=>{throw TypeError(t)},__defNormalProp=(t,e,r)=>e in t?__defProp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,__publicField=(t,e,r)=>__defNormalProp(t,"symbol"!=typeof e?e+"":e,r),__accessCheck=(t,e,r)=>e.has(t)||__typeError("Cannot "+r),__privateGet=(t,e,r)=>(__accessCheck(t,e,"read from private field"),r?r.call(t):e.get(t)),__privateAdd=(t,e,r)=>e.has(t)?__typeError("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),__privateSet=(t,e,r,n)=>(__accessCheck(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),__privateMethod=(t,e,r)=>(__accessCheck(t,e,"access private method"),r);!function(){"use strict";var t,e,r,n;function o(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{u(n.next(t))}catch(e){i(e)}}function a(t){try{u(n.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}u((n=n.apply(t,e||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;var i=function(){function t(){this._events={}}return t.prototype.on=function(t,e,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!r}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this._events[t]||[],i=this._events["*"]||[],s=function(n){for(var o=n.length,i=0;i<o;i++)if(n[i]){var s=n[i],a=s.callback;s.once&&(n.splice(i,1),0===n.length&&delete e._events[t],o--,i--),a.apply(e,r)}};s(o),s(i)},t.prototype.off=function(t,e){if(t)if(e){for(var r=this._events[t]||[],n=r.length,o=0;o<n;o++)r[o].callback===e&&(r.splice(o,1),n--,o--);0===r.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function s(t,e,r,n){for(;t.length;){const o=t.shift();if(r(o))return!0;e.add(o.id),n(o.id).forEach((r=>{e.has(r.id)||(e.add(r.id),t.push(r))}))}return!1}function a(t,e,r,n){if(r(t))return!0;e.add(t.id);for(const o of n(t.id))if(!e.has(o.id)&&a(o,e,r,n))return!0;return!1}const u=()=>!0;class c{constructor(t){__publicField(this,"graph"),__publicField(this,"nodeFilter"),__publicField(this,"edgeFilter"),__publicField(this,"cacheEnabled"),__publicField(this,"inEdgesMap",new Map),__publicField(this,"outEdgesMap",new Map),__publicField(this,"bothEdgesMap",new Map),__publicField(this,"allNodesMap",new Map),__publicField(this,"allEdgesMap",new Map),__publicField(this,"clearCache",(()=>{this.inEdgesMap.clear(),this.outEdgesMap.clear(),this.bothEdgesMap.clear(),this.allNodesMap.clear(),this.allEdgesMap.clear()})),__publicField(this,"refreshCache",(()=>{this.clearCache(),this.updateCache(this.graph.getAllNodes().map((t=>t.id)))})),__publicField(this,"updateCache",(t=>{const e=new Set;t.forEach((t=>{const r=this.bothEdgesMap.get(t);if(r&&r.forEach((t=>e.add(t.id))),this.hasNode(t)){const r=this.graph.getRelatedEdges(t,"in").filter(this.edgeFilter),n=this.graph.getRelatedEdges(t,"out").filter(this.edgeFilter),o=Array.from(new Set([...r,...n]));o.forEach((t=>e.add(t.id))),this.inEdgesMap.set(t,r),this.outEdgesMap.set(t,n),this.bothEdgesMap.set(t,o),this.allNodesMap.set(t,this.graph.getNode(t))}else this.inEdgesMap.delete(t),this.outEdgesMap.delete(t),this.bothEdgesMap.delete(t),this.allNodesMap.delete(t)})),e.forEach((t=>{this.hasEdge(t)?this.allEdgesMap.set(t,this.graph.getEdge(t)):this.allEdgesMap.delete(t)}))})),__publicField(this,"handleGraphChanged",(t=>{const e=new Set;t.changes.forEach((r=>{switch(r.type){case"NodeAdded":case"NodeRemoved":e.add(r.value.id);break;case"NodeDataUpdated":e.add(r.id);break;case"EdgeAdded":case"EdgeRemoved":e.add(r.value.source),e.add(r.value.target);break;case"EdgeUpdated":"source"!==r.propertyName&&"target"!==r.propertyName||(e.add(r.oldValue),e.add(r.newValue));break;case"EdgeDataUpdated":if(t.graph.hasEdge(r.id)){const n=t.graph.getEdge(r.id);e.add(n.source),e.add(n.target)}}})),this.updateCache(e)})),this.graph=t.graph;const e=t.nodeFilter||u,r=t.edgeFilter||u;this.nodeFilter=e,this.edgeFilter=t=>{const{source:n,target:o}=this.graph.getEdgeDetail(t.id);return!(!e(n)||!e(o))&&r(t,n,o)},"auto"===t.cache?(this.cacheEnabled=!0,this.startAutoCache()):"manual"===t.cache?this.cacheEnabled=!0:this.cacheEnabled=!1}startAutoCache(){this.refreshCache(),this.graph.on("changed",this.handleGraphChanged)}stopAutoCache(){this.graph.off("changed",this.handleGraphChanged)}checkNodeExistence(t){this.getNode(t)}hasNode(t){if(!this.graph.hasNode(t))return!1;const e=this.graph.getNode(t);return this.nodeFilter(e)}areNeighbors(t,e){return this.checkNodeExistence(t),this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.graph.getNode(t);if(!this.nodeFilter(e))throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),this.cacheEnabled)return"in"===e?this.inEdgesMap.get(t):"out"===e?this.outEdgesMap.get(t):this.bothEdgesMap.get(t);return this.graph.getRelatedEdges(t,e).filter(this.edgeFilter)}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),r=this.getSuccessors(t);return Array.from(new Set([...e,...r]))}hasEdge(t){if(!this.graph.hasEdge(t))return!1;const e=this.graph.getEdge(t);return this.edgeFilter(e)}getEdge(t){const e=this.graph.getEdge(t);if(!this.edgeFilter(e))throw new Error("Edge not found for id: "+t);return e}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}hasTreeStructure(t){return this.graph.hasTreeStructure(t)}getRoots(t){return this.graph.getRoots(t).filter(this.nodeFilter)}getChildren(t,e){return this.checkNodeExistence(t),this.graph.getChildren(t,e).filter(this.nodeFilter)}getParent(t,e){this.checkNodeExistence(t);const r=this.graph.getParent(t,e);return r&&this.nodeFilter(r)?r:null}getAllNodes(){return this.cacheEnabled?Array.from(this.allNodesMap.values()):this.graph.getAllNodes().filter(this.nodeFilter)}getAllEdges(){return this.cacheEnabled?Array.from(this.allEdgesMap.values()):this.graph.getAllEdges().filter(this.edgeFilter)}bfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];s([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];a(this.getNode(t),new Set,e,n)}}let h=class t extends i{constructor(t){super(),__publicField(this,"nodeMap",new Map),__publicField(this,"edgeMap",new Map),__publicField(this,"inEdgesMap",new Map),__publicField(this,"outEdgesMap",new Map),__publicField(this,"bothEdgesMap",new Map),__publicField(this,"treeIndices",new Map),__publicField(this,"changes",[]),__publicField(this,"batchCount",0),__publicField(this,"onChanged",(()=>{})),__publicField(this,"batch",(t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()})),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach((t=>{switch(t.type){case"NodeRemoved":{let r=!1;e=e.filter((e=>{if("NodeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),r||e.push(t);break}case"EdgeRemoved":{let r=!1;e=e.filter((e=>{if("EdgeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),r||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const r=e.findIndex((e=>e.type===t.type&&e.id===t.id&&(void 0===t.propertyName||e.propertyName===t.propertyName))),n=e[r];n?void 0!==t.propertyName?n.newValue=t.newValue:(e.splice(r,1),e.push(t)):e.push(t);break}case"TreeStructureDetached":e=e.filter((e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)),e.push(t);break;case"TreeStructureChanged":{const r=e.find((e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId));r?r.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}})),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),r=this.getSuccessors(t);return Array.from(new Set([...e,...r]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((e=>{e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch((()=>{for(const e of t)this.doAddNode(e)}))}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),r=this.bothEdgesMap.get(t);null==r||r.forEach((t=>this.doRemoveEdge(t.id))),this.nodeMap.delete(t),this.treeIndices.forEach((r=>{var n,o;null==(n=r.childrenMap.get(t))||n.forEach((t=>{r.parentMap.delete(t.id)}));const i=r.parentMap.get(t);i&&(null==(o=r.childrenMap.get(i.id))||o.delete(e)),r.parentMap.delete(t),r.childrenMap.delete(t)})),this.bothEdgesMap.delete(t),this.inEdgesMap.delete(t),this.outEdgesMap.delete(t),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch((()=>{t.forEach((t=>this.doRemoveNode(t)))}))}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,r){const n=this.getNode(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}mergeNodeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateNodeDataProperty(t,e,r)}))}))}updateNodeData(...t){const e=t[0],r=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:o})}))}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),r=this.outEdgesMap.get(t.source),n=this.bothEdgesMap.get(t.source),o=this.bothEdgesMap.get(t.target);e.add(t),r.add(t),n.add(t),o.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch((()=>{for(const e of t)this.doAddEdge(e)}))}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),r=this.outEdgesMap.get(e.source),n=this.inEdgesMap.get(e.target),o=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);r.delete(e),n.delete(e),o.delete(e),i.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch((()=>{t.forEach((t=>this.doRemoveEdge(t)))}))}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.source,o=e;this.outEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.outEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.source=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:n,newValue:o})}))}updateEdgeTarget(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.target,o=e;this.inEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.inEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.target=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:n,newValue:o})}))}updateEdgeDataProperty(t,e,r){const n=this.getEdge(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}updateEdgeData(...t){const e=t[0],r=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:o})}))}mergeEdgeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateEdgeDataProperty(t,e,r)}))}))}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})})))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})}))}addTree(t,e){this.batch((()=>{this.attachTreeStructure(e);const r=[],n=Array.isArray(t)?t:[t];for(;n.length;){const t=n.shift();r.push(t),t.children&&n.push(...t.children)}this.addNodes(r),r.forEach((t=>{var r;null==(r=t.children)||r.forEach((r=>{this.setParent(r.id,t.id,e)}))}))}))}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter((e=>!this.getParent(e.id,t)))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const r=this.treeIndices.get(e).childrenMap.get(t);return Array.from(r||[])}getParent(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);return this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const r=[];let n,o=this.getNode(t);for(;n=this.getParent(o.id,e);)r.push(n),o=n;return r}setParent(t,e,r){var n,o;this.checkTreeExistence(r);const i=this.treeIndices.get(r);if(!i)return;const s=this.getNode(t),a=i.parentMap.get(t);if((null==a?void 0:a.id)===e)return;if(null==e)return a&&(null==(n=i.childrenMap.get(a.id))||n.delete(s)),void i.parentMap.delete(t);const u=this.getNode(e);i.parentMap.set(t,u),a&&(null==(o=i.childrenMap.get(a.id))||o.delete(s));let c=i.childrenMap.get(u.id);c||(c=new Set,i.childrenMap.set(u.id,c)),c.add(s),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:r,nodeId:t,oldParentId:null==a?void 0:a.id,newParentId:u.id})}))}dfsTree(t,e,r){return a(this.getNode(t),new Set,e,(t=>this.getChildren(t,r)))}bfsTree(t,e,r){return s([this.getNode(t)],new Set,e,(t=>this.getChildren(t,r)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return s([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return a(this.getNode(t),new Set,e,n)}clone(){const e=this.getAllNodes().map((t=>({...t,data:{...t.data}}))),r=this.getAllEdges().map((t=>({...t,data:{...t.data}}))),n=new t({nodes:e,edges:r});return this.treeIndices.forEach((({parentMap:t,childrenMap:e},r)=>{const o=new Map;t.forEach(((t,e)=>{o.set(e,n.getNode(t.id))}));const i=new Map;e.forEach(((t,e)=>{i.set(e,new Set(Array.from(t).map((t=>n.getNode(t.id)))))})),n.treeIndices.set(r,{parentMap:o,childrenMap:i})})),n}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}createView(t){return new c({graph:this,...t})}};
/**
   * @license
   * Copyright 2019 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */const d=Symbol("Comlink.proxy"),l=Symbol("Comlink.endpoint"),f=Symbol("Comlink.releaseProxy"),g=Symbol("Comlink.finalizer"),p=Symbol("Comlink.thrown"),v=t=>"object"==typeof t&&null!==t||"function"==typeof t,y=new Map([["proxy",{canHandle:t=>v(t)&&t[d],serialize(t){const{port1:e,port2:r}=new MessageChannel;return m(t,e),[r,[r]]},deserialize:t=>(t.start(),function(t,e){const r=new Map;return t.addEventListener("message",(function(t){const{data:e}=t;if(!e||!e.id)return;const n=r.get(e.id);if(n)try{n(e)}finally{r.delete(e.id)}})),_(t,r,[],e)}(t))}],["throw",{canHandle:t=>v(t)&&p in t,serialize({value:t}){let e;return e=t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[e,[]]},deserialize(t){if(t.isError)throw Object.assign(new Error(t.value.message),t.value);throw t.value}}]]);function m(t,e=globalThis,r=["*"]){e.addEventListener("message",(function n(o){if(!o||!o.data)return;if(!function(t,e){for(const r of t){if(e===r||"*"===r)return!0;if(r instanceof RegExp&&r.test(e))return!0}return!1}(r,o.origin))return;const{id:i,type:s,path:a}=Object.assign({path:[]},o.data),u=(o.data.argumentList||[]).map(j);let c;try{const e=a.slice(0,-1).reduce(((t,e)=>t[e]),t),r=a.reduce(((t,e)=>t[e]),t);switch(s){case"GET":c=r;break;case"SET":e[a.slice(-1)[0]]=j(o.data.value),c=!0;break;case"APPLY":c=r.apply(e,u);break;case"CONSTRUCT":c=function(t){return Object.assign(t,{[d]:!0})}(new r(...u));break;case"ENDPOINT":{const{port1:e,port2:r}=new MessageChannel;m(t,r),c=function(t,e){return k.set(t,e),t}(e,[e])}break;case"RELEASE":c=void 0;break;default:return}}catch(h){c={value:h,[p]:0}}Promise.resolve(c).catch((t=>({value:t,[p]:0}))).then((r=>{const[o,a]=A(r);e.postMessage(Object.assign(Object.assign({},o),{id:i}),a),"RELEASE"===s&&(e.removeEventListener("message",n),w(e),g in t&&"function"==typeof t[g]&&t[g]())})).catch((t=>{const[r,n]=A({value:new TypeError("Unserializable return value"),[p]:0});e.postMessage(Object.assign(Object.assign({},r),{id:i}),n)}))})),e.start&&e.start()}function w(t){(function(t){return"MessagePort"===t.constructor.name})(t)&&t.close()}function b(t){if(t)throw new Error("Proxy has been released and is not useable")}function x(t){return S(t,new Map,{type:"RELEASE"}).then((()=>{w(t)}))}const E=new WeakMap,N="FinalizationRegistry"in globalThis&&new FinalizationRegistry((t=>{const e=(E.get(t)||0)-1;E.set(t,e),0===e&&x(t)}));function _(t,e,r=[],n=function(){}){let o=!1;const i=new Proxy(n,{get(n,s){if(b(o),s===f)return()=>{!function(t){N&&N.unregister(t)}(i),x(t),e.clear(),o=!0};if("then"===s){if(0===r.length)return{then:()=>i};const n=S(t,e,{type:"GET",path:r.map((t=>t.toString()))}).then(j);return n.then.bind(n)}return _(t,e,[...r,s])},set(n,i,s){b(o);const[a,u]=A(s);return S(t,e,{type:"SET",path:[...r,i].map((t=>t.toString())),value:a},u).then(j)},apply(n,i,s){b(o);const a=r[r.length-1];if(a===l)return S(t,e,{type:"ENDPOINT"}).then(j);if("bind"===a)return _(t,e,r.slice(0,-1));const[u,c]=M(s);return S(t,e,{type:"APPLY",path:r.map((t=>t.toString())),argumentList:u},c).then(j)},construct(n,i){b(o);const[s,a]=M(i);return S(t,e,{type:"CONSTRUCT",path:r.map((t=>t.toString())),argumentList:s},a).then(j)}});return function(t,e){const r=(E.get(e)||0)+1;E.set(e,r),N&&N.register(t,e,t)}(i,t),i}function M(t){const e=t.map(A);return[e.map((t=>t[0])),(r=e.map((t=>t[1])),Array.prototype.concat.apply([],r))];var r}const k=new WeakMap;function A(t){for(const[e,r]of y)if(r.canHandle(t)){const[n,o]=r.serialize(t);return[{type:"HANDLER",name:e,value:n},o]}return[{type:"RAW",value:t},k.get(t)||[]]}function j(t){switch(t.type){case"HANDLER":return y.get(t.name).deserialize(t.value);case"RAW":return t.value}}function S(t,e,r,n){return new Promise((o=>{const i=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.set(i,o),t.start&&t.start(),t.postMessage(Object.assign({id:i},r),n)}))}function O(t){return"function"==typeof t}function z(t){return Array.isArray(t)}var R=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};var I={}.toString,C=function(t){if(!function(t){return"object"==typeof t&&null!==t}(t)||!function(t,e){return I.call(t)==="[object "+e+"]"}(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e};function P(t){return"string"==typeof t}function D(t){return"number"==typeof t}var T=function(t){if("object"!=typeof t||null===t)return t;var e;if(z(t)){e=[];for(var r=0,n=t.length;r<n;r++)"object"==typeof t[r]&&null!=t[r]?e[r]=T(t[r]):e[r]=t[r]}else for(var o in e={},t)"object"==typeof t[o]&&null!=t[o]?e[o]=T(t[o]):e[o]=t[o];return e};function F(t,e){if(Object.hasOwn)return Object.hasOwn(t,e);if(null==t)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(t),e)}function L(t,e,r,n){for(var o in r=r||0,n=n||5,e)if(F(e,o)){var i=e[o];null!==i&&C(i)?(C(t[o])||(t[o]={}),r<n?L(t[o],i,r+1,n):t[o]=e[o]):z(i)?(t[o]=[],t[o]=t[o].concat(i)):void 0!==i&&(t[o]=i)}}var q=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=0;n<e.length;n+=1)L(t,e[n]);return t},V=Object.prototype.hasOwnProperty,G=function(t,e){if(null===t||!C(t))return{};var r={};return function(t,e){if(t)if(z(t))for(var r=0,n=t.length;r<n&&!1!==e(t[r],r);r++);else if(R(t))for(var o in t)if(t.hasOwnProperty(o)&&!1===e(t[o],o))break}(e,(function(e){V.call(t,e)&&(r[e]=t[e])})),r};const B=(t,e)=>{if("next"!==t&&"prev"!==t)return e},U=t=>{t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev};let $=class{constructor(){const t={};t.prev=t,t.next=t.prev,this.shortcut=t}dequeue(){const t=this.shortcut,e=t.prev;if(e&&e!==t)return U(e),e}enqueue(t){const e=this.shortcut;t.prev&&t.next&&U(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e}toString(){const t=[],e=this.shortcut;let r=e.prev;for(;r!==e;)t.push(JSON.stringify(r,B)),r=null==r?void 0:r.prev;return`[${t.join(", ")}]`}},W=class extends ${};const Y=()=>1,H=(t,e,r)=>{let n=[];const o=e[e.length-1],i=e[0];let s;for(;t.getAllNodes().length;){for(;s=i.dequeue();)K(t,e,r,s);for(;s=o.dequeue();)K(t,e,r,s);if(t.getAllNodes().length)for(let o=e.length-2;o>0;--o)if(s=e[o].dequeue(),s){n=n.concat(K(t,e,r,s,!0));break}}return n},K=(t,e,r,n,o)=>{var i,s;const a=[];return t.hasNode(n.v)&&(null===(i=t.getRelatedEdges(n.v,"in"))||void 0===i||i.forEach((n=>{const i=n.data.weight,s=t.getNode(n.source);o&&a.push({v:n.source,w:n.target,in:0,out:0}),void 0===s.data.out&&(s.data.out=0),s.data.out-=i,Q(e,r,Object.assign({v:s.id},s.data))})),null===(s=t.getRelatedEdges(n.v,"out"))||void 0===s||s.forEach((n=>{const o=n.data.weight,i=n.target,s=t.getNode(i);void 0===s.data.in&&(s.data.in=0),s.data.in-=o,Q(e,r,Object.assign({v:s.id},s.data))})),t.removeNode(n.v)),o?a:void 0},J=(t,e)=>{const r=new h;let n=0,o=0;t.getAllNodes().forEach((t=>{r.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((t=>{const i=r.getRelatedEdges(t.source,"out").find((e=>e.target===t.target)),s=(null==e?void 0:e(t))||1;i?r.updateEdgeData(null==i?void 0:i.id,Object.assign(Object.assign({},i.data),{weight:i.data.weight+s})):r.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:s}}),o=Math.max(o,r.getNode(t.source).data.out+=s),n=Math.max(n,r.getNode(t.target).data.in+=s)}));const i=[],s=o+n+3;for(let u=0;u<s;u++)i.push(new W);const a=n+1;return r.getAllNodes().forEach((t=>{Q(i,a,Object.assign({v:t.id},r.getNode(t.id).data))})),{buckets:i,zeroIdx:a,graph:r}},Q=(t,e,r)=>{r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)},X=(t,e)=>{const r=((t,e)=>{var r;if(t.getAllNodes().length<=1)return[];const n=J(t,e||Y);return null===(r=H(n.graph,n.buckets,n.zeroIdx).map((e=>t.getRelatedEdges(e.v,"out").filter((({target:t})=>t===e.w)))))||void 0===r?void 0:r.flat()})(t,(t=>t.data.weight||1));null==r||r.forEach((e=>{const r=e.data;t.removeEdge(e.id),r.forwardName=e.data.name,r.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:Object.assign({},r)})}))},Z=(t,e,r,n)=>{let o;do{o=`${n}${Math.random()}`}while(t.hasNode(o));return r.dummy=e,t.addNode({id:o,data:r}),o},tt=t=>{const e=new h;return t.getAllNodes().forEach((r=>{t.getChildren(r.id).length||e.addNode(Object.assign({},r))})),t.getAllEdges().forEach((t=>{e.addEdge(t)})),e},et=(t,e)=>{const r=Number(t.x),n=Number(t.y),o=Number(e.x)-r,i=Number(e.y)-n;let s,a,u=Number(t.width)/2,c=Number(t.height)/2;return o||i?(Math.abs(i)*u>Math.abs(o)*c?(i<0&&(c=-c),s=c*o/i,a=c):(o<0&&(u=-u),s=u,a=u*i/o),{x:r+s,y:n+a}):{x:0,y:0}},rt=t=>{const e=[],r=ot(t)+1;for(let n=0;n<r;n++)e.push([]);t.getAllNodes().forEach((t=>{const r=t.data.rank;void 0!==r&&e[r]&&e[r].push(t.id)}));for(let n=0;n<r;n++)e[n]=e[n].sort(((e,r)=>{return n=t.getNode(e).data.order,o=t.getNode(r).data.order,Number(n)-Number(o);var n,o}));return e},nt=(t,e,r,n)=>{const o={width:0,height:0};return D(r)&&D(n)&&(o.rank=r,o.order=n),Z(t,"border",o,e)},ot=t=>{let e;return t.getAllNodes().forEach((t=>{const r=t.data.rank;void 0!==r&&(void 0===e||r>e)&&(e=r)})),e||(e=0),e},it=(t,e)=>t.reduce(((t,r)=>e(t)>e(r)?r:t)),st=(t,e,r,n,o,i)=>{n.includes(e.id)||(n.push(e.id),r||i.push(e.id),o(e.id).forEach((e=>st(t,e,r,n,o,i))),r&&i.push(e.id))},at=(t,e,r,n)=>{const o=Array.isArray(e)?e:[e],i=e=>t.getNeighbors(e),s=[],a=[];return o.forEach((e=>{if(!t.hasNode(e.id))throw new Error(`Graph does not have node: ${e}`);st(t,e,"post"===r,a,i,s)})),s},ut=(t,e,r,n,o,i)=>{const s={rank:i,borderType:e,width:0,height:0},a=o.data[e][i-1],u=Z(t,"border",s,r);o.data[e][i]=u,t.setParent(u,n),a&&t.addEdge({id:`e${Math.random()}`,source:a,target:u,data:{weight:1}})},ct=t=>{t.getAllNodes().forEach((t=>{ht(t)})),t.getAllEdges().forEach((t=>{ht(t)}))},ht=t=>{const e=t.data.width;t.data.width=t.data.height,t.data.height=e},dt=t=>{t.getAllNodes().forEach((t=>{lt(t.data)})),t.getAllEdges().forEach((t=>{var e;null===(e=t.data.points)||void 0===e||e.forEach((t=>lt(t))),t.data.hasOwnProperty("y")&&lt(t.data)}))},lt=t=>{(null==t?void 0:t.y)&&(t.y=-t.y)},ft=t=>{t.getAllNodes().forEach((t=>{gt(t.data)})),t.getAllEdges().forEach((t=>{var e;null===(e=t.data.points)||void 0===e||e.forEach((t=>gt(t))),t.data.hasOwnProperty("x")&&gt(t.data)}))},gt=t=>{const e=t.x;t.x=t.y,t.y=e},pt=(t,e,r,n,o,i,s)=>{const a=t.getChildren(s);if(!(null==a?void 0:a.length))return void(s!==e&&t.addEdge({id:`e${Math.random()}`,source:e,target:s,data:{weight:0,minlen:r}}));const u=nt(t,"_bt"),c=nt(t,"_bb"),h=t.getNode(s);t.setParent(u,s),h.data.borderTop=u,t.setParent(c,s),h.data.borderBottom=c,null==a||a.forEach((a=>{pt(t,e,r,n,o,i,a.id);const h=a.data.borderTop?a.data.borderTop:a.id,d=a.data.borderBottom?a.data.borderBottom:a.id,l=a.data.borderTop?n:2*n,f=h!==d?1:o-i[s]+1;t.addEdge({id:`e${Math.random()}`,source:u,target:h,data:{minlen:f,weight:l,nestingEdge:!0}}),t.addEdge({id:`e${Math.random()}`,source:d,target:c,data:{minlen:f,weight:l,nestingEdge:!0}})})),t.getParent(s)||t.addEdge({id:`e${Math.random()}`,source:e,target:u,data:{weight:0,minlen:o+i[s]}})},vt=t=>{const e={},r=(n,o)=>{const i=t.getChildren(n);null==i||i.forEach((t=>r(t.id,o+1))),e[n]=o};return t.getRoots().forEach((t=>r(t.id,1))),e},yt=t=>{let e=0;return t.getAllEdges().forEach((t=>{e+=t.data.weight})),e},mt="edge-label",wt=(t,e,r)=>{let n=e.source,o=t.getNode(n).data.rank;const i=e.target,s=t.getNode(i).data.rank,a=e.data.labelRank;if(s===o+1)return;let u,c,h;for(t.removeEdge(e.id),h=0,++o;o<s;++h,++o)e.data.points=[],c={originalEdge:e,width:0,height:0,rank:o},u=Z(t,"edge",c,"_d"),o===a&&(c.width=e.data.width,c.height=e.data.height,c.dummy=mt,c.labelpos=e.data.labelpos),t.addEdge({id:`e${Math.random()}`,source:n,target:u,data:{weight:e.data.weight}}),0===h&&r.push(u),n=u;t.addEdge({id:`e${Math.random()}`,source:n,target:i,data:{weight:e.data.weight}})},bt=t=>{let e;for(;t.hasNode(e=`_root${Math.random()}`););return e},xt=(t,e,r)=>{const n=(o=r,i=r.map(((t,e)=>e)),null==o?void 0:o.reduce(((t,e,r)=>(t[e]=i[r],t)),{}));var o,i;const s=e.map((e=>{const r=t.getRelatedEdges(e,"out").map((t=>({pos:n[t.target]||0,weight:t.data.weight})));return null==r?void 0:r.sort(((t,e)=>t.pos-e.pos))})).flat().filter((t=>void 0!==t));let a=1;for(;a<r.length;)a<<=1;const u=2*a-1;a-=1;const c=Array(u).fill(0,0,u);let h=0;return null==s||s.forEach((t=>{if(t){let e=t.pos+a;c[e]+=t.weight;let r=0;for(;e>0;)e%2&&(r+=c[e+1]),e=e-1>>1,c[e]+=t.weight;h+=t.weight*r}})),h},Et=(t,e)=>{let r=0;for(let n=1;n<(null==e?void 0:e.length);n+=1)r+=xt(t,e[n-1],e[n]);return r},Nt=t=>{const e={},r=t.getAllNodes(),n=r.map((t=>{var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),o=Math.max(...n),i=[];for(let u=0;u<o+1;u++)i.push([]);const s=r.sort(((e,r)=>t.getNode(e.id).data.rank-t.getNode(r.id).data.rank)),a=s.filter((e=>void 0!==t.getNode(e.id).data.fixorder)).sort(((e,r)=>t.getNode(e.id).data.fixorder-t.getNode(r.id).data.fixorder));return null==a||a.forEach((r=>{isNaN(t.getNode(r.id).data.rank)||i[t.getNode(r.id).data.rank].push(r.id),e[r.id]=!0})),null==s||s.forEach((r=>t.dfsTree(r.id,(t=>{if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||i[t.data.rank].push(t.id)})))),i},_t=t=>{var e,r;const n=[];for(;null==t?void 0:t.length;){const o=t.pop();n.push(o),null===(e=o.in.reverse())||void 0===e||e.forEach((t=>{return(e=o,t=>{t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&Mt(e,t)})(t);var e})),null===(r=o.out)||void 0===r||r.forEach((e=>{return(r=o,e=>{e.in.push(r),0===--e.indegree&&t.push(e)})(e);var r}))}const o=n.filter((t=>!t.merged)),i=["vs","i","barycenter","weight"];return o.map((t=>{const e={};return null==i||i.forEach((r=>{void 0!==t[r]&&(e[r]=t[r])})),e}))},Mt=(t,e)=>{var r;let n=0,o=0;t.weight&&(n+=t.barycenter*t.weight,o+=t.weight),e.weight&&(n+=e.barycenter*e.weight,o+=e.weight),t.vs=null===(r=e.vs)||void 0===r?void 0:r.concat(t.vs),t.barycenter=n/o,t.weight=o,t.i=Math.min(e.i,t.i),e.merged=!0},kt=(t,e,r)=>{let n,o=r;for(;e.length&&(n=e[e.length-1]).i<=o;)e.pop(),null==t||t.push(n.vs),o++;return o},At=(t,e)=>(r,n)=>{if(void 0!==r.fixorder&&void 0!==n.fixorder)return r.fixorder-n.fixorder;if(r.barycenter<n.barycenter)return-1;if(r.barycenter>n.barycenter)return 1;if(e&&void 0!==r.order&&void 0!==n.order){if(r.order<n.order)return-1;if(r.order>n.order)return 1}return t?n.i-r.i:r.i-n.i},jt=(t,e,r,n,o,i)=>{var s,a,u,c;let h=t.getChildren(e).map((t=>t.id));const d=t.getNode(e),l=d?d.data.borderLeft:void 0,f=d?d.data.borderRight:void 0,g={};l&&(h=null==h?void 0:h.filter((t=>t!==l&&t!==f)));const p=((t,e)=>e.map((e=>{const r=t.getRelatedEdges(e,"in");if(!(null==r?void 0:r.length))return{v:e};const n={sum:0,weight:0};return null==r||r.forEach((e=>{const r=t.getNode(e.source);n.sum+=e.data.weight*r.data.order,n.weight+=e.data.weight})),{v:e,barycenter:n.sum/n.weight,weight:n.weight}})))(t,h||[]);null==p||p.forEach((e=>{var o;if(null===(o=t.getChildren(e.v))||void 0===o?void 0:o.length){const o=jt(t,e.v,r,n,i);g[e.v]=o,o.hasOwnProperty("barycenter")&&Ot(e,o)}}));const v=((t,e)=>{var r,n,o;const i={};null==t||t.forEach(((t,e)=>{i[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};const r=i[t.v];void 0!==t.barycenter&&(r.barycenter=t.barycenter,r.weight=t.weight)})),null===(r=e.getAllEdges())||void 0===r||r.forEach((t=>{const e=i[t.source],r=i[t.target];void 0!==e&&void 0!==r&&(r.indegree++,e.out.push(i[t.target]))}));const s=null===(o=(n=Object.values(i)).filter)||void 0===o?void 0:o.call(n,(t=>!t.indegree));return _t(s)})(p,r);St(v,g),null===(s=v.filter((t=>t.vs.length>0)))||void 0===s||s.forEach((e=>{const r=t.getNode(e.vs[0]);r&&(e.fixorder=r.data.fixorder,e.order=r.data.order)}));const y=((t,e,r,n)=>{const o=((t,e)=>{const r={lhs:[],rhs:[]};return null==t||t.forEach((t=>{e(t)?r.lhs.push(t):r.rhs.push(t)})),r})(t,(t=>{const e=t.hasOwnProperty("fixorder")&&!isNaN(t.fixorder);return n?!e&&t.hasOwnProperty("barycenter"):e||t.hasOwnProperty("barycenter")})),i=o.lhs,s=o.rhs.sort(((t,e)=>-t.i- -e.i)),a=[];let u=0,c=0,h=0;null==i||i.sort(At(!!e,!!r)),h=kt(a,s,h),null==i||i.forEach((t=>{var e;h+=null===(e=t.vs)||void 0===e?void 0:e.length,a.push(t.vs),u+=t.barycenter*t.weight,c+=t.weight,h=kt(a,s,h)}));const d={vs:a.flat()};return c&&(d.barycenter=u/c,d.weight=c),d})(v,n,o,i);if(l&&(y.vs=[l,y.vs,f].flat(),null===(a=t.getPredecessors(l))||void 0===a?void 0:a.length)){const e=t.getNode((null===(u=t.getPredecessors(l))||void 0===u?void 0:u[0].id)||""),r=t.getNode((null===(c=t.getPredecessors(f))||void 0===c?void 0:c[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+e.data.order+r.data.order)/(y.weight+2),y.weight+=2}return y},St=(t,e)=>{null==t||t.forEach((t=>{var r;const n=null===(r=t.vs)||void 0===r?void 0:r.map((t=>e[t]?e[t].vs:t));t.vs=n.flat()}))},Ot=(t,e)=>{void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},zt=(t,e,r)=>e.map((e=>((t,e,r)=>{const n=bt(t),o=new h({tree:[{id:n,children:[],data:{}}]});return t.getAllNodes().forEach((i=>{const s=t.getParent(i.id);(i.data.rank===e||i.data.minRank<=e&&e<=i.data.maxRank)&&(o.hasNode(i.id)||o.addNode(Object.assign({},i)),(null==s?void 0:s.id)&&!o.hasNode(null==s?void 0:s.id)&&o.addNode(Object.assign({},s)),o.setParent(i.id,(null==s?void 0:s.id)||n),t.getRelatedEdges(i.id,r).forEach((e=>{const r=e.source===i.id?e.target:e.source;o.hasNode(r)||o.addNode(Object.assign({},t.getNode(r)));const n=o.getRelatedEdges(r,"out").find((({target:t})=>t===i.id)),s=void 0!==n?n.data.weight:0;n?o.updateEdgeData(n.id,Object.assign(Object.assign({},n.data),{weight:e.data.weight+s})):o.addEdge({id:e.id,source:r,target:i.id,data:{weight:e.data.weight+s}})})),i.data.hasOwnProperty("minRank")&&o.updateNodeData(i.id,Object.assign(Object.assign({},i.data),{borderLeft:i.data.borderLeft[e],borderRight:i.data.borderRight[e]})))})),o})(t,e,r))),Rt=(t,e,r,n)=>{const o=new h;null==t||t.forEach((t=>{var i;const s=t.getRoots()[0].id,a=jt(t,s,o,e,r,n);for(let e=0;e<(null===(i=a.vs)||void 0===i?void 0:i.length);e++){const r=t.getNode(a.vs[e]);r&&(r.data.order=e)}((t,e,r)=>{const n={};let o;null==r||r.forEach((r=>{let i,s,a=t.getParent(r);for(;a;){if(i=t.getParent(a.id),i?(s=n[i.id],n[i.id]=a.id):(s=o,o=a.id),s&&s!==a.id)return e.hasNode(s)||e.addNode({id:s,data:{}}),e.hasNode(a.id)||e.addNode({id:a.id,data:{}}),void(e.hasEdge(`e${s}-${a.id}`)||e.addEdge({id:`e${s}-${a.id}`,source:s,target:a.id,data:{}}));a=i}}))})(t,o,a.vs)}))},It=(t,e)=>{null==e||e.forEach((e=>{null==e||e.forEach(((e,r)=>{t.getNode(e).data.order=r}))}))},Ct=(t,e)=>{const r=(t=>{const e={};let r=0;const n=o=>{const i=r;t.getChildren(o).forEach((t=>n(t.id))),e[o]={low:i,lim:r++}};return t.getRoots().forEach((t=>n(t.id))),e})(t);e.forEach((e=>{var n,o;let i=e,s=t.getNode(i);const a=s.data.originalEdge;if(!a)return;const u=((t,e,r,n)=>{var o,i;const s=[],a=[],u=Math.min(e[r].low,e[n].low),c=Math.max(e[r].lim,e[n].lim);let h,d;h=r;do{h=null===(o=t.getParent(h))||void 0===o?void 0:o.id,s.push(h)}while(h&&(e[h].low>u||c>e[h].lim));for(d=h,h=n;h&&h!==d;)a.push(h),h=null===(i=t.getParent(h))||void 0===i?void 0:i.id;return{lca:d,path:s.concat(a.reverse())}})(t,r,a.source,a.target),c=u.path,h=u.lca;let d=0,l=c[d],f=!0;for(;i!==a.target;){if(s=t.getNode(i),f){for(;l!==h&&(null===(n=t.getNode(l))||void 0===n?void 0:n.data.maxRank)<s.data.rank;)d++,l=c[d];l===h&&(f=!1)}if(!f){for(;d<c.length-1&&(null===(o=t.getNode(c[d+1]))||void 0===o?void 0:o.data.minRank)<=s.data.rank;)d++;l=c[d]}t.hasNode(l)&&t.setParent(i,l),i=t.getSuccessors(i)[0].id}}))},Pt=(t,e)=>{const r={};function n(e,n){const o=function(t){return JSON.stringify(t.slice(1))}(e);n.get(o)||(!function(e,n,o,i,s){var a,u;let c;for(let h=n;h<o;h++)c=e[h],(null===(a=t.getNode(c))||void 0===a?void 0:a.data.dummy)&&(null===(u=t.getPredecessors(c))||void 0===u||u.forEach((e=>{const n=t.getNode(e.id);n.data.dummy&&(n.data.order<i||n.data.order>s)&&Tt(r,e.id,c)})))}(...e),n.set(o,!0))}const o=(e,r)=>{let o,i=-1,s=0;const a=new Map;return null==r||r.forEach(((u,c)=>{var h;if("border"===(null===(h=t.getNode(u))||void 0===h?void 0:h.data.dummy)){const e=t.getPredecessors(u)||[];e.length&&(o=t.getNode(e[0].id).data.order,n([r,s,c,i,o],a),s=c,i=o)}n([r,s,r.length,o,e.length],a)})),r};return(null==e?void 0:e.length)&&e.reduce(o),r},Dt=(t,e)=>{var r,n;if(null===(r=t.getNode(e))||void 0===r?void 0:r.data.dummy)return null===(n=t.getPredecessors(e))||void 0===n?void 0:n.find((e=>t.getNode(e.id).data.dummy))},Tt=(t,e,r)=>{let n=e,o=r;if(n>o){const t=n;n=o,o=t}let i=t[n];i||(t[n]=i={}),i[o]=!0},Ft=(t,e,r)=>{let n=e,o=r;if(n>r){n=r,o=e}return!!t[n]},Lt=(t,e,r,n,o,i)=>{const s=new h,a=qt(n,o,i);return null==e||e.forEach((e=>{let n;null==e||e.forEach((e=>{const o=r[e];if(s.hasNode(o)||s.addNode({id:o,data:{}}),n){const i=r[n],u=s.getRelatedEdges(i,"out").find((t=>t.target===o));u?s.updateEdgeData(u.id,Object.assign(Object.assign({},u.data),{weight:Math.max(a(t,e,n),u.data.weight||0)})):s.addEdge({id:`e${Math.random()}`,source:i,target:o,data:{weight:Math.max(a(t,e,n),0)}})}n=e}))})),s};const qt=(t,e,r)=>(n,o,i)=>{const s=n.getNode(o),a=n.getNode(i);let u=0,c=0;if(u+=s.data.width/2,s.data.hasOwnProperty("labelpos"))switch((s.data.labelpos||"").toLowerCase()){case"l":c=-s.data.width/2;break;case"r":c=s.data.width/2}if(c&&(u+=r?c:-c),c=0,u+=(s.data.dummy?e:t)/2,u+=(a.data.dummy?e:t)/2,u+=a.data.width/2,a.data.labelpos)switch((a.data.labelpos||"").toLowerCase()){case"l":c=a.data.width/2;break;case"r":c=-a.data.width/2}return c&&(u+=r?c:-c),c=0,u},Vt=(t,e)=>t.getNode(e).data.width||0,Gt=(t,e)=>{const{align:r,nodesep:n=0,edgesep:o=0}=e||{},i=rt(t),s=Object.assign(((t,e)=>{const r={},n=(e,n)=>{let o=0,i=0;const s=e.length,a=null==n?void 0:n[(null==n?void 0:n.length)-1];return null==n||n.forEach(((e,u)=>{var c;const h=Dt(t,e),d=h?t.getNode(h.id).data.order:s;(h||e===a)&&(null===(c=n.slice(i,u+1))||void 0===c||c.forEach((e=>{var n;null===(n=t.getPredecessors(e))||void 0===n||n.forEach((n=>{var i;const s=t.getNode(n.id),a=s.data.order;!(a<o||d<a)||s.data.dummy&&(null===(i=t.getNode(e))||void 0===i?void 0:i.data.dummy)||Tt(r,n.id,e)}))})),i=u+1,o=d)})),n};return(null==e?void 0:e.length)&&e.reduce(n),r})(t,i),Pt(t,i)),a={};let u=[];["u","d"].forEach((e=>{u="u"===e?i:Object.values(i).reverse(),["l","r"].forEach((r=>{"r"===r&&(u=u.map((t=>Object.values(t).reverse())));const i=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),c=((t,e,r,n)=>{const o={},i={},s={};return null==e||e.forEach((t=>{null==t||t.forEach(((t,e)=>{o[t]=t,i[t]=t,s[t]=e}))})),null==e||e.forEach((t=>{let e=-1;null==t||t.forEach((t=>{let a=n(t).map((t=>t.id));if(a.length){a=a.sort(((t,e)=>s[t]-s[e]));const n=(a.length-1)/2;for(let u=Math.floor(n),c=Math.ceil(n);u<=c;++u){const n=a[u];i[t]===t&&e<s[n]&&!Ft(r,t,n)&&(i[n]=t,i[t]=o[t]=o[n],e=s[n])}}}))})),{root:o,align:i}})(0,u,s,i),h=((t,e,r,n,o,i,s)=>{var a;const u={},c=Lt(t,e,r,o,i,s),h=s?"borderLeft":"borderRight",d=(t,e)=>{let r=c.getAllNodes(),n=r.pop();const o={};for(;n;)o[n.id]?t(n.id):(o[n.id]=!0,r.push(n),r=r.concat(e(n.id))),n=r.pop()};return d((t=>{u[t]=(c.getRelatedEdges(t,"in")||[]).reduce(((t,e)=>Math.max(t,(u[e.source]||0)+e.data.weight)),0)}),c.getPredecessors.bind(c)),d((e=>{const r=(c.getRelatedEdges(e,"out")||[]).reduce(((t,e)=>Math.min(t,(u[e.target]||0)-e.data.weight)),Number.POSITIVE_INFINITY),n=t.getNode(e);r!==Number.POSITIVE_INFINITY&&n.data.borderType!==h&&(u[e]=Math.max(u[e],r))}),c.getSuccessors.bind(c)),null===(a=Object.values(n))||void 0===a||a.forEach((t=>{u[t]=u[r[t]]})),u})(t,u,c.root,c.align,n,o,"r"===r);"r"===r&&Object.keys(h).forEach((t=>h[t]=-h[t])),a[e+r]=h}))}));const c=((t,e)=>it(Object.values(e),(e=>{var r;let n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return null===(r=Object.keys(e))||void 0===r||r.forEach((r=>{const i=e[r],s=Vt(t,r)/2;n=Math.max(i+s,n),o=Math.min(i-s,o)})),n-o})))(t,a);return c&&function(t,e){const r=Object.values(e),n=Math.min(...r),o=Math.max(...r);["u","d"].forEach((r=>{["l","r"].forEach((i=>{const s=r+i,a=t[s];let u;if(a===e)return;const c=Object.values(a);u="l"===i?n-Math.min(...c):o-Math.max(...c),u&&(t[s]={},Object.keys(a).forEach((e=>{t[s][e]=a[e]+u})))}))}))}(a,c),((t,e)=>{const r={};return Object.keys(t.ul).forEach((n=>{if(e)r[n]=t[e.toLowerCase()][n];else{const e=Object.values(t).map((t=>t[n]));r[n]=(e[0]+e[1])/2}})),r})(a,r)},Bt=(t,e)=>{var r;const n=tt(t);((t,e)=>{const{ranksep:r=0}=e||{},n=rt(t);let o=0;null==n||n.forEach((e=>{const n=e.map((e=>t.getNode(e).data.height)),i=Math.max(...n,0);null==e||e.forEach((e=>{t.getNode(e).data.y=o+i/2})),o+=i+r}))})(n,e);const o=Gt(n,e);null===(r=Object.keys(o))||void 0===r||r.forEach((t=>{n.getNode(t).data.x=o[t]}))},Ut=t=>{const e={},r=n=>{var o;const i=t.getNode(n);if(!i)return 0;if(e[n])return i.data.rank;let s;return e[n]=!0,null===(o=t.getRelatedEdges(n,"out"))||void 0===o||o.forEach((t=>{const e=r(t.target)-t.data.minlen;e&&(void 0===s||e<s)&&(s=e)})),s||(s=0),i.data.rank=s,s};t.getAllNodes().filter((e=>0===t.getRelatedEdges(e.id,"in").length)).forEach((t=>r(t.id)))},$t=(t,e)=>t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen,Wt=(t,e)=>{const r=n=>{e.getRelatedEdges(n,"both").forEach((o=>{const i=o.source,s=n===i?o.target:i;t.hasNode(s)||$t(e,o)||(t.addNode({id:s,data:{}}),t.addEdge({id:o.id,source:n,target:s,data:{}}),r(s))}))};return t.getAllNodes().forEach((t=>r(t.id))),t.getAllNodes().length},Yt=(t,e)=>{const r=n=>{var o;null===(o=e.getRelatedEdges(n,"both"))||void 0===o||o.forEach((o=>{const i=o.source,s=n===i?o.target:i;t.hasNode(s)||void 0===e.getNode(s).data.layer&&$t(e,o)||(t.addNode({id:s,data:{}}),t.addEdge({id:o.id,source:n,target:s,data:{}}),r(s))}))};return t.getAllNodes().forEach((t=>r(t.id))),t.getAllNodes().length},Ht=(t,e)=>it(e.getAllEdges(),(r=>t.hasNode(r.source)!==t.hasNode(r.target)?$t(e,r):1/0)),Kt=(t,e,r)=>{t.getAllNodes().forEach((t=>{const n=e.getNode(t.id);n.data.rank||(n.data.rank=0),n.data.rank+=r}))},Jt=t=>{const e=(t=>{const e=new h;return t.getAllNodes().forEach((t=>{e.addNode(Object.assign({},t))})),t.getAllEdges().forEach((t=>{const r=e.getRelatedEdges(t.source,"out").find((e=>e.target===t.target));r?e.updateEdgeData(null==r?void 0:r.id,Object.assign(Object.assign({},r.data),{weight:r.data.weight+t.data.weight||0,minlen:Math.max(r.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),e})(t);Ut(e);const r=(t=>{const e=new h({tree:[]}),r=t.getAllNodes()[0],n=t.getAllNodes().length;let o,i;for(e.addNode(r);Wt(e,t)<n;)o=Ht(e,t),i=e.hasNode(o.source)?$t(t,o):-$t(t,o),Kt(e,t,i);return e})(e);let n,o;for(te(r),Qt(r,e);n=re(r);)o=ne(r,e,n),oe(r,e,n,o)},Qt=(t,e)=>{let r=at(t,t.getAllNodes(),"post");r=r.slice(0,(null==r?void 0:r.length)-1),r.forEach((r=>{Xt(t,e,r)}))},Xt=(t,e,r)=>{const n=t.getNode(r).data.parent;t.getRelatedEdges(r,"both").find((t=>t.target===n||t.source===n)).data.cutvalue=Zt(t,e,r)},Zt=(t,e,r)=>{const n=t.getNode(r).data.parent;let o=!0,i=e.getRelatedEdges(r,"out").find((t=>t.target===n)),s=0;return i||(o=!1,i=e.getRelatedEdges(n,"out").find((t=>t.target===r))),s=i.data.weight,e.getRelatedEdges(r,"both").forEach((e=>{const i=e.source===r,a=i?e.target:e.source;if(a!==n){const n=i===o,u=e.data.weight;if(s+=n?u:-u,se(t,r,a)){const e=t.getRelatedEdges(r,"both").find((t=>t.source===a||t.target===a)).data.cutvalue;s+=n?-e:e}}})),s},te=(t,e=t.getAllNodes()[0].id)=>{ee(t,{},1,e)},ee=(t,e,r,n,o)=>{var i;const s=r;let a=r;const u=t.getNode(n);return e[n]=!0,null===(i=t.getNeighbors(n))||void 0===i||i.forEach((r=>{e[r.id]||(a=ee(t,e,a,r.id,n))})),u.data.low=s,u.data.lim=a++,o?u.data.parent=o:delete u.data.parent,a},re=t=>t.getAllEdges().find((t=>t.data.cutvalue<0)),ne=(t,e,r)=>{let n=r.source,o=r.target;e.getRelatedEdges(n,"out").find((t=>t.target===o))||(n=r.target,o=r.source);const i=t.getNode(n),s=t.getNode(o);let a=i,u=!1;i.data.lim>s.data.lim&&(a=s,u=!0);const c=e.getAllEdges().filter((e=>u===ae(t.getNode(e.source),a)&&u!==ae(t.getNode(e.target),a)));return it(c,(t=>$t(e,t)))},oe=(t,e,r,n)=>{const o=t.getRelatedEdges(r.source,"both").find((t=>t.source===r.target||t.target===r.target));o&&t.removeEdge(o.id),t.addEdge({id:`e${Math.random()}`,source:n.source,target:n.target,data:{}}),te(t),Qt(t,e),ie(t,e)},ie=(t,e)=>{const r=t.getAllNodes().find((t=>!t.data.parent));let n=at(t,r,"pre");n=n.slice(1),n.forEach((r=>{const n=t.getNode(r).data.parent;let o=e.getRelatedEdges(r,"out").find((t=>t.target===n)),i=!1;!o&&e.hasNode(n)&&(o=e.getRelatedEdges(n,"out").find((t=>t.target===r)),i=!0),e.getNode(r).data.rank=(e.hasNode(n)&&e.getNode(n).data.rank||0)+(i?null==o?void 0:o.data.minlen:-(null==o?void 0:o.data.minlen))}))},se=(t,e,r)=>t.getRelatedEdges(e,"both").find((t=>t.source===r||t.target===r)),ae=(t,e)=>e.data.low<=t.data.lim&&t.data.lim<=e.data.lim,ue=Ut,ce=t=>{(t=>{const e={};let r;const n=o=>{var i;const s=t.getNode(o);if(!s)return 0;if(e[o])return s.data.rank;let a;return e[o]=!0,null===(i=t.getRelatedEdges(o,"out"))||void 0===i||i.forEach((t=>{const e=n(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)})),a||(a=0),(void 0===r||a<r)&&(r=a),s.data.rank=a,a};t.getAllNodes().filter((e=>0===t.getRelatedEdges(e.id,"in").length)).forEach((t=>{t&&n(t.id)})),void 0===r&&(r=0);const o={},i=(e,r)=>{var n;const s=t.getNode(e),a=isNaN(s.data.layer)?r:s.data.layer;(void 0===s.data.rank||s.data.rank<a)&&(s.data.rank=a),o[e]||(o[e]=!0,null===(n=t.getRelatedEdges(e,"out"))||void 0===n||n.forEach((t=>{i(t.target,a+t.data.minlen)})))};t.getAllNodes().forEach((t=>{const e=t.data;e&&(isNaN(e.layer)?e.rank-=r:i(t.id,e.layer))}))})(t),(t=>{const e=new h({tree:[]}),r=t.getAllNodes()[0],n=t.getAllNodes().length;let o,i;for(e.addNode(r);Yt(e,t)<n;)o=Ht(e,t),i=e.hasNode(o.source)?$t(t,o):-$t(t,o),Kt(e,t,i)})(t)},he=t=>{Jt(t)},de=(t,e)=>{const{ranker:r,rankdir:n="tb",nodeOrder:o,keepNodeOrder:i,align:s,nodesep:a=50,edgesep:u=20,ranksep:c=50}=e;Se(t),X(t);const{nestingRoot:h,nodeRankFactor:d}=(t=>{const e=Z(t,"root",{},"_root"),r=vt(t);let n=Math.max(...Object.values(r));Math.abs(n)===1/0&&(n=1);const o=n-1,i=2*o+1;t.getAllEdges().forEach((t=>{t.data.minlen*=i}));const s=yt(t)+1;return t.getRoots().forEach((n=>{pt(t,e,i,s,o,r,n.id)})),{nestingRoot:e,nodeRankFactor:i}})(t);((t,e)=>{switch(e){case"network-simplex":he(t);break;case"tight-tree":default:ce(t);break;case"longest-path":ue(t)}})(tt(t),r),xe(t),((t,e=0)=>{const r=t.getAllNodes(),n=r.filter((t=>void 0!==t.data.rank)).map((t=>t.data.rank)),o=Math.min(...n),i=[];r.forEach((t=>{const e=(t.data.rank||0)-o;i[e]||(i[e]=[]),i[e].push(t.id)}));let s=0;for(let a=0;a<i.length;a++){const r=i[a];void 0===r?a%e!==0&&(s-=1):s&&(null==r||r.forEach((e=>{const r=t.getNode(e);r&&(r.data.rank=r.data.rank||0,r.data.rank+=s)})))}})(t,d),((t,e)=>{e&&t.removeNode(e),t.getAllEdges().forEach((e=>{e.data.nestingEdge&&t.removeEdge(e.id)}))})(t,h),(t=>{const e=t.getAllNodes().filter((t=>void 0!==t.data.rank)).map((t=>t.data.rank)),r=Math.min(...e);t.getAllNodes().forEach((t=>{t.data.hasOwnProperty("rank")&&r!==1/0&&(t.data.rank-=r)}))})(t),Ee(t),Ne(t);const l=[];((t,e)=>{t.getAllEdges().forEach((r=>wt(t,r,e)))})(t,l),Ct(t,l),(t=>{const e=r=>{const n=t.getChildren(r),o=t.getNode(r);if((null==n?void 0:n.length)&&n.forEach((t=>e(t.id))),o.data.hasOwnProperty("minRank")){o.data.borderLeft=[],o.data.borderRight=[];for(let e=o.data.minRank,n=o.data.maxRank+1;e<n;e+=1)ut(t,"borderLeft","_bl",r,o,e),ut(t,"borderRight","_br",r,o,e)}};t.getRoots().forEach((t=>e(t.id)))})(t),i&&((t,e)=>{const r=t.getAllNodes().filter((e=>{var r;return!(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length)})).map((t=>t.data.rank)),n=Math.max(...r),o=[];for(let i=0;i<n+1;i++)o[i]=[];null==e||e.forEach((e=>{const r=t.getNode(e);r&&!r.data.dummy&&(isNaN(r.data.rank)||(r.data.fixorder=o[r.data.rank].length,o[r.data.rank].push(e)))}))})(t,o),((t,e)=>{const r=ot(t),n=[],o=[];for(let h=1;h<r+1;h++)n.push(h);for(let h=r-1;h>-1;h--)o.push(h);const i=zt(t,n,"in"),s=zt(t,o,"out");let a=Nt(t);It(t,a);let u,c=Number.POSITIVE_INFINITY;for(let h=0,d=0;d<4;++h,++d){Rt(h%2?i:s,h%4>=2,!1,e),a=rt(t);const r=Et(t,a);r<c&&(d=0,u=T(a),c=r)}a=Nt(t),It(t,a);for(let h=0,d=0;d<4;++h,++d){Rt(h%2?i:s,h%4>=2,!0,e),a=rt(t);const r=Et(t,a);r<c&&(d=0,u=T(a),c=r)}It(t,u)})(t,i),Oe(t),((t,e)=>{const r=e.toLowerCase();"lr"!==r&&"rl"!==r||ct(t)})(t,n),Bt(t,{align:s,nodesep:a,edgesep:u,ranksep:c}),ze(t),je(t),((t,e)=>{e.forEach((e=>{let r=t.getNode(e);const{data:n}=r,o=n.originalEdge;let i;o&&t.addEdge(o);let s=e;for(;r.data.dummy;)i=t.getSuccessors(s)[0],t.removeNode(s),o.data.points.push({x:r.data.x,y:r.data.y}),r.data.dummy===mt&&(o.data.x=r.data.x,o.data.y=r.data.y,o.data.width=r.data.width,o.data.height=r.data.height),s=i.id,r=t.getNode(s)}))})(t,l),ke(t),((t,e)=>{const r=e.toLowerCase();"bt"!==r&&"rl"!==r||dt(t),"lr"!==r&&"rl"!==r||(ft(t),ct(t))})(t,n);const{width:f,height:g}=_e(t);return Me(t),Ae(t),(t=>{t.getAllEdges().forEach((e=>{const r=e.data;if(r.reversed){t.removeEdge(e.id);const n=r.forwardName;delete r.reversed,delete r.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:Object.assign(Object.assign({},r),{forwardName:n})})}}))})(t),{width:f,height:g}},le=(t,e)=>{t.getAllNodes().forEach((r=>{const n=t.getNode(r.id);if(e.hasNode(r.id)){const t=e.getNode(r.id);n.data.fixorder=t.data._order,delete t.data._order}else delete n.data.fixorder}))},fe=(t,e)=>{t.getAllNodes().forEach((r=>{var n;const o=t.getNode(r.id);if(o){const t=e.getNode(r.id);o.data.x=t.data.x,o.data.y=t.data.y,o.data._order=t.data.order,o.data._rank=t.data.rank,(null===(n=e.getChildren(r.id))||void 0===n?void 0:n.length)&&(o.data.width=t.data.width,o.data.height=t.data.height)}})),t.getAllEdges().forEach((r=>{const n=t.getEdge(r.id),o=e.getEdge(r.id);n.data.points=o?o.data.points:[],o&&o.data.hasOwnProperty("x")&&(n.data.x=o.data.x,n.data.y=o.data.y)}))},ge=["width","height","layer","fixorder"],pe={width:0,height:0},ve=["minlen","weight","width","height","labeloffset"],ye={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},me=["labelpos"],we=t=>{const e=new h({tree:[]});return t.getAllNodes().forEach((r=>{const n=Ie(t.getNode(r.id).data),o=Object.assign(Object.assign({},pe),n),i=Re(o,ge);e.hasNode(r.id)||e.addNode({id:r.id,data:Object.assign({},i)});const s=t.hasTreeStructure("combo")?t.getParent(r.id,"combo"):t.getParent(r.id);null!=s&&(e.hasNode(s.id)||e.addNode(Object.assign({},s)),e.setParent(r.id,s.id))})),t.getAllEdges().forEach((r=>{const n=Ie(t.getEdge(r.id).data),o={};null==me||me.forEach((t=>{void 0!==n[t]&&(o[t]=n[t])})),e.addEdge({id:r.id,source:r.source,target:r.target,data:Object.assign({},ye,Re(n,ve),o)})})),e},be=(t,e)=>{const{ranksep:r=0,rankdir:n}=e;return t.getAllNodes().forEach((t=>{isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((t=>{var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===n||"BT"===n?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),r/2},xe=t=>{t.getAllEdges().forEach((e=>{if(e.data.width&&e.data.height){const r=t.getNode(e.source),n={e:e,rank:(t.getNode(e.target).data.rank-r.data.rank)/2+r.data.rank};Z(t,"edge-proxy",n,"_ep")}}))},Ee=t=>{let e=0;return t.getAllNodes().forEach((r=>{var n,o;r.data.borderTop&&(r.data.minRank=null===(n=t.getNode(r.data.borderTop))||void 0===n?void 0:n.data.rank,r.data.maxRank=null===(o=t.getNode(r.data.borderBottom))||void 0===o?void 0:o.data.rank,e=Math.max(e,r.data.maxRank||-1/0))})),e},Ne=t=>{t.getAllNodes().forEach((e=>{"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},_e=(t,e)=>{let r,n,o=0,i=0;const{marginx:s=0,marginy:a=0}={},u=t=>{if(!t.data)return;const e=t.data.x,s=t.data.y,a=t.data.width,u=t.data.height;isNaN(e)||isNaN(a)||(void 0===r&&(r=e-a/2),r=Math.min(r,e-a/2),o=Math.max(o,e+a/2)),isNaN(s)||isNaN(u)||(void 0===n&&(n=s-u/2),n=Math.min(n,s-u/2),i=Math.max(i,s+u/2))};return t.getAllNodes().forEach((t=>{u(t)})),t.getAllEdges().forEach((t=>{(null==t?void 0:t.data.hasOwnProperty("x"))&&u(t)})),r-=s,n-=a,t.getAllNodes().forEach((t=>{t.data.x-=r,t.data.y-=n})),t.getAllEdges().forEach((t=>{var e;null===(e=t.data.points)||void 0===e||e.forEach((t=>{t.x-=r,t.y-=n})),t.data.hasOwnProperty("x")&&(t.data.x-=r),t.data.hasOwnProperty("y")&&(t.data.y-=n)})),{width:o-r+s,height:i-n+a}},Me=t=>{t.getAllEdges().forEach((e=>{const r=t.getNode(e.source),n=t.getNode(e.target);let o,i;e.data.points?(o=e.data.points[0],i=e.data.points[e.data.points.length-1]):(e.data.points=[],o={x:n.data.x,y:n.data.y},i={x:r.data.x,y:r.data.y}),e.data.points.unshift(et(r.data,o)),e.data.points.push(et(n.data,i))}))},ke=t=>{t.getAllEdges().forEach((t=>{if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},Ae=t=>{t.getAllEdges().forEach((t=>{var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},je=t=>{t.getAllNodes().forEach((e=>{var r,n,o;if(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length){const r=t.getNode(e.id),i=t.getNode(r.data.borderTop),s=t.getNode(r.data.borderBottom),a=t.getNode(r.data.borderLeft[(null===(n=r.data.borderLeft)||void 0===n?void 0:n.length)-1]),u=t.getNode(r.data.borderRight[(null===(o=r.data.borderRight)||void 0===o?void 0:o.length)-1]);r.data.width=Math.abs((null==u?void 0:u.data.x)-(null==a?void 0:a.data.x))||10,r.data.height=Math.abs((null==s?void 0:s.data.y)-(null==i?void 0:i.data.y))||10,r.data.x=((null==a?void 0:a.data.x)||0)+r.data.width/2,r.data.y=((null==i?void 0:i.data.y)||0)+r.data.height/2}})),t.getAllNodes().forEach((e=>{"border"===e.data.dummy&&t.removeNode(e.id)}))},Se=t=>{t.getAllEdges().forEach((e=>{if(e.source===e.target){const r=t.getNode(e.source);r.data.selfEdges||(r.data.selfEdges=[]),r.data.selfEdges.push(e),t.removeEdge(e.id)}}))},Oe=t=>{const e=rt(t);null==e||e.forEach((e=>{let r=0;null==e||e.forEach(((e,n)=>{var o;const i=t.getNode(e);i.data.order=n+r,null===(o=i.data.selfEdges)||void 0===o||o.forEach((e=>{Z(t,"selfedge",{width:e.data.width,height:e.data.height,rank:i.data.rank,order:n+ ++r,e:e},"_se")})),delete i.data.selfEdges}))}))},ze=t=>{t.getAllNodes().forEach((e=>{const r=t.getNode(e.id);if("selfedge"===r.data.dummy){const n=t.getNode(r.data.e.source),o=n.data.x+n.data.width/2,i=n.data.y,s=r.data.x-o,a=n.data.height/2;t.hasEdge(r.data.e.id)?t.updateEdgeData(r.data.e.id,r.data.e.data):t.addEdge({id:r.data.e.id,source:r.data.e.source,target:r.data.e.target,data:r.data.e.data}),t.removeNode(e.id),r.data.e.data.points=[{x:o+2*s/3,y:i-a},{x:o+5*s/6,y:i-a},{y:i,x:o+s},{x:o+5*s/6,y:i+a},{x:o+2*s/3,y:i+a}],r.data.e.data.x=r.data.x,r.data.e.data.y=r.data.y}}))},Re=(t,e)=>{const r={};return null==e||e.forEach((e=>{void 0!==t[e]&&(r[e]=+t[e])})),r},Ie=(t={})=>{const e={};return Object.keys(t).forEach((r=>{e[r.toLowerCase()]=t[r]})),e},Ce=Array.isArray,Pe=t=>{const e=[],r=t.length;for(let n=0;n<r;n+=1){e[n]=[];for(let o=0;o<r;o+=1)n===o?e[n][o]=0:0!==t[n][o]&&t[n][o]?e[n][o]=t[n][o]:e[n][o]=1/0}for(let n=0;n<r;n+=1)for(let t=0;t<r;t+=1)for(let o=0;o<r;o+=1)e[t][o]>e[t][n]+e[n][o]&&(e[t][o]=e[t][n]+e[n][o]);return e},De=(t,e)=>{const{nodes:r,edges:n}=t,o=[],i={};if(!r)throw new Error("invalid nodes data!");return r&&r.forEach(((t,e)=>{i[t.id]=e;o.push([])})),null==n||n.forEach((t=>{const{source:e,target:r}=t,n=i[e],s=i[r];void 0!==n&&void 0!==s&&(o[n][s]=1,o[s][n]=1)})),o},Te=(t,e)=>Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)),Fe=(t,e,r,n="TB",o,i={})=>{if(!(null==e?void 0:e.length))return;const{stopBranchFn:s,stopAllFn:a}=i;for(let u=0;u<e.length;u++){const c=e[u];if(t.hasNode(c.id)&&!(null==s?void 0:s(c))){if(null==a?void 0:a(c))return;"TB"===n&&r(c),Fe(t,t.getChildren(c.id,o),r,n,o,i),"TB"!==n&&r(c)}}},Le=t=>{if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){const e=[];return t.forEach((t=>{e.push(t)})),e.map((t=>Le(t)))}if("object"==typeof t){const e={};return Object.keys(t).forEach((r=>{e[r]=Le(t[r])})),e}return t},qe=(t,e)=>{const r=Le(t);return r.data=r.data||{},e&&(D(r.data.x)||(r.data.x=Math.random()*e[0]),D(r.data.y)||(r.data.y=Math.random()*e[1])),r};function Ve(t){if(!t)return[0,0,0];if(D(t))return[t,t,t];if(0===t.length)return[0,0,0];const[e,r=e,n=e]=t;return[e,r,n]}function Ge(t,e){let r;return r=O(e)?e:D(e)?()=>e:()=>t,r}function Be(t,e,r=!0){return e||0===e?O(e)?e:D(e)?()=>e:Array.isArray(e)?()=>r?Math.max(...e)||t:e:R(e)&&e.width&&e.height?()=>r?Math.max(e.width,e.height)||t:[e.width,e.height]:()=>t:e=>{const{size:n}=e.data||{};return n?Array.isArray(n)?r?Math.max(...n)||t:n:R(n)&&n.width&&n.height?r?Math.max(n.width,n.height)||t:[n.width,n.height]:n:t}}const Ue=(t,e,r=10)=>{let n;const o="function"==typeof e?e:()=>e||0;n=t?Array.isArray(t)?e=>t:O(t)?t:e=>t:t=>{var e,n,o;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return null===(n=t.data)||void 0===n?void 0:n.bboxSize;if(null===(o=t.data)||void 0===o?void 0:o.size){const e=t.data.size;return Array.isArray(e)?e:R(e)?[e.width,e.height]:e}return r};return t=>{const e=n(t),r=o(t);return Math.max(...Ve(e))+r}},$e={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,ranker:"tight-tree",controlPoints:!1,radial:!1,focusNode:null};const We=(t,e,r,n,o,i,s)=>{let a=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&r){let{x:t,y:u}=e.data,{x:c,y:h}=r.data;if(o&&(t=e.data.y,u=e.data.x,c=r.data.y,h=r.data.x),h!==u&&t!==c){const d=n.indexOf(u),l=n[d+1];if(l){const t=a[0],e=o?{x:(u+l)/2,y:(null==t?void 0:t.y)||c}:{x:(null==t?void 0:t.x)||c,y:(u+l)/2};t&&!i(t,e)||a.unshift(e)}const f=n.indexOf(h),g=Math.abs(f-d);if(1===g)a=s(a,e.data,r.data),a.length||a.push(o?{x:(u+h)/2,y:t}:{x:t,y:(u+h)/2});else if(g>1){const e=n[f-1];if(e){const r=a[a.length-1],n=o?{x:(h+e)/2,y:(null==r?void 0:r.y)||c}:{x:(null==r?void 0:r.x)||t,y:(h+e)/2};r&&!i(r,n)||a.push(n)}}}}return a},Ye=(t,e,r)=>{const n=t.getAllNodes(),o=t.getAllEdges();if(!(null==n?void 0:n.length)){return{nodes:[],edges:o}}if(1===n.length){e&&t.mergeNodeData(n[0].id,{x:r[0],y:r[1]});return{nodes:[Object.assign(Object.assign({},n[0]),{data:Object.assign(Object.assign({},n[0].data),{x:r[0],y:r[1]})})],edges:o}}},He={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1};const Ke=(t,e,r=!1)=>{const n=[qe(e[0])],o={},i=e.length;o[e[0].id]=!0;let s=0;return e.forEach(((a,u)=>{if(0!==u)if(u!==i-1&&t.getDegree(a.id,"both")===t.getDegree(e[u+1].id,"both")&&!t.areNeighbors(n[s].id,a.id)||o[a.id]){const u=r?t.getSuccessors(n[s].id):t.getNeighbors(n[s].id);let c=!1;for(let e=0;e<u.length;e++){const r=u[e];if(t.getDegree(r.id)===t.getDegree(a.id)&&!o[r.id]){n.push(qe(r)),o[r.id]=!0,c=!0;break}}let h=0;for(;!c&&(o[e[h].id]||(n.push(qe(e[h])),o[e[h].id]=!0,c=!0),h++,h!==i););}else n.push(qe(a)),o[a.id]=!0,s++})),n};const Je=(t,e,r)=>{let n=t,o=e,i=r;return n||"undefined"==typeof window||(n=window.innerWidth),o||"undefined"==typeof window||(o=window.innerHeight),i||(i=[n/2,o/2]),[n,o,i]},Qe={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"};class Xe{constructor(t={}){this.options=t,this.id="concentric",this.options=Object.assign(Object.assign({},Qe),t)}execute(t,e){return o(this,void 0,void 0,(function*(){return this.genericConcentricLayout(!1,t,e)}))}assign(t,e){return o(this,void 0,void 0,(function*(){yield this.genericConcentricLayout(!0,t,e)}))}genericConcentricLayout(t,e,r){return o(this,void 0,void 0,(function*(){const n=Object.assign(Object.assign({},this.options),r),{center:o,width:i,height:s,sortBy:a,maxLevelDiff:u,sweep:c,clockwise:h,equidistant:d,preventOverlap:l,startAngle:f=1.5*Math.PI,nodeSize:g,nodeSpacing:p}=n,v=e.getAllNodes(),y=e.getAllEdges(),m=i||"undefined"==typeof window?i:window.innerWidth,w=s||"undefined"==typeof window?s:window.innerHeight,b=o||[m/2,w/2];if(!(null==v?void 0:v.length)||1===v.length)return Ye(e,t,b);const x=[];let E,N=0;Ce(g)?E=Math.max(g[0],g[1]):O(g)?(E=-1/0,v.forEach((t=>{const e=Math.max(...Ve(g(t)));e>E&&(E=e)}))):E=g,Ce(p)?N=Math.max(p[0],p[1]):D(p)&&(N=p),v.forEach((t=>{const e=qe(t);x.push(e);let r=E;const{data:n}=e;Ce(n.size)?r=Math.max(n.size[0],n.size[1]):D(n.size)?r=n.size:R(n.size)&&(r=Math.max(n.size.width,n.size.height)),E=Math.max(E,r),O(p)&&(N=Math.max(p(t),N))}));const _={};x.forEach(((t,e)=>{_[t.id]=e}));let M=a;P(M)&&void 0!==x[0].data[M]||(M="degree"),"degree"===M?x.sort(((t,r)=>e.getDegree(r.id,"both")-e.getDegree(t.id,"both"))):x.sort(((t,e)=>e.data[M]-t.data[M]));const k=x[0],A=(u||("degree"===M?e.getDegree(k.id,"both"):k.data[M]))/4,j=[{nodes:[]}];let S=j[0];x.forEach((t=>{if(S.nodes.length>0){const r="degree"===M?Math.abs(e.getDegree(S.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(S.nodes[0].data[M]-t.data[M]);A&&r>=A&&(S={nodes:[]},j.push(S))}S.nodes.push(t)}));let z=E+N;if(!l){const t=j.length>0&&j[0].nodes.length>1,e=(Math.min(m,w)/2-z)/(j.length+(t?1:0));z=Math.min(z,e)}let I=0;if(j.forEach((t=>{const e=void 0===c?2*Math.PI-2*Math.PI/t.nodes.length:c;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&l){const e=Math.cos(t.dTheta)-Math.cos(0),r=Math.sin(t.dTheta)-Math.sin(0),n=Math.sqrt(z*z/(e*e+r*r));I=Math.max(n,I)}t.r=I,I+=z})),d){let t=0,e=0;for(let r=0;r<j.length;r++){const n=(j[r].r||0)-e;t=Math.max(t,n)}e=0,j.forEach(((r,n)=>{0===n&&(e=r.r||0),r.r=e,e+=t}))}j.forEach((t=>{const e=t.dTheta||0,r=t.r||0;t.nodes.forEach(((t,n)=>{const o=f+(h?1:-1)*e*n;t.data.x=b[0]+r*Math.cos(o),t.data.y=b[1]+r*Math.sin(o)}))})),t&&x.forEach((t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})));return{nodes:x,edges:y}}))}}function Ze(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var o,i,s,a,u,c,h,d,l,f=t._root,g={data:n},p=t._x0,v=t._y0,y=t._x1,m=t._y1;if(!f)return t._root=g,t;for(;f.length;)if((c=e>=(i=(p+y)/2))?p=i:y=i,(h=r>=(s=(v+m)/2))?v=s:m=s,o=f,!(f=f[d=h<<1|c]))return o[d]=g,t;if(a=+t._x.call(null,f.data),u=+t._y.call(null,f.data),e===a&&r===u)return g.next=f,o?o[d]=g:t._root=g,t;do{o=o?o[d]=new Array(4):t._root=new Array(4),(c=e>=(i=(p+y)/2))?p=i:y=i,(h=r>=(s=(v+m)/2))?v=s:m=s}while((d=h<<1|c)==(l=(u>=s)<<1|a>=i));return o[l]=f,o[d]=g,t}function tr(t,e,r,n,o){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=o}function er(t){return t[0]}function rr(t){return t[1]}function nr(t,e,r){var n=new or(null==e?er:e,null==r?rr:r,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function or(t,e,r,n,o,i){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=o,this._y1=i,this._root=void 0}function ir(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var sr=nr.prototype=or.prototype;function ar(t,e,r,n,o){if(isNaN(e)||isNaN(r)||isNaN(n))return t;var i,s,a,u,c,h,d,l,f,g,p,v,y=t._root,m={data:o},w=t._x0,b=t._y0,x=t._z0,E=t._x1,N=t._y1,_=t._z1;if(!y)return t._root=m,t;for(;y.length;)if((l=e>=(s=(w+E)/2))?w=s:E=s,(f=r>=(a=(b+N)/2))?b=a:N=a,(g=n>=(u=(x+_)/2))?x=u:_=u,i=y,!(y=y[p=g<<2|f<<1|l]))return i[p]=m,t;if(c=+t._x.call(null,y.data),h=+t._y.call(null,y.data),d=+t._z.call(null,y.data),e===c&&r===h&&n===d)return m.next=y,i?i[p]=m:t._root=m,t;do{i=i?i[p]=new Array(8):t._root=new Array(8),(l=e>=(s=(w+E)/2))?w=s:E=s,(f=r>=(a=(b+N)/2))?b=a:N=a,(g=n>=(u=(x+_)/2))?x=u:_=u}while((p=g<<2|f<<1|l)==(v=(d>=u)<<2|(h>=a)<<1|c>=s));return i[v]=y,i[p]=m,t}function ur(t,e,r,n,o,i,s){this.node=t,this.x0=e,this.y0=r,this.z0=n,this.x1=o,this.y1=i,this.z1=s}sr.copy=function(){var t,e,r=new or(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=ir(n),r;for(t=[{source:n,target:r._root=new Array(4)}];n=t.pop();)for(var o=0;o<4;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(4)}):n.target[o]=ir(e));return r},sr.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t);return Ze(this.cover(e,r),e,r,t)},sr.addAll=function(t){var e,r,n,o,i=t.length,s=new Array(i),a=new Array(i),u=1/0,c=1/0,h=-1/0,d=-1/0;for(r=0;r<i;++r)isNaN(n=+this._x.call(null,e=t[r]))||isNaN(o=+this._y.call(null,e))||(s[r]=n,a[r]=o,n<u&&(u=n),n>h&&(h=n),o<c&&(c=o),o>d&&(d=o));if(u>h||c>d)return this;for(this.cover(u,c).cover(h,d),r=0;r<i;++r)Ze(this,s[r],a[r],t[r]);return this},sr.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,o=this._x1,i=this._y1;if(isNaN(r))o=(r=Math.floor(t))+1,i=(n=Math.floor(e))+1;else{for(var s,a,u=o-r||1,c=this._root;r>t||t>=o||n>e||e>=i;)switch(a=(e<n)<<1|t<r,(s=new Array(4))[a]=c,c=s,u*=2,a){case 0:o=r+u,i=n+u;break;case 1:r=o-u,i=n+u;break;case 2:o=r+u,n=i-u;break;case 3:r=o-u,n=i-u}this._root&&this._root.length&&(this._root=c)}return this._x0=r,this._y0=n,this._x1=o,this._y1=i,this},sr.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},sr.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},sr.find=function(t,e,r){var n,o,i,s,a,u,c,h=this._x0,d=this._y0,l=this._x1,f=this._y1,g=[],p=this._root;for(p&&g.push(new tr(p,h,d,l,f)),null==r?r=1/0:(h=t-r,d=e-r,l=t+r,f=e+r,r*=r);u=g.pop();)if(!(!(p=u.node)||(o=u.x0)>l||(i=u.y0)>f||(s=u.x1)<h||(a=u.y1)<d))if(p.length){var v=(o+s)/2,y=(i+a)/2;g.push(new tr(p[3],v,y,s,a),new tr(p[2],o,y,v,a),new tr(p[1],v,i,s,y),new tr(p[0],o,i,v,y)),(c=(e>=y)<<1|t>=v)&&(u=g[g.length-1],g[g.length-1]=g[g.length-1-c],g[g.length-1-c]=u)}else{var m=t-+this._x.call(null,p.data),w=e-+this._y.call(null,p.data),b=m*m+w*w;if(b<r){var x=Math.sqrt(r=b);h=t-x,d=e-x,l=t+x,f=e+x,n=p.data}}return n},sr.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(s=+this._y.call(null,t)))return this;var e,r,n,o,i,s,a,u,c,h,d,l,f=this._root,g=this._x0,p=this._y0,v=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((c=i>=(a=(g+v)/2))?g=a:v=a,(h=s>=(u=(p+y)/2))?p=u:y=u,e=f,!(f=f[d=h<<1|c]))return this;if(!f.length)break;(e[d+1&3]||e[d+2&3]||e[d+3&3])&&(r=e,l=d)}for(;f.data!==t;)if(n=f,!(f=f.next))return this;return(o=f.next)&&delete f.next,n?(o?n.next=o:delete n.next,this):e?(o?e[d]=o:delete e[d],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(r?r[l]=f:this._root=f),this):(this._root=o,this)},sr.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},sr.root=function(){return this._root},sr.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},sr.visit=function(t){var e,r,n,o,i,s,a=[],u=this._root;for(u&&a.push(new tr(u,this._x0,this._y0,this._x1,this._y1));e=a.pop();)if(!t(u=e.node,n=e.x0,o=e.y0,i=e.x1,s=e.y1)&&u.length){var c=(n+i)/2,h=(o+s)/2;(r=u[3])&&a.push(new tr(r,c,h,i,s)),(r=u[2])&&a.push(new tr(r,n,h,c,s)),(r=u[1])&&a.push(new tr(r,c,o,i,h)),(r=u[0])&&a.push(new tr(r,n,o,c,h))}return this},sr.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new tr(this._root,this._x0,this._y0,this._x1,this._y1));e=r.pop();){var o=e.node;if(o.length){var i,s=e.x0,a=e.y0,u=e.x1,c=e.y1,h=(s+u)/2,d=(a+c)/2;(i=o[0])&&r.push(new tr(i,s,a,h,d)),(i=o[1])&&r.push(new tr(i,h,a,u,d)),(i=o[2])&&r.push(new tr(i,s,d,h,c)),(i=o[3])&&r.push(new tr(i,h,d,u,c))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},sr.x=function(t){return arguments.length?(this._x=t,this):this._x},sr.y=function(t){return arguments.length?(this._y=t,this):this._y};const cr=(t,e,r,n,o,i)=>Math.sqrt((t-n)**2+(e-o)**2+(r-i)**2);function hr(t){return t[0]}function dr(t){return t[1]}function lr(t){return t[2]}function fr(t,e,r,n){var o=new gr(null==e?hr:e,null==r?dr:r,null==n?lr:n,NaN,NaN,NaN,NaN,NaN,NaN);return null==t?o:o.addAll(t)}function gr(t,e,r,n,o,i,s,a,u){this._x=t,this._y=e,this._z=r,this._x0=n,this._y0=o,this._z0=i,this._x1=s,this._y1=a,this._z1=u,this._root=void 0}function pr(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var vr=fr.prototype=gr.prototype;vr.copy=function(){var t,e,r=new gr(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),n=this._root;if(!n)return r;if(!n.length)return r._root=pr(n),r;for(t=[{source:n,target:r._root=new Array(8)}];n=t.pop();)for(var o=0;o<8;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(8)}):n.target[o]=pr(e));return r},vr.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t),n=+this._z.call(null,t);return ar(this.cover(e,r,n),e,r,n,t)},vr.addAll=function(t){Array.isArray(t)||(t=Array.from(t));const e=t.length,r=new Float64Array(e),n=new Float64Array(e),o=new Float64Array(e);let i=1/0,s=1/0,a=1/0,u=-1/0,c=-1/0,h=-1/0;for(let d,l,f,g,p=0;p<e;++p)isNaN(l=+this._x.call(null,d=t[p]))||isNaN(f=+this._y.call(null,d))||isNaN(g=+this._z.call(null,d))||(r[p]=l,n[p]=f,o[p]=g,l<i&&(i=l),l>u&&(u=l),f<s&&(s=f),f>c&&(c=f),g<a&&(a=g),g>h&&(h=g));if(i>u||s>c||a>h)return this;this.cover(i,s,a).cover(u,c,h);for(let d=0;d<e;++d)ar(this,r[d],n[d],o[d],t[d]);return this},vr.cover=function(t,e,r){if(isNaN(t=+t)||isNaN(e=+e)||isNaN(r=+r))return this;var n=this._x0,o=this._y0,i=this._z0,s=this._x1,a=this._y1,u=this._z1;if(isNaN(n))s=(n=Math.floor(t))+1,a=(o=Math.floor(e))+1,u=(i=Math.floor(r))+1;else{for(var c,h,d=s-n||1,l=this._root;n>t||t>=s||o>e||e>=a||i>r||r>=u;)switch(h=(r<i)<<2|(e<o)<<1|t<n,(c=new Array(8))[h]=l,l=c,d*=2,h){case 0:s=n+d,a=o+d,u=i+d;break;case 1:n=s-d,a=o+d,u=i+d;break;case 2:s=n+d,o=a-d,u=i+d;break;case 3:n=s-d,o=a-d,u=i+d;break;case 4:s=n+d,a=o+d,i=u-d;break;case 5:n=s-d,a=o+d,i=u-d;break;case 6:s=n+d,o=a-d,i=u-d;break;case 7:n=s-d,o=a-d,i=u-d}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=o,this._z0=i,this._x1=s,this._y1=a,this._z1=u,this},vr.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},vr.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1],+t[0][2]).cover(+t[1][0],+t[1][1],+t[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},vr.find=function(t,e,r,n){var o,i,s,a,u,c,h,d,l,f=this._x0,g=this._y0,p=this._z0,v=this._x1,y=this._y1,m=this._z1,w=[],b=this._root;for(b&&w.push(new ur(b,f,g,p,v,y,m)),null==n?n=1/0:(f=t-n,g=e-n,p=r-n,v=t+n,y=e+n,m=r+n,n*=n);d=w.pop();)if(!(!(b=d.node)||(i=d.x0)>v||(s=d.y0)>y||(a=d.z0)>m||(u=d.x1)<f||(c=d.y1)<g||(h=d.z1)<p))if(b.length){var x=(i+u)/2,E=(s+c)/2,N=(a+h)/2;w.push(new ur(b[7],x,E,N,u,c,h),new ur(b[6],i,E,N,x,c,h),new ur(b[5],x,s,N,u,E,h),new ur(b[4],i,s,N,x,E,h),new ur(b[3],x,E,a,u,c,N),new ur(b[2],i,E,a,x,c,N),new ur(b[1],x,s,a,u,E,N),new ur(b[0],i,s,a,x,E,N)),(l=(r>=N)<<2|(e>=E)<<1|t>=x)&&(d=w[w.length-1],w[w.length-1]=w[w.length-1-l],w[w.length-1-l]=d)}else{var _=t-+this._x.call(null,b.data),M=e-+this._y.call(null,b.data),k=r-+this._z.call(null,b.data),A=_*_+M*M+k*k;if(A<n){var j=Math.sqrt(n=A);f=t-j,g=e-j,p=r-j,v=t+j,y=e+j,m=r+j,o=b.data}}return o},vr.findAllWithinRadius=function(t,e,r,n){const o=[],i=t-n,s=e-n,a=r-n,u=t+n,c=e+n,h=r+n;return this.visit(((d,l,f,g,p,v,y)=>{if(!d.length)do{const i=d.data;cr(t,e,r,this._x(i),this._y(i),this._z(i))<=n&&o.push(i)}while(d=d.next);return l>u||f>c||g>h||p<i||v<s||y<a})),o},vr.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(s=+this._y.call(null,t))||isNaN(a=+this._z.call(null,t)))return this;var e,r,n,o,i,s,a,u,c,h,d,l,f,g,p,v=this._root,y=this._x0,m=this._y0,w=this._z0,b=this._x1,x=this._y1,E=this._z1;if(!v)return this;if(v.length)for(;;){if((d=i>=(u=(y+b)/2))?y=u:b=u,(l=s>=(c=(m+x)/2))?m=c:x=c,(f=a>=(h=(w+E)/2))?w=h:E=h,e=v,!(v=v[g=f<<2|l<<1|d]))return this;if(!v.length)break;(e[g+1&7]||e[g+2&7]||e[g+3&7]||e[g+4&7]||e[g+5&7]||e[g+6&7]||e[g+7&7])&&(r=e,p=g)}for(;v.data!==t;)if(n=v,!(v=v.next))return this;return(o=v.next)&&delete v.next,n?(o?n.next=o:delete n.next,this):e?(o?e[g]=o:delete e[g],(v=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&v===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!v.length&&(r?r[p]=v:this._root=v),this):(this._root=o,this)},vr.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},vr.root=function(){return this._root},vr.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},vr.visit=function(t){var e,r,n,o,i,s,a,u,c=[],h=this._root;for(h&&c.push(new ur(h,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=c.pop();)if(!t(h=e.node,n=e.x0,o=e.y0,i=e.z0,s=e.x1,a=e.y1,u=e.z1)&&h.length){var d=(n+s)/2,l=(o+a)/2,f=(i+u)/2;(r=h[7])&&c.push(new ur(r,d,l,f,s,a,u)),(r=h[6])&&c.push(new ur(r,n,l,f,d,a,u)),(r=h[5])&&c.push(new ur(r,d,o,f,s,l,u)),(r=h[4])&&c.push(new ur(r,n,o,f,d,l,u)),(r=h[3])&&c.push(new ur(r,d,l,i,s,a,f)),(r=h[2])&&c.push(new ur(r,n,l,i,d,a,f)),(r=h[1])&&c.push(new ur(r,d,o,i,s,l,f)),(r=h[0])&&c.push(new ur(r,n,o,i,d,l,f))}return this},vr.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new ur(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=r.pop();){var o=e.node;if(o.length){var i,s=e.x0,a=e.y0,u=e.z0,c=e.x1,h=e.y1,d=e.z1,l=(s+c)/2,f=(a+h)/2,g=(u+d)/2;(i=o[0])&&r.push(new ur(i,s,a,u,l,f,g)),(i=o[1])&&r.push(new ur(i,l,a,u,c,f,g)),(i=o[2])&&r.push(new ur(i,s,f,u,l,h,g)),(i=o[3])&&r.push(new ur(i,l,f,u,c,h,g)),(i=o[4])&&r.push(new ur(i,s,a,g,l,f,d)),(i=o[5])&&r.push(new ur(i,l,a,g,c,f,d)),(i=o[6])&&r.push(new ur(i,s,f,g,l,h,d)),(i=o[7])&&r.push(new ur(i,l,f,g,c,h,d))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.z0,e.x1,e.y1,e.z1);return this},vr.x=function(t){return arguments.length?(this._x=t,this):this._x},vr.y=function(t){return arguments.length?(this._y=t,this):this._y},vr.z=function(t){return arguments.length?(this._z=t,this):this._z};function yr(t,e,r,n,o=2){const i=e/r,s=t.getAllNodes(),a=s.map(((t,e)=>{const{nodeStrength:r,x:n,y:o,z:s,size:a}=t.data;return{x:n,y:o,z:s,size:a,index:e,id:t.id,vx:0,vy:0,vz:0,weight:i*r}})),u=(2===o?nr(a,(t=>t.x),(t=>t.y)):fr(a,(t=>t.x),(t=>t.y),(t=>t.z))).visitAfter(mr),c=new Map;return a.forEach((t=>{c.set(t.id,t),function(t,e,r){e.visit(((e,n,o,i,s)=>wr(e,n,o,i,s,t,r)))}(t,u,o)})),a.map(((t,e)=>{const{id:r,data:o}=s[e],{mass:i=1}=o;n[r]={x:t.vx/i,y:t.vy/i,z:t.vz/i}})),n}function mr(t){let e=0,r=0,n=0,o=0,i=0;const s=t.length;if(s){for(let a=0;a<s;a++){const s=t[a];s&&s.weight&&(e+=s.weight,r+=s.x*s.weight,n+=s.y*s.weight,o+=s.z*s.weight,i+=s.size*s.weight)}t.x=r/e,t.y=n/e,t.z=o/e,t.size=i/e,t.weight=e}else{const e=t;t.x=e.data.x,t.y=e.data.y,t.z=e.data.z,t.size=e.data.size,t.weight=e.data.weight}}const wr=(t,e,r,n,o,i,s)=>{var a;if((null===(a=t.data)||void 0===a?void 0:a.id)===i.id)return;const u=[r,n,o][s-1],c=i.x-t.x||.1,h=i.y-t.y||.1,d=i.z-t.z||.1,l=[c,h,d],f=u-e;let g=0;for(let v=0;v<s;v++)g+=l[v]*l[v];const p=Math.sqrt(g)*g;if(f*f*.81<g){const e=t.weight/p;return i.vx+=c*e,i.vy+=h*e,i.vz+=d*e,!0}if(t.length)return!1;if(t.data!==i){const e=t.data.weight/p;i.vx+=c*e,i.vy+=h*e,i.vz+=d*e}};const br={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:50,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:200,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"};class xr{constructor(t={}){this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=Object.assign(Object.assign({},br),t)}execute(t,e){return o(this,void 0,void 0,(function*(){return this.genericForceLayout(!1,t,e)}))}assign(t,e){return o(this,void 0,void 0,(function*(){yield this.genericForceLayout(!0,t,e)}))}stop(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1}tick(t=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<t;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);const e={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&e.nodes.forEach((t=>this.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===this.options.dimensions?t.data.z:void 0}))),e}genericForceLayout(t,e,r){return o(this,void 0,void 0,(function*(){const n=Object.assign(Object.assign({},this.options),r),o=e.getAllNodes(),i=e.getAllEdges(),s=this.formatOptions(n,e),{dimensions:a,width:u,height:c,nodeSize:d,getMass:l,nodeStrength:f,edgeStrength:g,linkDistance:p}=s,v=o.map(((t,e)=>Object.assign(Object.assign({},t),{data:Object.assign(Object.assign({},t.data),{x:D(t.data.x)?t.data.x:Math.random()*u,y:D(t.data.y)?t.data.y:Math.random()*c,z:D(t.data.z)?t.data.z:Math.random()*Math.sqrt(u*c),size:d(t)||30,mass:l(t),nodeStrength:f(t)})}))),y=i.map((t=>Object.assign(Object.assign({},t),{data:Object.assign(Object.assign({},t.data),{edgeStrength:g(t),linkDistance:p(t,e.getNode(t.source),e.getNode(t.target))})})));if(!(null==o?void 0:o.length))return this.lastResult={nodes:[],edges:i},{nodes:[],edges:i};const m={};o.forEach(((t,e)=>{m[t.id]={x:0,y:0,z:0}}));const w=new h({nodes:v,edges:y});this.formatCentripetal(s,w);const{maxIteration:b,minMovement:x,onTick:E}=s;if(this.lastLayoutNodes=v,this.lastLayoutEdges=y,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=w,this.lastOptions=s,this.lastVelMap=m,"undefined"==typeof window)return;let N=0;return new Promise((r=>{this.timeInterval=window.setInterval((()=>{o&&this.running||r({nodes:kr(e,v),edges:i}),this.runOneStep(w,e,N,m,s),this.updatePosition(e,w,m,s),t&&v.forEach((t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===a?t.data.z:void 0}))),null==E||E({nodes:kr(e,v),edges:i}),N++,(N>=b||this.judgingDistance<x)&&(window.clearInterval(this.timeInterval),r({nodes:kr(e,v),edges:i}))}),0),this.running=!0}))}))}formatOptions(t,e){const r=Object.assign({},t),{width:n,height:o,getMass:i}=t;r.width=n||"undefined"==typeof window?n:window.innerWidth,r.height=o||"undefined"==typeof window?o:window.innerHeight,t.center||(r.center=[r.width/2,r.height/2]),i||(r.getMass=t=>{let r=1;D(null==t?void 0:t.data.mass)&&(r=null==t?void 0:t.data.mass);const n=e.getDegree(t.id,"both");return!n||n<5?r:5*n*r}),r.nodeSize=Ue(t.nodeSize,t.nodeSpacing);const s=t.linkDistance?Ge(1,t.linkDistance):t=>1+r.nodeSize(e.getNode(t.source))+r.nodeSize(e.getNode(t.target));return r.linkDistance=s,r.nodeStrength=Ge(1,t.nodeStrength),r.edgeStrength=Ge(1,t.edgeStrength),r}formatCentripetal(t,e){const{dimensions:r,centripetalOptions:n,center:o,clusterNodeStrength:i,leafCluster:s,clustering:a,nodeClusterBy:u}=t,c=e.getAllNodes(),h=n||{leaf:2,single:2,others:1,center:t=>({x:o[0],y:o[1],z:3===r?o[2]:void 0})};let d,l;if("function"!=typeof i&&(t.clusterNodeStrength=t=>i),s&&u&&(d=Er(e,u),l=Array.from(new Set(null==c?void 0:c.map((t=>t.data[u]))))||[],t.centripetalOptions=Object.assign(h,{single:100,leaf:e=>{const{siblingLeaves:r,sameTypeLeaves:n}=d[e.id]||{};return(null==n?void 0:n.length)===(null==r?void 0:r.length)||1===(null==l?void 0:l.length)?1:t.clusterNodeStrength(e)},others:1,center:t=>{const r=e.getDegree(t.id,"both");if(!r)return{x:100,y:100,z:0};let n;if(1===r){const{sameTypeLeaves:e=[]}=d[t.id]||{};1===e.length?n=void 0:e.length>1&&(n=Mr(e))}else n=void 0;return{x:null==n?void 0:n.x,y:null==n?void 0:n.y,z:null==n?void 0:n.z}}})),a&&u){d||(d=Er(e,u)),l||(l=Array.from(new Set(c.map((t=>t.data[u]))))),l=l.filter((t=>void 0!==t));const r={};l.forEach((t=>{const n=c.filter((e=>e.data[u]===t)).map((t=>e.getNode(t.id)));r[t]=Mr(n)})),t.centripetalOptions=Object.assign(h,{single:e=>t.clusterNodeStrength(e),leaf:e=>t.clusterNodeStrength(e),others:e=>t.clusterNodeStrength(e),center:t=>{const e=r[t.data[u]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y,z:null==e?void 0:e.z}}})}const{leaf:f,single:g,others:p}=t.centripetalOptions||{};f&&"function"!=typeof f&&(t.centripetalOptions.leaf=()=>f),g&&"function"!=typeof g&&(t.centripetalOptions.single=()=>g),p&&"function"!=typeof p&&(t.centripetalOptions.others=()=>p)}runOneStep(t,e,r,n,o){const i={},s=t.getAllNodes(),a=t.getAllEdges();if(!(null==s?void 0:s.length))return;const{monitor:u}=o;if(this.calRepulsive(t,i,o),a&&this.calAttractive(t,i,o),this.calGravity(t,e,i,o),this.updateVelocity(t,i,n,o),u){u({energy:this.calTotalEnergy(i,s),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:r})}}calTotalEnergy(t,e){if(!(null==e?void 0:e.length))return 0;let r=0;return e.forEach(((e,n)=>{const o=t[e.id].x,i=t[e.id].y,s=3===this.options.dimensions?t[e.id].z:0,a=o*o+i*i+s*s,{mass:u=1}=e.data;r+=u*a*.5})),r}calRepulsive(t,e,r){const{dimensions:n,factor:o,coulombDisScale:i}=r;yr(t,o,i*i,e,n)}calAttractive(t,e,r){const{dimensions:n,nodeSize:o}=r;t.getAllEdges().forEach(((r,i)=>{const{source:s,target:a}=r,u=t.getNode(s),c=t.getNode(a);if(!u||!c)return;let h=c.data.x-u.data.x,d=c.data.y-u.data.y,l=3===n?c.data.z-u.data.z:0;h||d||(h=.01*Math.random(),d=.01*Math.random(),3!==n||l||(l=.01*Math.random()));const f=Math.sqrt(h*h+d*d+l*l);if(f<o(u)+o(c))return;const g=h/f,p=d/f,v=l/f,{linkDistance:y=200,edgeStrength:m=200}=r.data||{},w=(y-f)*m,b=1/(u.data.mass||1),x=1/(c.data.mass||1),E=g*w,N=p*w,_=v*w;e[s].x-=E*b,e[s].y-=N*b,e[s].z-=_*b,e[a].x+=E*x,e[a].y+=N*x,e[a].z+=_*x}))}calGravity(t,e,r,n){const{getCenter:o}=n,i=t.getAllNodes(),s=e.getAllNodes(),a=e.getAllEdges(),{width:u,height:c,center:h,gravity:d,centripetalOptions:l}=n;i&&i.forEach((n=>{const{id:i,data:f}=n,{mass:g,x:p,y:v,z:y}=f,m=e.getNode(i);let w=0,b=0,x=0,E=d;const N=t.getDegree(i,"in"),_=t.getDegree(i,"out"),M=t.getDegree(i,"both"),k=null==o?void 0:o(m,M);if(k){const[t,e,r]=k;w=p-t,b=v-e,E=r}else w=p-h[0],b=v-h[1],x=y-h[2];if(E&&(r[i].x-=E*w/g,r[i].y-=E*b/g,r[i].z-=E*x/g),l){const{leaf:t,single:e,others:n,center:o}=l,{x:h,y:d,z:f,centerStrength:w}=(null==o?void 0:o(m,s,a,u,c))||{x:0,y:0,z:0,centerStrength:0};if(!D(h)||!D(d))return;const b=(p-h)/g,x=(v-d)/g,E=(y-f)/g;if(w&&(r[i].x-=w*b,r[i].y-=w*x,r[i].z-=w*E),0===M){const t=e(m);if(!t)return;return r[i].x-=t*b,r[i].y-=t*x,void(r[i].z-=t*E)}if(0===N||0===_){const e=t(m,s,a);if(!e)return;return r[i].x-=e*b,r[i].y-=e*x,void(r[i].z-=e*E)}const k=n(m);if(!k)return;r[i].x-=k*b,r[i].y-=k*x,r[i].z-=k*E}}))}updateVelocity(t,e,r,n){const{damping:o,maxSpeed:i,interval:s,dimensions:a}=n,u=t.getAllNodes();(null==u?void 0:u.length)&&u.forEach((t=>{const{id:n}=t;let u=(r[n].x+e[n].x*s)*o||.01,c=(r[n].y+e[n].y*s)*o||.01,h=3===a?(r[n].z+e[n].z*s)*o||.01:0;const d=Math.sqrt(u*u+c*c+h*h);if(d>i){const t=i/d;u*=t,c*=t,h*=t}r[n]={x:u,y:c,z:h}}))}updatePosition(t,e,r,n){const{distanceThresholdMode:o,interval:i,dimensions:s}=n,a=e.getAllNodes();if(!(null==a?void 0:a.length))return void(this.judgingDistance=0);let u=0;"max"===o?this.judgingDistance=-1/0:"min"===o&&(this.judgingDistance=1/0),a.forEach((n=>{const{id:a}=n,c=t.getNode(a);if(D(c.data.fx)&&D(c.data.fy))return void e.mergeNodeData(a,{x:c.data.fx,y:c.data.fy,z:3===s?c.data.fz:void 0});const h=r[a].x*i,d=r[a].y*i,l=3===s?r[a].z*i:0;e.mergeNodeData(a,{x:n.data.x+h,y:n.data.y+d,z:n.data.z+l});const f=Math.sqrt(h*h+d*d+l*l);switch(o){case"max":this.judgingDistance<f&&(this.judgingDistance=f);break;case"min":this.judgingDistance>f&&(this.judgingDistance=f);break;default:u+=f}})),o&&"mean"!==o||(this.judgingDistance=u/a.length)}}const Er=(t,e)=>{const r=t.getAllNodes();if(!(null==r?void 0:r.length))return{};const n={};return r.forEach(((r,o)=>{1===t.getDegree(r.id,"both")&&(n[r.id]=Nr(t,"leaf",r,e))})),n},Nr=(t,e,r,n)=>{const o=t.getDegree(r.id,"in"),i=t.getDegree(r.id,"out");let s=r,a=[];0===o?(s=t.getSuccessors(r.id)[0],a=t.getNeighbors(s.id)):0===i&&(s=t.getPredecessors(r.id)[0],a=t.getNeighbors(s.id)),a=a.filter((e=>0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")));return{coreNode:s,siblingLeaves:a,sameTypeLeaves:_r(t,e,n,r,a)}},_r=(t,e,r,n,o)=>{const i=n.data[r]||"";let s=(null==o?void 0:o.filter((t=>t.data[r]===i)))||[];return s=s.filter((e=>0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out"))),s},Mr=t=>{const e={x:0,y:0};t.forEach((t=>{const{x:r,y:n}=t.data;e.x+=r||0,e.y+=n||0}));const r=t.length||1;return{x:e.x/r,y:e.y/r}},kr=(t,e)=>e.map((e=>{const{id:r,data:n}=e,o=t.getNode(r);return Object.assign(Object.assign({},o),{data:Object.assign(Object.assign({},o.data),{x:n.x,y:n.y,z:n.z})})}));var Ar="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function jr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Sr(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var r=function t(){return this instanceof t?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,n.get?n:{enumerable:!0,get:function(){return t[e]}})})),r}var Or={};const zr=Object.prototype.toString;function Rr(t){const e=zr.call(t);return e.endsWith("Array]")&&!e.includes("Big")}var Ir=Sr(Object.freeze({__proto__:null,isAnyArray:Rr}));var Cr=Object.freeze({__proto__:null,default:function(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Rr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!Rr(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Rr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[n],a=n+1;a<i;a++)t[a]<s&&(s=t[a]);return s}(t),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Rr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[n],a=n+1;a<i;a++)t[a]>s&&(s=t[a]);return s}(t);if(n===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=r.min,s=void 0===i?r.autoMinMax?n:0:i,a=r.max,u=void 0===a?r.autoMinMax?o:1:a;if(s>=u)throw new RangeError("min option must be smaller than max option");for(var c=(u-s)/(o-n),h=0;h<t.length;h++)e[h]=(t[h]-n)*c+s;return e}}),Pr=Sr(Cr);Object.defineProperty(Or,"__esModule",{value:!0});var Dr=Ir,Tr=Pr;const Fr=" ".repeat(2),Lr=" ".repeat(4);function qr(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:o=8,padMinus:i="auto"}=e;return`${t.constructor.name} {\n${Fr}[\n${Lr}${function(t,e,r,n,o){const{rows:i,columns:s}=t,a=Math.min(i,e),u=Math.min(s,r),c=[];if("auto"===o){o=!1;t:for(let e=0;e<a;e++)for(let r=0;r<u;r++)if(t.get(e,r)<0){o=!0;break t}}for(let h=0;h<a;h++){let e=[];for(let r=0;r<u;r++)e.push(Vr(t.get(h,r),n,o));c.push(`${e.join(" ")}`)}u!==s&&(c[c.length-1]+=` ... ${s-r} more columns`);a!==i&&c.push(`... ${i-e} more rows`);return c.join(`\n${Lr}`)}(t,r,n,o,i)}\n${Fr}]\n${Fr}rows: ${t.rows}\n${Fr}columns: ${t.columns}\n}`}function Vr(t,e,r){return(t>=0&&r?` ${Gr(t,e-1)}`:Gr(t,e)).padEnd(e)}function Gr(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let o=t.toExponential(e);return o.length>e&&(o=t.toExponential(Math.max(0,e-(o.length-e)))),o.slice(0)}function Br(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function Ur(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function $r(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function Wr(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function Yr(t,e){if(!Dr.isAnyArray(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}function Hr(t,e){if(!Dr.isAnyArray(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}function Kr(t,e,r,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(Qr("startRow",e),Qr("endRow",r),Qr("startColumn",n),Qr("endColumn",o),e>r||n>o||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function Jr(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function Qr(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function Xr(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class Zr{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new en(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)n.set(o,t,r[o*e+t]);return n}static rowVector(t){let e=new en(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new en(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new en(t,e)}static ones(t,e){return new en(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let o=new en(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++)o.set(i,t,n());return o}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(n>=o)throw new RangeError("min must be smaller than max");let s=o-n,a=new en(t,e);for(let u=0;u<t;u++)for(let t=0;t<e;t++){let e=n+Math.round(i()*s);a.set(u,t,e)}return a}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),o=this.zeros(t,e);for(let i=0;i<n;i++)o.set(i,i,r);return o}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let o=Math.min(n,e,r),i=this.zeros(e,r);for(let s=0;s<o;s++)i.set(s,s,t[s]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new en(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new this(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return o}static checkMatrix(t){return Zr.isMatrix(t)?t:new en(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(n,r)&&(n=o);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let o=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/o);for(let n=e+1;n<t.rows;n++){let o=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let i=r+1;i<t.columns;i++)t.set(n,i,t.get(n,i)-t.get(e,i)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let o=0,i=!1;for(;o<r&&!1===i;)1===t.get(n,o)?i=!0:o++;for(let r=0;r<n;r++){let i=t.get(r,o);for(let s=o;s<e;s++){let e=t.get(r,s)-i*t.get(n,s);t.set(r,s,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new en(this.rows*e,this.columns*r);for(let o=0;o<e;o++)for(let t=0;t<r;t++)n.setSubMatrix(this,this.rows*o,this.columns*t);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){Br(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return en.rowVector(this.getRow(t))}setRow(t,e){Br(this,t),e=$r(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){Br(this,t),Br(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){Ur(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return en.columnVector(this.getColumn(t))}setColumn(t,e){Ur(this,t),e=Wr(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){Ur(this,t),Ur(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=$r(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=$r(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=$r(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=$r(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=Wr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=Wr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=Wr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=Wr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){Br(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){Ur(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){Xr(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){Xr(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(Br(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){Br(this,t),Xr(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(Br(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){Br(this,t),Xr(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(Ur(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){Ur(this,t),Xr(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(Ur(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){Ur(this,t),Xr(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){Zr.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=en.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,o=new en(e,n),i=new Float64Array(r);for(let s=0;s<n;s++){for(let e=0;e<r;e++)i[e]=t.get(e,s);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*i[n];o.set(t,s,e)}}return o}mpow(t){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(t)||t<0)throw new RangeError("Exponent must be a non-negative integer");let e=en.eye(this.rows),r=this;for(let n=t;n>=1;n/=2)1&n&&(e=e.mmul(r)),r=r.mmul(r);return e}strassen2x2(t){t=en.checkMatrix(t);let e=new en(2,2);const r=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),s=this.get(1,0),a=t.get(1,0),u=this.get(1,1),c=t.get(1,1),h=(r+u)*(n+c),d=(s+u)*n,l=r*(i-c),f=u*(a-n),g=(r+o)*c,p=h+f-g+(o-u)*(a+c),v=l+g,y=d+f,m=h-d+l+(s-r)*(n+i);return e.set(0,0,p),e.set(0,1,v),e.set(1,0,y),e.set(1,1,m),e}strassen3x3(t){t=en.checkMatrix(t);let e=new en(3,3);const r=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),s=this.get(1,1),a=this.get(1,2),u=this.get(2,0),c=this.get(2,1),h=this.get(2,2),d=t.get(0,0),l=t.get(0,1),f=t.get(0,2),g=t.get(1,0),p=t.get(1,1),v=t.get(1,2),y=t.get(2,0),m=t.get(2,1),w=t.get(2,2),b=(r-i)*(-l+p),x=(-r+i+s)*(d-l+p),E=(i+s)*(-d+l),N=r*d,_=(-r+u+c)*(d-f+v),M=(-r+u)*(f-v),k=(u+c)*(-d+f),A=(-o+c+h)*(p+y-m),j=(o-h)*(p-m),S=o*y,O=(c+h)*(-y+m),z=(-o+s+a)*(v+y-w),R=(o-a)*(v-w),I=(s+a)*(-y+w),C=N+S+n*g,P=(r+n+o-i-s-c-h)*p+x+E+N+A+S+O,D=N+_+k+(r+n+o-s-a-u-c)*v+S+z+I,T=b+s*(-d+l+g-p-v-y+w)+x+N+S+z+R,F=b+x+E+N+a*m,L=S+z+R+I+i*f,q=N+_+M+c*(-d+f+g-p-v-y+m)+A+j+S,V=A+j+S+O+u*l,G=N+_+M+k+h*w;return e.set(0,0,C),e.set(0,1,P),e.set(0,2,D),e.set(1,0,T),e.set(1,1,F),e.set(1,2,L),e.set(2,0,q),e.set(2,1,V),e.set(2,2,G),e}mmulStrassen(t){t=en.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,o=t.rows,i=t.columns;function s(t,e,r){let n=t.rows,o=t.columns;if(n===e&&o===r)return t;{let n=Zr.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}let a=Math.max(r,o),u=Math.max(n,i);return e=s(e,a,u),function t(e,r,n,o){if(n<=512||o<=512)return e.mmul(r);n%2==1&&o%2==1?(e=s(e,n+1,o+1),r=s(r,n+1,o+1)):n%2==1?(e=s(e,n+1,o),r=s(r,n+1,o)):o%2==1&&(e=s(e,n,o+1),r=s(r,n,o+1));let i=parseInt(e.rows/2,10),a=parseInt(e.columns/2,10),u=e.subMatrix(0,i-1,0,a-1),c=r.subMatrix(0,i-1,0,a-1),h=e.subMatrix(0,i-1,a,e.columns-1),d=r.subMatrix(0,i-1,a,r.columns-1),l=e.subMatrix(i,e.rows-1,0,a-1),f=r.subMatrix(i,r.rows-1,0,a-1),g=e.subMatrix(i,e.rows-1,a,e.columns-1),p=r.subMatrix(i,r.rows-1,a,r.columns-1),v=t(Zr.add(u,g),Zr.add(c,p),i,a),y=t(Zr.add(l,g),c,i,a),m=t(u,Zr.sub(d,p),i,a),w=t(g,Zr.sub(f,c),i,a),b=t(Zr.add(u,h),p,i,a),x=t(Zr.sub(l,u),Zr.add(c,d),i,a),E=t(Zr.sub(h,g),Zr.add(f,p),i,a),N=Zr.add(v,w);N.sub(b),N.add(E);let _=Zr.add(m,b),M=Zr.add(y,w),k=Zr.sub(v,y);k.add(m),k.add(x);let A=Zr.zeros(2*N.rows,2*N.columns);return A=A.setSubMatrix(N,0,0),A=A.setSubMatrix(_,N.rows,0),A=A.setSubMatrix(M,0,N.columns),A=A.setSubMatrix(k,N.rows,N.columns),A.subMatrix(0,n-1,0,o-1)}(e,t=s(t,a,u),a,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new en(this.rows,this.columns);for(let o=0;o<this.rows;o++){const t=this.getRow(o);t.length>0&&Tr(t,{min:e,max:r,output:t}),n.setRow(o,t)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new en(this.rows,this.columns);for(let o=0;o<this.columns;o++){const t=this.getColumn(o);t.length&&Tr(t,{min:e,max:r,output:t}),n.setColumn(o,t)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=en.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,o=t.columns,i=new en(e*n,r*o);for(let s=0;s<e;s++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let a=0;a<o;a++)i.set(n*s+r,o*e+a,this.get(s,e)*t.get(r,a));return i}kroneckerSum(t){if(t=en.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(en.eye(r,r)),o=en.eye(e,e).kroneckerProduct(t);return n.add(o)}transpose(){let t=new en(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=tn){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=tn){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){Kr(this,t,e,r,n);let o=new en(e-t+1,n-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=n;e++)o.set(i-t,e-r,this.get(i,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new en(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-e,this.get(t[o],i))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new en(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-e,o,this.get(i,t[o]))}return n}setSubMatrix(t,e,r){if((t=en.checkMatrix(t)).isEmpty())return this;Kr(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let o=0;o<t.columns;o++)this.set(e+n,r+o,t.get(n,o));return this}selection(t,e){Yr(this,t),Hr(this,e);let r=new en(t.length,e.length);for(let n=0;n<t.length;n++){let o=t[n];for(let t=0;t<e.length;t++){let i=e[t];r.set(n,t,this.get(o,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){return this.constructor.copy(this,new en(this.rows,this.columns))}static copy(t,e){for(const[r,n,o]of t.entries())e.set(r,n,o);return e}sum(t){switch(t){case"row":return function(t){let e=Jr(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=Jr(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=Jr(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=Jr(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Dr.isAnyArray(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let s=0;s<n;s++){let n=0,a=0,u=0;for(let e=0;e<o;e++)u=t.get(s,e)-r[s],n+=u,a+=u*u;e?i.push((a-n*n/o)/(o-1)):i.push((a-n*n/o)/o)}return i}(this,r,n);case"column":if(!Dr.isAnyArray(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let s=0;s<o;s++){let o=0,a=0,u=0;for(let e=0;e<n;e++)u=t.get(e,s)-r[s],o+=u,a+=u*u;e?i.push((a-o*o/n)/(n-1)):i.push((a-o*o/n)/n)}return i}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,o=t.columns,i=n*o;let s=0,a=0,u=0;for(let c=0;c<n;c++)for(let e=0;e<o;e++)u=t.get(c,e)-r,s+=u,a+=u*u;return e?(a-s*s/i)/(i-1):(a-s*s/i)/i}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let n=0;n<r.length;n++)r[n]=Math.sqrt(r[n]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Dr.isAnyArray(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!Dr.isAnyArray(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=t.get(r,e)**2/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!Dr.isAnyArray(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=t.get(e,r)**2/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!Dr.isAnyArray(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let o=0;o<t.rows;o++)r+=t.get(o,n)**2/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return qr(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}}function tn(t,e){return t-e}Zr.prototype.klass="Matrix","undefined"!=typeof Symbol&&(Zr.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return qr(this)}),Zr.random=Zr.rand,Zr.randomInt=Zr.randInt,Zr.diagonal=Zr.diag,Zr.prototype.diagonal=Zr.prototype.diag,Zr.identity=Zr.eye,Zr.prototype.negate=Zr.prototype.neg,Zr.prototype.tensorProduct=Zr.prototype.kroneckerProduct;let en=(r=class extends Zr{constructor(n,o){if(super(),__privateAdd(this,t),__publicField(this,"data"),r.isMatrix(n))__privateMethod(this,t,e).call(this,n.rows,n.columns),r.copy(n,this);else if(Number.isInteger(n)&&n>=0)__privateMethod(this,t,e).call(this,n,o);else{if(!Dr.isAnyArray(n))throw new TypeError("First argument must be a positive number or an array");{const t=n;if("number"!=typeof(o=(n=t.length)?t[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let e=0;e<n;e++){if(t[e].length!==o)throw new RangeError("Inconsistent array dimensions");if(!t[e].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(t[e]))}this.rows=n,this.columns=o}}}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return Br(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),Br(this,t,!0),e=Float64Array.from($r(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){Ur(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),Ur(this,t,!0),e=Wr(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)n[o]=this.data[r][o];for(n[o++]=e[r];o<this.columns+1;o++)n[o]=this.data[r][o-1];this.data[r]=n}return this.columns+=1,this}},t=new WeakSet,e=function(t,e){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e));this.rows=t,this.columns=e},r);var rn,nn;nn=en,(rn=Zr).prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},rn.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},rn.prototype.addM=function(t){if(t=nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},rn.add=function(t,e){return new nn(t).add(e)},rn.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},rn.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},rn.prototype.subM=function(t){if(t=nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},rn.sub=function(t,e){return new nn(t).sub(e)},rn.prototype.subtract=rn.prototype.sub,rn.prototype.subtractS=rn.prototype.subS,rn.prototype.subtractM=rn.prototype.subM,rn.subtract=rn.sub,rn.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},rn.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},rn.prototype.mulM=function(t){if(t=nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},rn.mul=function(t,e){return new nn(t).mul(e)},rn.prototype.multiply=rn.prototype.mul,rn.prototype.multiplyS=rn.prototype.mulS,rn.prototype.multiplyM=rn.prototype.mulM,rn.multiply=rn.mul,rn.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},rn.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},rn.prototype.divM=function(t){if(t=nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},rn.div=function(t,e){return new nn(t).div(e)},rn.prototype.divide=rn.prototype.div,rn.prototype.divideS=rn.prototype.divS,rn.prototype.divideM=rn.prototype.divM,rn.divide=rn.div,rn.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},rn.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},rn.prototype.modM=function(t){if(t=nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},rn.mod=function(t,e){return new nn(t).mod(e)},rn.prototype.modulus=rn.prototype.mod,rn.prototype.modulusS=rn.prototype.modS,rn.prototype.modulusM=rn.prototype.modM,rn.modulus=rn.mod,rn.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},rn.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},rn.prototype.andM=function(t){if(t=nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},rn.and=function(t,e){return new nn(t).and(e)},rn.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},rn.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},rn.prototype.orM=function(t){if(t=nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},rn.or=function(t,e){return new nn(t).or(e)},rn.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},rn.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},rn.prototype.xorM=function(t){if(t=nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},rn.xor=function(t,e){return new nn(t).xor(e)},rn.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},rn.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},rn.prototype.leftShiftM=function(t){if(t=nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},rn.leftShift=function(t,e){return new nn(t).leftShift(e)},rn.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},rn.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},rn.prototype.signPropagatingRightShiftM=function(t){if(t=nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},rn.signPropagatingRightShift=function(t,e){return new nn(t).signPropagatingRightShift(e)},rn.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},rn.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},rn.prototype.rightShiftM=function(t){if(t=nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},rn.rightShift=function(t,e){return new nn(t).rightShift(e)},rn.prototype.zeroFillRightShift=rn.prototype.rightShift,rn.prototype.zeroFillRightShiftS=rn.prototype.rightShiftS,rn.prototype.zeroFillRightShiftM=rn.prototype.rightShiftM,rn.zeroFillRightShift=rn.rightShift,rn.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},rn.not=function(t){return new nn(t).not()},rn.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},rn.abs=function(t){return new nn(t).abs()},rn.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},rn.acos=function(t){return new nn(t).acos()},rn.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},rn.acosh=function(t){return new nn(t).acosh()},rn.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},rn.asin=function(t){return new nn(t).asin()},rn.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},rn.asinh=function(t){return new nn(t).asinh()},rn.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},rn.atan=function(t){return new nn(t).atan()},rn.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},rn.atanh=function(t){return new nn(t).atanh()},rn.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},rn.cbrt=function(t){return new nn(t).cbrt()},rn.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},rn.ceil=function(t){return new nn(t).ceil()},rn.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},rn.clz32=function(t){return new nn(t).clz32()},rn.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},rn.cos=function(t){return new nn(t).cos()},rn.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},rn.cosh=function(t){return new nn(t).cosh()},rn.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},rn.exp=function(t){return new nn(t).exp()},rn.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},rn.expm1=function(t){return new nn(t).expm1()},rn.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},rn.floor=function(t){return new nn(t).floor()},rn.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},rn.fround=function(t){return new nn(t).fround()},rn.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},rn.log=function(t){return new nn(t).log()},rn.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},rn.log1p=function(t){return new nn(t).log1p()},rn.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},rn.log10=function(t){return new nn(t).log10()},rn.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},rn.log2=function(t){return new nn(t).log2()},rn.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},rn.round=function(t){return new nn(t).round()},rn.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},rn.sign=function(t){return new nn(t).sign()},rn.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},rn.sin=function(t){return new nn(t).sin()},rn.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},rn.sinh=function(t){return new nn(t).sinh()},rn.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},rn.sqrt=function(t){return new nn(t).sqrt()},rn.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},rn.tan=function(t){return new nn(t).tan()},rn.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},rn.tanh=function(t){return new nn(t).tanh()},rn.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},rn.trunc=function(t){return new nn(t).trunc()},rn.pow=function(t,e){return new nn(t).pow(e)},rn.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},rn.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)**t);return this},rn.prototype.powM=function(t){if(t=nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)**t.get(e,r));return this};n=new WeakMap;let on=class t extends Zr{constructor(t){if(super(),__privateAdd(this,n),en.isMatrix(t)){if(!t.isSymmetric())throw new TypeError("not symmetric data");__privateSet(this,n,en.copy(t,new en(t.rows,t.rows)))}else if(Number.isInteger(t)&&t>=0)__privateSet(this,n,new en(t,t));else if(__privateSet(this,n,new en(t)),!this.isSymmetric())throw new TypeError("not symmetric data")}get size(){return __privateGet(this,n).size}get rows(){return __privateGet(this,n).rows}get columns(){return __privateGet(this,n).columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return en.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}clone(){const e=new t(this.diagonalSize);for(const[t,r,n]of this.upperRightEntries())e.set(t,r,n);return e}toMatrix(){return new en(this)}get(t,e){return __privateGet(this,n).get(t,e)}set(t,e,r){return __privateGet(this,n).set(t,e,r),__privateGet(this,n).set(e,t,r),this}removeCross(t){return __privateGet(this,n).removeRow(t),__privateGet(this,n).removeColumn(t),this}addCross(t,e){void 0===e&&(e=t,t=this.diagonalSize);const r=e.slice();return r.splice(t,1),__privateGet(this,n).addRow(t,r),__privateGet(this,n).addColumn(t,e),this}applyMask(t){if(t.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const e=[];for(const[r,n]of t.entries())n||e.push(r);e.reverse();for(const r of e)this.removeCross(r);return this}toCompact(){const{diagonalSize:t}=this,e=new Array(t*(t+1)/2);for(let r=0,n=0,o=0;o<e.length;o++)e[o]=this.get(n,r),++r>=t&&(r=++n);return e}static fromCompact(e){const r=e.length,n=(Math.sqrt(8*r+1)-1)/2;if(!Number.isInteger(n))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(e)}`);const o=new t(n);for(let t=0,i=0,s=0;s<r;s++)o.set(t,i,e[s]),++t>=n&&(t=++i);return o}*upperRightEntries(){for(let t=0,e=0;t<this.diagonalSize;void 0){const r=this.get(t,e);yield[t,e,r],++e>=this.diagonalSize&&(e=++t)}}*upperRightValues(){for(let t=0,e=0;t<this.diagonalSize;void 0){const r=this.get(t,e);yield r,++e>=this.diagonalSize&&(e=++t)}}};on.prototype.klassType="SymmetricMatrix";class sn extends on{static isDistanceMatrix(t){return on.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}constructor(t){if(super(t),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(t,e,r){return t===e&&(r=0),super.set(t,e,r)}addCross(t,e){return void 0===e&&(e=t,t=this.diagonalSize),(e=e.slice())[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new on(this)}clone(){const t=new sn(this.diagonalSize);for(const[e,r,n]of this.upperRightEntries())e!==r&&t.set(e,r,n);return t}toCompact(){const{diagonalSize:t}=this,e=new Array((t-1)*t/2);for(let r=1,n=0,o=0;o<e.length;o++)e[o]=this.get(n,r),++r>=t&&(r=1+ ++n);return e}static fromCompact(t){const e=t.length;if(0===e)return new this(0);const r=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(r))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);const n=new this(r);for(let o=1,i=0,s=0;s<e;s++)n.set(o,i,t[s]),++o>=r&&(o=1+ ++i);return n}}sn.prototype.klassSubType="DistanceMatrix";class an extends Zr{constructor(t,e,r){super(),this.matrix=t,this.rows=e,this.columns=r}}class un extends an{constructor(t,e,r){Yr(t,e),Hr(t,r),super(t,e.length,r.length),this.rowIndices=e,this.columnIndices=r}set(t,e,r){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],r),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class cn extends Zr{constructor(t,e={}){const{rows:r=1}=e;if(t.length%r!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=r,this.columns=t.length/r,this.data=t}set(t,e,r){let n=this._calculateIndex(t,e);return this.data[n]=r,this}get(t,e){let r=this._calculateIndex(t,e);return this.data[r]}_calculateIndex(t,e){return t*this.columns+e}}class hn extends Zr{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}class dn{constructor(t){let e,r,n,o,i,s,a,u,c,h=(t=hn.checkMatrix(t)).clone(),d=h.rows,l=h.columns,f=new Float64Array(d),g=1;for(e=0;e<d;e++)f[e]=e;for(u=new Float64Array(d),r=0;r<l;r++){for(e=0;e<d;e++)u[e]=h.get(e,r);for(e=0;e<d;e++){for(c=Math.min(e,r),i=0,n=0;n<c;n++)i+=h.get(e,n)*u[n];u[e]-=i,h.set(e,r,u[e])}for(o=r,e=r+1;e<d;e++)Math.abs(u[e])>Math.abs(u[o])&&(o=e);if(o!==r){for(n=0;n<l;n++)s=h.get(o,n),h.set(o,n,h.get(r,n)),h.set(r,n,s);a=f[o],f[o]=f[r],f[r]=a,g=-g}if(r<d&&0!==h.get(r,r))for(e=r+1;e<d;e++)h.set(e,r,h.get(e,r)/h.get(r,r))}this.LU=h,this.pivotVector=f,this.pivotSign=g}isSingular(){let t=this.LU,e=t.columns;for(let r=0;r<e;r++)if(0===t.get(r,r))return!0;return!1}solve(t){t=en.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let r,n,o,i=t.columns,s=t.subMatrixRow(this.pivotVector,0,i-1),a=e.columns;for(o=0;o<a;o++)for(r=o+1;r<a;r++)for(n=0;n<i;n++)s.set(r,n,s.get(r,n)-s.get(o,n)*e.get(r,o));for(o=a-1;o>=0;o--){for(n=0;n<i;n++)s.set(o,n,s.get(o,n)/e.get(o,o));for(r=0;r<o;r++)for(n=0;n<i;n++)s.set(r,n,s.get(r,n)-s.get(o,n)*e.get(r,o))}return s}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,r=t.columns;for(let n=0;n<r;n++)e*=t.get(n,n);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,n=new en(e,r);for(let o=0;o<e;o++)for(let e=0;e<r;e++)o>e?n.set(o,e,t.get(o,e)):o===e?n.set(o,e,1):n.set(o,e,0);return n}get upperTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,n=new en(e,r);for(let o=0;o<e;o++)for(let e=0;e<r;e++)o<=e?n.set(o,e,t.get(o,e)):n.set(o,e,0);return n}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function ln(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class fn{constructor(t){let e,r,n,o,i=(t=hn.checkMatrix(t)).clone(),s=t.rows,a=t.columns,u=new Float64Array(a);for(n=0;n<a;n++){let t=0;for(e=n;e<s;e++)t=ln(t,i.get(e,n));if(0!==t){for(i.get(n,n)<0&&(t=-t),e=n;e<s;e++)i.set(e,n,i.get(e,n)/t);for(i.set(n,n,i.get(n,n)+1),r=n+1;r<a;r++){for(o=0,e=n;e<s;e++)o+=i.get(e,n)*i.get(e,r);for(o=-o/i.get(n,n),e=n;e<s;e++)i.set(e,r,i.get(e,r)+o*i.get(e,n))}}u[n]=-t}this.QR=i,this.Rdiag=u}solve(t){t=en.checkMatrix(t);let e=this.QR,r=e.rows;if(t.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let n,o,i,s,a=t.columns,u=t.clone(),c=e.columns;for(i=0;i<c;i++)for(o=0;o<a;o++){for(s=0,n=i;n<r;n++)s+=e.get(n,i)*u.get(n,o);for(s=-s/e.get(i,i),n=i;n<r;n++)u.set(n,o,u.get(n,o)+s*e.get(n,i))}for(i=c-1;i>=0;i--){for(o=0;o<a;o++)u.set(i,o,u.get(i,o)/this.Rdiag[i]);for(n=0;n<i;n++)for(o=0;o<a;o++)u.set(n,o,u.get(n,o)-u.get(i,o)*e.get(n,i))}return u.subMatrix(0,c-1,0,a-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,r=this.QR,n=r.columns,o=new en(n,n);for(t=0;t<n;t++)for(e=0;e<n;e++)t<e?o.set(t,e,r.get(t,e)):t===e?o.set(t,e,this.Rdiag[t]):o.set(t,e,0);return o}get orthogonalMatrix(){let t,e,r,n,o=this.QR,i=o.rows,s=o.columns,a=new en(i,s);for(r=s-1;r>=0;r--){for(t=0;t<i;t++)a.set(t,r,0);for(a.set(r,r,1),e=r;e<s;e++)if(0!==o.get(r,r)){for(n=0,t=r;t<i;t++)n+=o.get(t,r)*a.get(t,e);for(n=-n/o.get(r,r),t=r;t<i;t++)a.set(t,e,a.get(t,e)+n*o.get(t,r))}}return a}}let gn=class{constructor(t,e={}){if((t=hn.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:s=!1}=e;let a,u=Boolean(o),c=Boolean(i),h=!1;if(r<n)if(s){a=t.transpose(),r=a.rows,n=a.columns,h=!0;let e=u;u=c,c=e}else a=t.clone();else a=t.clone();let d=Math.min(r,n),l=Math.min(r+1,n),f=new Float64Array(l),g=new en(r,d),p=new en(n,n),v=new Float64Array(n),y=new Float64Array(r),m=new Float64Array(l);for(let M=0;M<l;M++)m[M]=M;let w=Math.min(r-1,n),b=Math.max(0,Math.min(n-2,r)),x=Math.max(w,b);for(let M=0;M<x;M++){if(M<w){f[M]=0;for(let t=M;t<r;t++)f[M]=ln(f[M],a.get(t,M));if(0!==f[M]){a.get(M,M)<0&&(f[M]=-f[M]);for(let t=M;t<r;t++)a.set(t,M,a.get(t,M)/f[M]);a.set(M,M,a.get(M,M)+1)}f[M]=-f[M]}for(let t=M+1;t<n;t++){if(M<w&&0!==f[M]){let e=0;for(let n=M;n<r;n++)e+=a.get(n,M)*a.get(n,t);e=-e/a.get(M,M);for(let n=M;n<r;n++)a.set(n,t,a.get(n,t)+e*a.get(n,M))}v[t]=a.get(M,t)}if(u&&M<w)for(let t=M;t<r;t++)g.set(t,M,a.get(t,M));if(M<b){v[M]=0;for(let t=M+1;t<n;t++)v[M]=ln(v[M],v[t]);if(0!==v[M]){v[M+1]<0&&(v[M]=0-v[M]);for(let t=M+1;t<n;t++)v[t]/=v[M];v[M+1]+=1}if(v[M]=-v[M],M+1<r&&0!==v[M]){for(let t=M+1;t<r;t++)y[t]=0;for(let t=M+1;t<r;t++)for(let e=M+1;e<n;e++)y[t]+=v[e]*a.get(t,e);for(let t=M+1;t<n;t++){let e=-v[t]/v[M+1];for(let n=M+1;n<r;n++)a.set(n,t,a.get(n,t)+e*y[n])}}if(c)for(let t=M+1;t<n;t++)p.set(t,M,v[t])}}let E=Math.min(n,r+1);if(w<n&&(f[w]=a.get(w,w)),r<E&&(f[E-1]=0),b+1<E&&(v[b]=a.get(b,E-1)),v[E-1]=0,u){for(let t=w;t<d;t++){for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<d;e++){let n=0;for(let o=t;o<r;o++)n+=g.get(o,t)*g.get(o,e);n=-n/g.get(t,t);for(let o=t;o<r;o++)g.set(o,e,g.get(o,e)+n*g.get(o,t))}for(let e=t;e<r;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}}if(c)for(let M=n-1;M>=0;M--){if(M<b&&0!==v[M])for(let t=M+1;t<n;t++){let e=0;for(let r=M+1;r<n;r++)e+=p.get(r,M)*p.get(r,t);e=-e/p.get(M+1,M);for(let r=M+1;r<n;r++)p.set(r,t,p.get(r,t)+e*p.get(r,M))}for(let t=0;t<n;t++)p.set(t,M,0);p.set(M,M,1)}let N=E-1,_=Number.EPSILON;for(;E>0;){let t,e;for(t=E-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+_*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===E-2)e=4;else{let r;for(r=E-1;r>=t&&r!==t;r--){let e=(r!==E?Math.abs(v[r]):0)+(r!==t+1?Math.abs(v[r-1]):0);if(Math.abs(f[r])<=_*e){f[r]=0;break}}r===t?e=3:r===E-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=v[E-2];v[E-2]=0;for(let r=E-2;r>=t;r--){let o=ln(f[r],e),i=f[r]/o,s=e/o;if(f[r]=o,r!==t&&(e=-s*v[r-1],v[r-1]=i*v[r-1]),c)for(let t=0;t<n;t++)o=i*p.get(t,r)+s*p.get(t,E-1),p.set(t,E-1,-s*p.get(t,r)+i*p.get(t,E-1)),p.set(t,r,o)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let n=t;n<E;n++){let o=ln(f[n],e),i=f[n]/o,s=e/o;if(f[n]=o,e=-s*v[n],v[n]=i*v[n],u)for(let e=0;e<r;e++)o=i*g.get(e,n)+s*g.get(e,t-1),g.set(e,t-1,-s*g.get(e,n)+i*g.get(e,t-1)),g.set(e,n,o)}break}case 3:{const e=Math.max(Math.abs(f[E-1]),Math.abs(f[E-2]),Math.abs(v[E-2]),Math.abs(f[t]),Math.abs(v[t])),o=f[E-1]/e,i=f[E-2]/e,s=v[E-2]/e,a=f[t]/e,h=v[t]/e,d=((i+o)*(i-o)+s*s)/2,l=o*s*(o*s);let y=0;0===d&&0===l||(y=d<0?0-Math.sqrt(d*d+l):Math.sqrt(d*d+l),y=l/(d+y));let m=(a+o)*(a-o)+y,w=a*h;for(let b=t;b<E-1;b++){let e=ln(m,w);0===e&&(e=Number.MIN_VALUE);let o=m/e,i=w/e;if(b!==t&&(v[b-1]=e),m=o*f[b]+i*v[b],v[b]=o*v[b]-i*f[b],w=i*f[b+1],f[b+1]=o*f[b+1],c)for(let t=0;t<n;t++)e=o*p.get(t,b)+i*p.get(t,b+1),p.set(t,b+1,-i*p.get(t,b)+o*p.get(t,b+1)),p.set(t,b,e);if(e=ln(m,w),0===e&&(e=Number.MIN_VALUE),o=m/e,i=w/e,f[b]=e,m=o*v[b]+i*f[b+1],f[b+1]=-i*v[b]+o*f[b+1],w=i*v[b+1],v[b+1]=o*v[b+1],u&&b<r-1)for(let t=0;t<r;t++)e=o*g.get(t,b)+i*g.get(t,b+1),g.set(t,b+1,-i*g.get(t,b)+o*g.get(t,b+1)),g.set(t,b,e)}v[E-2]=m;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,c))for(let e=0;e<=N;e++)p.set(e,t,-p.get(e,t));for(;t<N&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,c&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(u&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);t++}E--}}if(h){let t=p;p=g,g=t}this.m=r,this.n=n,this.s=f,this.U=g,this.V=p}solve(t){let e=t,r=this.threshold,n=this.s.length,o=en.zeros(n,n);for(let d=0;d<n;d++)Math.abs(this.s[d])<=r?o.set(d,d,0):o.set(d,d,1/this.s[d]);let i=this.U,s=this.rightSingularVectors,a=s.mmul(o),u=s.rows,c=i.rows,h=en.zeros(u,c);for(let d=0;d<u;d++)for(let t=0;t<c;t++){let e=0;for(let r=0;r<n;r++)e+=a.get(d,r)*i.get(t,r);h.set(d,t,e)}return h.mmul(e)}solveForDiagonal(t){return this.solve(en.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,o=new en(r,this.s.length);for(let c=0;c<r;c++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&o.set(c,r,t.get(c,r)/this.s[r]);let i=this.U,s=i.rows,a=i.columns,u=new en(r,s);for(let c=0;c<r;c++)for(let t=0;t<s;t++){let e=0;for(let r=0;r<a;r++)e+=o.get(c,r)*i.get(t,r);u.set(c,t,e)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,o=r.length;n<o;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return en.diag(this.s)}};function pn(t,e,r=!1){return t=hn.checkMatrix(t),e=hn.checkMatrix(e),r?new gn(t).solve(e):t.isSquare()?new dn(t).solve(e):new fn(t).solve(e)}function vn(t,e){let r=[];for(let n=0;n<t;n++)n!==e&&r.push(n);return r}function yn(t,e,r,n=1e-9,o=1e-9){if(t>o)return new Array(e.rows+1).fill(0);{let t=e.addRow(r,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<n&&t.set(e,0,0);return t.to1DArray()}}class mn{constructor(t,e={}){const{assumeSymmetric:r=!1}=e;if(!(t=hn.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");if(t.isEmpty())throw new Error("Matrix must be non-empty");let n,o,i=t.columns,s=new en(i,i),a=new Float64Array(i),u=new Float64Array(i),c=t,h=!1;if(h=!!r||t.isSymmetric(),h){for(n=0;n<i;n++)for(o=0;o<i;o++)s.set(n,o,c.get(n,o));!function(t,e,r,n){let o,i,s,a,u,c,h,d;for(u=0;u<t;u++)r[u]=n.get(t-1,u);for(a=t-1;a>0;a--){for(d=0,s=0,c=0;c<a;c++)d+=Math.abs(r[c]);if(0===d)for(e[a]=r[a-1],u=0;u<a;u++)r[u]=n.get(a-1,u),n.set(a,u,0),n.set(u,a,0);else{for(c=0;c<a;c++)r[c]/=d,s+=r[c]*r[c];for(o=r[a-1],i=Math.sqrt(s),o>0&&(i=-i),e[a]=d*i,s-=o*i,r[a-1]=o-i,u=0;u<a;u++)e[u]=0;for(u=0;u<a;u++){for(o=r[u],n.set(u,a,o),i=e[u]+n.get(u,u)*o,c=u+1;c<=a-1;c++)i+=n.get(c,u)*r[c],e[c]+=n.get(c,u)*o;e[u]=i}for(o=0,u=0;u<a;u++)e[u]/=s,o+=e[u]*r[u];for(h=o/(s+s),u=0;u<a;u++)e[u]-=h*r[u];for(u=0;u<a;u++){for(o=r[u],i=e[u],c=u;c<=a-1;c++)n.set(c,u,n.get(c,u)-(o*e[c]+i*r[c]));r[u]=n.get(a-1,u),n.set(a,u,0)}}r[a]=s}for(a=0;a<t-1;a++){if(n.set(t-1,a,n.get(a,a)),n.set(a,a,1),s=r[a+1],0!==s){for(c=0;c<=a;c++)r[c]=n.get(c,a+1)/s;for(u=0;u<=a;u++){for(i=0,c=0;c<=a;c++)i+=n.get(c,a+1)*n.get(c,u);for(c=0;c<=a;c++)n.set(c,u,n.get(c,u)-i*r[c])}}for(c=0;c<=a;c++)n.set(c,a+1,0)}for(u=0;u<t;u++)r[u]=n.get(t-1,u),n.set(t-1,u,0);n.set(t-1,t-1,1),e[0]=0}(i,u,a,s),function(t,e,r,n){let o,i,s,a,u,c,h,d,l,f,g,p,v,y,m,w;for(s=1;s<t;s++)e[s-1]=e[s];e[t-1]=0;let b=0,x=0,E=Number.EPSILON;for(c=0;c<t;c++){for(x=Math.max(x,Math.abs(r[c])+Math.abs(e[c])),h=c;h<t&&!(Math.abs(e[h])<=E*x);)h++;if(h>c)do{for(o=r[c],d=(r[c+1]-o)/(2*e[c]),l=ln(d,1),d<0&&(l=-l),r[c]=e[c]/(d+l),r[c+1]=e[c]*(d+l),f=r[c+1],i=o-r[c],s=c+2;s<t;s++)r[s]-=i;for(b+=i,d=r[h],g=1,p=g,v=g,y=e[c+1],m=0,w=0,s=h-1;s>=c;s--)for(v=p,p=g,w=m,o=g*e[s],i=g*d,l=ln(d,e[s]),e[s+1]=m*l,m=e[s]/l,g=d/l,d=g*r[s]-m*o,r[s+1]=i+m*(g*o+m*r[s]),u=0;u<t;u++)i=n.get(u,s+1),n.set(u,s+1,m*n.get(u,s)+g*i),n.set(u,s,g*n.get(u,s)-m*i);d=-m*w*v*y*e[c]/f,e[c]=m*d,r[c]=g*d}while(Math.abs(e[c])>E*x);r[c]=r[c]+b,e[c]=0}for(s=0;s<t-1;s++){for(u=s,d=r[s],a=s+1;a<t;a++)r[a]<d&&(u=a,d=r[a]);if(u!==s)for(r[u]=r[s],r[s]=d,a=0;a<t;a++)d=n.get(a,s),n.set(a,s,n.get(a,u)),n.set(a,u,d)}}(i,u,a,s)}else{let t=new en(i,i),e=new Float64Array(i);for(o=0;o<i;o++)for(n=0;n<i;n++)t.set(n,o,c.get(n,o));!function(t,e,r,n){let o,i,s,a,u,c,h,d=0,l=t-1;for(c=d+1;c<=l-1;c++){for(h=0,a=c;a<=l;a++)h+=Math.abs(e.get(a,c-1));if(0!==h){for(s=0,a=l;a>=c;a--)r[a]=e.get(a,c-1)/h,s+=r[a]*r[a];for(i=Math.sqrt(s),r[c]>0&&(i=-i),s-=r[c]*i,r[c]=r[c]-i,u=c;u<t;u++){for(o=0,a=l;a>=c;a--)o+=r[a]*e.get(a,u);for(o/=s,a=c;a<=l;a++)e.set(a,u,e.get(a,u)-o*r[a])}for(a=0;a<=l;a++){for(o=0,u=l;u>=c;u--)o+=r[u]*e.get(a,u);for(o/=s,u=c;u<=l;u++)e.set(a,u,e.get(a,u)-o*r[u])}r[c]=h*r[c],e.set(c,c-1,h*i)}}for(a=0;a<t;a++)for(u=0;u<t;u++)n.set(a,u,a===u?1:0);for(c=l-1;c>=d+1;c--)if(0!==e.get(c,c-1)){for(a=c+1;a<=l;a++)r[a]=e.get(a,c-1);for(u=c;u<=l;u++){for(i=0,a=c;a<=l;a++)i+=r[a]*n.get(a,u);for(i=i/r[c]/e.get(c,c-1),a=c;a<=l;a++)n.set(a,u,n.get(a,u)+i*r[a])}}}(i,t,e,s),function(t,e,r,n,o){let i,s,a,u,c,h,d,l,f,g,p,v,y,m,w,b=t-1,x=0,E=t-1,N=Number.EPSILON,_=0,M=0,k=0,A=0,j=0,S=0,O=0,z=0;for(i=0;i<t;i++)for((i<x||i>E)&&(r[i]=o.get(i,i),e[i]=0),s=Math.max(i-1,0);s<t;s++)M+=Math.abs(o.get(i,s));for(;b>=x;){for(u=b;u>x&&(S=Math.abs(o.get(u-1,u-1))+Math.abs(o.get(u,u)),0===S&&(S=M),!(Math.abs(o.get(u,u-1))<N*S));)u--;if(u===b)o.set(b,b,o.get(b,b)+_),r[b]=o.get(b,b),e[b]=0,b--,z=0;else if(u===b-1){if(d=o.get(b,b-1)*o.get(b-1,b),k=(o.get(b-1,b-1)-o.get(b,b))/2,A=k*k+d,O=Math.sqrt(Math.abs(A)),o.set(b,b,o.get(b,b)+_),o.set(b-1,b-1,o.get(b-1,b-1)+_),l=o.get(b,b),A>=0){for(O=k>=0?k+O:k-O,r[b-1]=l+O,r[b]=r[b-1],0!==O&&(r[b]=l-d/O),e[b-1]=0,e[b]=0,l=o.get(b,b-1),S=Math.abs(l)+Math.abs(O),k=l/S,A=O/S,j=Math.sqrt(k*k+A*A),k/=j,A/=j,s=b-1;s<t;s++)O=o.get(b-1,s),o.set(b-1,s,A*O+k*o.get(b,s)),o.set(b,s,A*o.get(b,s)-k*O);for(i=0;i<=b;i++)O=o.get(i,b-1),o.set(i,b-1,A*O+k*o.get(i,b)),o.set(i,b,A*o.get(i,b)-k*O);for(i=x;i<=E;i++)O=n.get(i,b-1),n.set(i,b-1,A*O+k*n.get(i,b)),n.set(i,b,A*n.get(i,b)-k*O)}else r[b-1]=l+k,r[b]=l+k,e[b-1]=O,e[b]=-O;b-=2,z=0}else{if(l=o.get(b,b),f=0,d=0,u<b&&(f=o.get(b-1,b-1),d=o.get(b,b-1)*o.get(b-1,b)),10===z){for(_+=l,i=x;i<=b;i++)o.set(i,i,o.get(i,i)-l);S=Math.abs(o.get(b,b-1))+Math.abs(o.get(b-1,b-2)),l=f=.75*S,d=-.4375*S*S}if(30===z&&(S=(f-l)/2,S=S*S+d,S>0)){for(S=Math.sqrt(S),f<l&&(S=-S),S=l-d/((f-l)/2+S),i=x;i<=b;i++)o.set(i,i,o.get(i,i)-S);_+=S,l=f=d=.964}for(z+=1,c=b-2;c>=u&&(O=o.get(c,c),j=l-O,S=f-O,k=(j*S-d)/o.get(c+1,c)+o.get(c,c+1),A=o.get(c+1,c+1)-O-j-S,j=o.get(c+2,c+1),S=Math.abs(k)+Math.abs(A)+Math.abs(j),k/=S,A/=S,j/=S,c!==u)&&!(Math.abs(o.get(c,c-1))*(Math.abs(A)+Math.abs(j))<N*(Math.abs(k)*(Math.abs(o.get(c-1,c-1))+Math.abs(O)+Math.abs(o.get(c+1,c+1)))));)c--;for(i=c+2;i<=b;i++)o.set(i,i-2,0),i>c+2&&o.set(i,i-3,0);for(a=c;a<=b-1&&(m=a!==b-1,a!==c&&(k=o.get(a,a-1),A=o.get(a+1,a-1),j=m?o.get(a+2,a-1):0,l=Math.abs(k)+Math.abs(A)+Math.abs(j),0!==l&&(k/=l,A/=l,j/=l)),0!==l);a++)if(S=Math.sqrt(k*k+A*A+j*j),k<0&&(S=-S),0!==S){for(a!==c?o.set(a,a-1,-S*l):u!==c&&o.set(a,a-1,-o.get(a,a-1)),k+=S,l=k/S,f=A/S,O=j/S,A/=k,j/=k,s=a;s<t;s++)k=o.get(a,s)+A*o.get(a+1,s),m&&(k+=j*o.get(a+2,s),o.set(a+2,s,o.get(a+2,s)-k*O)),o.set(a,s,o.get(a,s)-k*l),o.set(a+1,s,o.get(a+1,s)-k*f);for(i=0;i<=Math.min(b,a+3);i++)k=l*o.get(i,a)+f*o.get(i,a+1),m&&(k+=O*o.get(i,a+2),o.set(i,a+2,o.get(i,a+2)-k*j)),o.set(i,a,o.get(i,a)-k),o.set(i,a+1,o.get(i,a+1)-k*A);for(i=x;i<=E;i++)k=l*n.get(i,a)+f*n.get(i,a+1),m&&(k+=O*n.get(i,a+2),n.set(i,a+2,n.get(i,a+2)-k*j)),n.set(i,a,n.get(i,a)-k),n.set(i,a+1,n.get(i,a+1)-k*A)}}}if(0===M)return;for(b=t-1;b>=0;b--)if(k=r[b],A=e[b],0===A)for(u=b,o.set(b,b,1),i=b-1;i>=0;i--){for(d=o.get(i,i)-k,j=0,s=u;s<=b;s++)j+=o.get(i,s)*o.get(s,b);if(e[i]<0)O=d,S=j;else if(u=i,0===e[i]?o.set(i,b,0!==d?-j/d:-j/(N*M)):(l=o.get(i,i+1),f=o.get(i+1,i),A=(r[i]-k)*(r[i]-k)+e[i]*e[i],h=(l*S-O*j)/A,o.set(i,b,h),o.set(i+1,b,Math.abs(l)>Math.abs(O)?(-j-d*h)/l:(-S-f*h)/O)),h=Math.abs(o.get(i,b)),N*h*h>1)for(s=i;s<=b;s++)o.set(s,b,o.get(s,b)/h)}else if(A<0)for(u=b-1,Math.abs(o.get(b,b-1))>Math.abs(o.get(b-1,b))?(o.set(b-1,b-1,A/o.get(b,b-1)),o.set(b-1,b,-(o.get(b,b)-k)/o.get(b,b-1))):(w=wn(0,-o.get(b-1,b),o.get(b-1,b-1)-k,A),o.set(b-1,b-1,w[0]),o.set(b-1,b,w[1])),o.set(b,b-1,0),o.set(b,b,1),i=b-2;i>=0;i--){for(g=0,p=0,s=u;s<=b;s++)g+=o.get(i,s)*o.get(s,b-1),p+=o.get(i,s)*o.get(s,b);if(d=o.get(i,i)-k,e[i]<0)O=d,j=g,S=p;else if(u=i,0===e[i]?(w=wn(-g,-p,d,A),o.set(i,b-1,w[0]),o.set(i,b,w[1])):(l=o.get(i,i+1),f=o.get(i+1,i),v=(r[i]-k)*(r[i]-k)+e[i]*e[i]-A*A,y=2*(r[i]-k)*A,0===v&&0===y&&(v=N*M*(Math.abs(d)+Math.abs(A)+Math.abs(l)+Math.abs(f)+Math.abs(O))),w=wn(l*j-O*g+A*p,l*S-O*p-A*g,v,y),o.set(i,b-1,w[0]),o.set(i,b,w[1]),Math.abs(l)>Math.abs(O)+Math.abs(A)?(o.set(i+1,b-1,(-g-d*o.get(i,b-1)+A*o.get(i,b))/l),o.set(i+1,b,(-p-d*o.get(i,b)-A*o.get(i,b-1))/l)):(w=wn(-j-f*o.get(i,b-1),-S-f*o.get(i,b),O,A),o.set(i+1,b-1,w[0]),o.set(i+1,b,w[1]))),h=Math.max(Math.abs(o.get(i,b-1)),Math.abs(o.get(i,b))),N*h*h>1)for(s=i;s<=b;s++)o.set(s,b-1,o.get(s,b-1)/h),o.set(s,b,o.get(s,b)/h)}for(i=0;i<t;i++)if(i<x||i>E)for(s=i;s<t;s++)n.set(i,s,o.get(i,s));for(s=t-1;s>=x;s--)for(i=x;i<=E;i++){for(O=0,a=x;a<=Math.min(s,E);a++)O+=n.get(i,a)*o.get(a,s);n.set(i,s,O)}}(i,u,a,s,t)}this.n=i,this.e=u,this.d=a,this.V=s}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,r=this.n,n=this.e,o=this.d,i=new en(r,r);for(t=0;t<r;t++){for(e=0;e<r;e++)i.set(t,e,0);i.set(t,t,o[t]),n[t]>0?i.set(t,t+1,n[t]):n[t]<0&&i.set(t,t-1,n[t])}return i}}function wn(t,e,r,n){let o,i;return Math.abs(r)>Math.abs(n)?(o=n/r,i=r+o*n,[(t+o*e)/i,(e-o*t)/i]):(o=r/n,i=n+o*r,[(o*t+e)/i,(o*e-t)/i])}class bn{constructor(t){if(!(t=hn.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");let e,r,n,o=t,i=o.rows,s=new en(i,i),a=!0;for(r=0;r<i;r++){let t=0;for(n=0;n<r;n++){let i=0;for(e=0;e<n;e++)i+=s.get(n,e)*s.get(r,e);i=(o.get(r,n)-i)/s.get(n,n),s.set(r,n,i),t+=i*i}for(t=o.get(r,r)-t,a&&(a=t>0),s.set(r,r,Math.sqrt(Math.max(t,0))),n=r+1;n<i;n++)s.set(r,n,0)}this.L=s,this.positiveDefinite=a}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=hn.checkMatrix(t);let e=this.L,r=e.rows;if(t.rows!==r)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");let n,o,i,s=t.columns,a=t.clone();for(i=0;i<r;i++)for(o=0;o<s;o++){for(n=0;n<i;n++)a.set(i,o,a.get(i,o)-a.get(n,o)*e.get(i,n));a.set(i,o,a.get(i,o)/e.get(i,i))}for(i=r-1;i>=0;i--)for(o=0;o<s;o++){for(n=i+1;n<r;n++)a.set(i,o,a.get(i,o)-a.get(n,o)*e.get(n,i));a.set(i,o,a.get(i,o)/e.get(i,i))}return a}get lowerTriangularMatrix(){return this.L}}class xn{constructor(t,e={}){t=hn.checkMatrix(t);let{Y:r}=e;const{scaleScores:n=!1,maxIterations:o=1e3,terminationCriteria:i=1e-10}=e;let s;if(r){if(r=Dr.isAnyArray(r)&&"number"==typeof r[0]?en.columnVector(r):hn.checkMatrix(r),r.rows!==t.rows)throw new Error("Y should have the same number of rows as X");s=r.getColumnVector(0)}else s=t.getColumnVector(0);let a,u,c,h,d=1;for(let l=0;l<o&&d>i;l++)c=t.transpose().mmul(s).div(s.transpose().mmul(s).get(0,0)),c=c.div(c.norm()),a=t.mmul(c).div(c.transpose().mmul(c).get(0,0)),l>0&&(d=a.clone().sub(h).pow(2).sum()),h=a.clone(),r?(u=r.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0)),u=u.div(u.norm()),s=r.mmul(u).div(u.transpose().mmul(u).get(0,0))):s=a;if(r){let e=t.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0));e=e.div(e.norm());let n=t.clone().sub(a.clone().mmul(e.transpose())),o=s.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0)),i=r.clone().sub(a.clone().mulS(o.get(0,0)).mmul(u.transpose()));this.t=a,this.p=e.transpose(),this.w=c.transpose(),this.q=u,this.u=s,this.s=a.transpose().mmul(a),this.xResidual=n,this.yResidual=i,this.betas=o}else this.w=c.transpose(),this.s=a.transpose().mmul(a).sqrt(),this.t=n?a.clone().div(this.s.get(0,0)):a,this.xResidual=t.sub(a.mmul(c.transpose()))}}Or.AbstractMatrix=Zr,Or.CHO=bn,Or.CholeskyDecomposition=bn,Or.DistanceMatrix=sn,Or.EVD=mn,Or.EigenvalueDecomposition=mn,Or.LU=dn,Or.LuDecomposition=dn;var En=Or.Matrix=en;Or.MatrixColumnSelectionView=class extends an{constructor(t,e){Hr(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,r){return this.matrix.set(t,this.columnIndices[e],r),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}},Or.MatrixColumnView=class extends an{constructor(t,e){Ur(t,e),super(t,t.rows,1),this.column=e}set(t,e,r){return this.matrix.set(t,this.column,r),this}get(t){return this.matrix.get(t,this.column)}},Or.MatrixFlipColumnView=class extends an{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(t,this.columns-e-1,r),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}},Or.MatrixFlipRowView=class extends an{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(this.rows-t-1,e,r),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}},Or.MatrixRowSelectionView=class extends an{constructor(t,e){Yr(t,e),super(t,e.length,t.columns),this.rowIndices=e}set(t,e,r){return this.matrix.set(this.rowIndices[t],e,r),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}},Or.MatrixRowView=class extends an{constructor(t,e){Br(t,e),super(t,1,t.columns),this.row=e}set(t,e,r){return this.matrix.set(this.row,e,r),this}get(t,e){return this.matrix.get(this.row,e)}},Or.MatrixSelectionView=un,Or.MatrixSubView=class extends an{constructor(t,e,r,n,o){Kr(t,e,r,n,o),super(t,r-e+1,o-n+1),this.startRow=e,this.startColumn=n}set(t,e,r){return this.matrix.set(this.startRow+t,this.startColumn+e,r),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}},Or.MatrixTransposeView=class extends an{constructor(t){super(t,t.columns,t.rows)}set(t,e,r){return this.matrix.set(e,t,r),this}get(t,e){return this.matrix.get(e,t)}},Or.NIPALS=xn,Or.Nipals=xn,Or.QR=fn,Or.QrDecomposition=fn,Or.SVD=gn;var Nn=Or.SingularValueDecomposition=gn;Or.SymmetricMatrix=on,Or.WrapperMatrix1D=cn,Or.WrapperMatrix2D=hn,Or.correlation=function(t,e=t,r={}){t=new en(t);let n=!1;if("object"!=typeof e||en.isMatrix(e)||Dr.isAnyArray(e)?e=new en(e):(r=e,e=t,n=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:o=!0,scale:i=!0}=r;o&&(t.center("column"),n||e.center("column")),i&&(t.scale("column"),n||e.scale("column"));const s=t.standardDeviation("column",{unbiased:!0}),a=n?s:e.standardDeviation("column",{unbiased:!0}),u=t.transpose().mmul(e);for(let c=0;c<u.rows;c++)for(let e=0;e<u.columns;e++)u.set(c,e,u.get(c,e)*(1/(s[c]*a[e]))*(1/(t.rows-1)));return u},Or.covariance=function(t,e=t,r={}){t=new en(t);let n=!1;if("object"!=typeof e||en.isMatrix(e)||Dr.isAnyArray(e)?e=new en(e):(r=e,e=t,n=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:o=!0}=r;o&&(t=t.center("column"),n||(e=e.center("column")));const i=t.transpose().mmul(e);for(let s=0;s<i.rows;s++)for(let e=0;e<i.columns;e++)i.set(s,e,i.get(s,e)*(1/(t.rows-1)));return i};var _n=Or.default=en;Or.determinant=function t(e){if((e=en.checkMatrix(e)).isSquare()){if(0===e.columns)return 1;let r,n,o,i;if(2===e.columns)return r=e.get(0,0),n=e.get(0,1),o=e.get(1,0),i=e.get(1,1),r*i-n*o;if(3===e.columns){let i,s,a;return i=new un(e,[1,2],[1,2]),s=new un(e,[1,2],[0,2]),a=new un(e,[1,2],[0,1]),r=e.get(0,0),n=e.get(0,1),o=e.get(0,2),r*t(i)-n*t(s)+o*t(a)}return new dn(e).determinant}throw Error("determinant can only be calculated for a square matrix")},Or.inverse=function(t,e=!1){return t=hn.checkMatrix(t),e?new gn(t).inverse():pn(t,en.eye(t.rows))},Or.linearDependencies=function(t,e={}){const{thresholdValue:r=1e-9,thresholdError:n=1e-9}=e;let o=(t=en.checkMatrix(t)).rows,i=new en(o,o);for(let s=0;s<o;s++){let e=en.columnVector(t.getRow(s)),a=t.subMatrixRow(vn(o,s)).transpose(),u=new gn(a).solve(e),c=en.sub(e,a.mmul(u)).abs().max();i.setRow(s,yn(c,u,s,r,n))}return i},Or.pseudoInverse=function(t,e=Number.EPSILON){if((t=en.checkMatrix(t)).isEmpty())return t.transpose();let r=new gn(t,{autoTranspose:!0}),n=r.leftSingularVectors,o=r.rightSingularVectors,i=r.diagonal;for(let s=0;s<i.length;s++)Math.abs(i[s])>e?i[s]=1/i[s]:i[s]=0;return o.mmul(en.diag(i).mmul(n.transpose()))},Or.solve=pn,Or.wrap=function(t,e){if(Dr.isAnyArray(t))return t[0]&&Dr.isAnyArray(t[0])?new hn(t):new cn(t,e);throw new Error("the argument is not an array")};const Mn=En,kn=Nn;_n.Matrix&&_n.Matrix;const An={center:[0,0],linkDistance:50};class jn{constructor(t={}){this.options=t,this.id="mds",this.options=Object.assign(Object.assign({},An),t)}execute(t,e){return o(this,void 0,void 0,(function*(){return this.genericMDSLayout(!1,t,e)}))}assign(t,e){return o(this,void 0,void 0,(function*(){yield this.genericMDSLayout(!0,t,e)}))}genericMDSLayout(t,e,r){return o(this,void 0,void 0,(function*(){const n=Object.assign(Object.assign({},this.options),r),{center:o=[0,0],linkDistance:i=50}=n,s=e.getAllNodes(),a=e.getAllEdges();if(!(null==s?void 0:s.length)||1===s.length)return Ye(e,t,o);const u=De({nodes:s,edges:a}),c=Pe(u);Sn(c);const h=((t,e)=>{const r=[];return t.forEach((t=>{const n=[];t.forEach((t=>{n.push(t*e)})),r.push(n)})),r})(c,i),d=On(h),l=[];d.forEach(((t,e)=>{const r=qe(s[e]);r.data.x=t[0]+o[0],r.data.y=t[1]+o[1],l.push(r)})),t&&l.forEach((t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})));return{nodes:l,edges:a}}))}}const Sn=t=>{let e=-999999;t.forEach((t=>{t.forEach((t=>{t!==1/0&&e<t&&(e=t)}))})),t.forEach(((r,n)=>{r.forEach(((r,o)=>{r===1/0&&(t[n][o]=e)}))}))},On=t=>{const e=Mn.mul(Mn.pow(t,2),-.5),r=e.mean("row"),n=e.mean("column"),o=e.mean();e.add(o).subRowVector(r).subColumnVector(n);const i=new kn(e),s=Mn.sqrt(i.diagonalMatrix).diagonal();return i.leftSingularVectors.toJSON().map((t=>Mn.mul([t],[s]).toJSON()[0].splice(0,2)))};function zn(t){return!!t.tick&&!!t.stop}const Rn={gForce:!0,force2:!0,d3force:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0},In={center:[0,0],comboPadding:10,treeKey:"combo"};function Cn(t,e,r,n){var i;return o(this,void 0,void 0,(function*(){return zn(t)?(t.execute(e,r),t.stop(),t.tick(null!==(i=r.iterations)&&void 0!==i?i:300)):n?yield t.assign(e,r):yield t.execute(e,r)}))}function Pn(t,e){var r,n=1;function o(){var o,i,s=r.length,a=0,u=0;for(o=0;o<s;++o)a+=(i=r[o]).x,u+=i.y;for(a=(a/s-t)*n,u=(u/s-e)*n,o=0;o<s;++o)(i=r[o]).x-=a,i.y-=u}return null==t&&(t=0),null==e&&(e=0),o.initialize=function(t){r=t},o.x=function(e){return arguments.length?(t=+e,o):t},o.y=function(t){return arguments.length?(e=+t,o):e},o.strength=function(t){return arguments.length?(n=+t,o):n},o}function Dn(t){return function(){return t}}function Tn(t){return 1e-6*(t()-.5)}function Fn(t){return t.x+t.vx}function Ln(t){return t.y+t.vy}function qn(t){var e,r,n,o=1,i=1;function s(){for(var t,s,u,c,h,d,l,f=e.length,g=0;g<i;++g)for(s=nr(e,Fn,Ln).visitAfter(a),t=0;t<f;++t)u=e[t],d=r[u.index],l=d*d,c=u.x+u.vx,h=u.y+u.vy,s.visit(p);function p(t,e,r,i,s){var a=t.data,f=t.r,g=d+f;if(!a)return e>c+g||i<c-g||r>h+g||s<h-g;if(a.index>u.index){var p=c-a.x-a.vx,v=h-a.y-a.vy,y=p*p+v*v;y<g*g&&(0===p&&(y+=(p=Tn(n))*p),0===v&&(y+=(v=Tn(n))*v),y=(g-(y=Math.sqrt(y)))/y*o,u.vx+=(p*=y)*(g=(f*=f)/(l+f)),u.vy+=(v*=y)*g,a.vx-=p*(g=1-g),a.vy-=v*g)}}}function a(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var n,o,i=e.length;for(r=new Array(i),n=0;n<i;++n)o=e[n],r[o.index]=+t(o,n,e)}}return"function"!=typeof t&&(t=Dn(null==t?1:+t)),s.initialize=function(t,r){e=t,n=r,u()},s.iterations=function(t){return arguments.length?(i=+t,s):i},s.strength=function(t){return arguments.length?(o=+t,s):o},s.radius=function(e){return arguments.length?(t="function"==typeof e?e:Dn(+e),u(),s):t},s}function Vn(t){return t.index}function Gn(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function Bn(t){var e,r,n,o,i,s,a=Vn,u=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},c=Dn(30),h=1;function d(n){for(var o=0,a=t.length;o<h;++o)for(var u,c,d,l,f,g,p,v=0;v<a;++v)c=(u=t[v]).source,l=(d=u.target).x+d.vx-c.x-c.vx||Tn(s),f=d.y+d.vy-c.y-c.vy||Tn(s),l*=g=((g=Math.sqrt(l*l+f*f))-r[v])/g*n*e[v],f*=g,d.vx-=l*(p=i[v]),d.vy-=f*p,c.vx+=l*(p=1-p),c.vy+=f*p}function l(){if(n){var s,u,c=n.length,h=t.length,d=new Map(n.map(((t,e)=>[a(t,e,n),t])));for(s=0,o=new Array(c);s<h;++s)(u=t[s]).index=s,"object"!=typeof u.source&&(u.source=Gn(d,u.source)),"object"!=typeof u.target&&(u.target=Gn(d,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(s=0,i=new Array(h);s<h;++s)u=t[s],i[s]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);e=new Array(h),f(),r=new Array(h),g()}}function f(){if(n)for(var r=0,o=t.length;r<o;++r)e[r]=+u(t[r],r,t)}function g(){if(n)for(var e=0,o=t.length;e<o;++e)r[e]=+c(t[e],e,t)}return null==t&&(t=[]),d.initialize=function(t,e){n=t,s=e,l()},d.links=function(e){return arguments.length?(t=e,l(),d):t},d.id=function(t){return arguments.length?(a=t,d):a},d.iterations=function(t){return arguments.length?(h=+t,d):h},d.strength=function(t){return arguments.length?(u="function"==typeof t?t:Dn(+t),f(),d):u},d.distance=function(t){return arguments.length?(c="function"==typeof t?t:Dn(+t),g(),d):c},d}var Un={value:()=>{}};function $n(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new Wn(n)}function Wn(t){this._=t}function Yn(t,e){for(var r,n=0,o=t.length;n<o;++n)if((r=t[n]).name===e)return r.value}function Hn(t,e,r){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=Un,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}Wn.prototype=$n.prototype={constructor:Wn,on:function(t,e){var r,n,o=this._,i=(n=o,(t+"").trim().split(/^|\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),s=-1,a=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++s<a;)if(r=(t=i[s]).type)o[r]=Hn(o[r],t.name,e);else if(null==e)for(r in o)o[r]=Hn(o[r],t.name,null);return this}for(;++s<a;)if((r=(t=i[s]).type)&&(r=Yn(o[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new Wn(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,o=new Array(r),i=0;i<r;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,r=(n=this._[t]).length;i<r;++i)n[i].value.apply(e,o)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,i=n.length;o<i;++o)n[o].value.apply(e,r)}};var Kn,Jn,Qn=0,Xn=0,Zn=0,to=0,eo=0,ro=0,no="object"==typeof performance&&performance.now?performance:Date,oo="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function io(){return eo||(oo(so),eo=no.now()+ro)}function so(){eo=0}function ao(){this._call=this._time=this._next=null}function uo(t,e,r){var n=new ao;return n.restart(t,e,r),n}function co(){eo=(to=no.now())+ro,Qn=Xn=0;try{!function(){io(),++Qn;for(var t,e=Kn;e;)(t=eo-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Qn}()}finally{Qn=0,function(){var t,e,r=Kn,n=1/0;for(;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:Kn=e);Jn=t,lo(n)}(),eo=0}}function ho(){var t=no.now(),e=t-to;e>1e3&&(ro-=e,to=t)}function lo(t){Qn||(Xn&&(Xn=clearTimeout(Xn)),t-eo>24?(t<1/0&&(Xn=setTimeout(co,t-no.now()-ro)),Zn&&(Zn=clearInterval(Zn))):(Zn||(to=no.now(),Zn=setInterval(ho,1e3)),Qn=1,oo(co)))}ao.prototype=uo.prototype={constructor:ao,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?io():+r)+(null==e?0:+e),this._next||Jn===this||(Jn?Jn._next=this:Kn=this,Jn=this),this._call=t,this._time=r,lo()},stop:function(){this._call&&(this._call=null,this._time=1/0,lo())}};const fo=4294967296;function go(t){return t.x}function po(t){return t.y}var vo=Math.PI*(3-Math.sqrt(5));function yo(t){var e,r=1,n=.001,o=1-Math.pow(n,1/300),i=0,s=.6,a=new Map,u=uo(d),c=$n("tick","end"),h=function(){let t=1;return()=>(t=(1664525*t+1013904223)%fo)/fo}();function d(){l(),c.call("tick",e),r<n&&(u.stop(),c.call("end",e))}function l(n){var u,c,h=t.length;void 0===n&&(n=1);for(var d=0;d<n;++d)for(r+=(i-r)*o,a.forEach((function(t){t(r)})),u=0;u<h;++u)null==(c=t[u]).fx?c.x+=c.vx*=s:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=s:(c.y=c.fy,c.vy=0);return e}function f(){for(var e,r=0,n=t.length;r<n;++r){if((e=t[r]).index=r,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var o=10*Math.sqrt(.5+r),i=r*vo;e.x=o*Math.cos(i),e.y=o*Math.sin(i)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function g(e){return e.initialize&&e.initialize(t,h),e}return null==t&&(t=[]),f(),e={tick:l,restart:function(){return u.restart(d),e},stop:function(){return u.stop(),e},nodes:function(r){return arguments.length?(t=r,f(),a.forEach(g),e):t},alpha:function(t){return arguments.length?(r=+t,e):r},alphaMin:function(t){return arguments.length?(n=+t,e):n},alphaDecay:function(t){return arguments.length?(o=+t,e):+o},alphaTarget:function(t){return arguments.length?(i=+t,e):i},velocityDecay:function(t){return arguments.length?(s=1-t,e):1-s},randomSource:function(t){return arguments.length?(h=t,a.forEach(g),e):h},force:function(t,r){return arguments.length>1?(null==r?a.delete(t):a.set(t,g(r)),e):a.get(t)},find:function(e,r,n){var o,i,s,a,u,c=0,h=t.length;for(null==n?n=1/0:n*=n,c=0;c<h;++c)(s=(o=e-(a=t[c]).x)*o+(i=r-a.y)*i)<n&&(u=a,n=s);return u},on:function(t,r){return arguments.length>1?(c.on(t,r),e):c.on(t)}}}function mo(){var t,e,r,n,o,i=Dn(-30),s=1,a=1/0,u=.81;function c(r){var o,i=t.length,s=nr(t,go,po).visitAfter(d);for(n=r,o=0;o<i;++o)e=t[o],s.visit(l)}function h(){if(t){var e,r,n=t.length;for(o=new Array(n),e=0;e<n;++e)r=t[e],o[r.index]=+i(r,e,t)}}function d(t){var e,r,n,i,s,a=0,u=0;if(t.length){for(n=i=s=0;s<4;++s)(e=t[s])&&(r=Math.abs(e.value))&&(a+=e.value,u+=r,n+=r*e.x,i+=r*e.y);t.x=n/u,t.y=i/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{a+=o[e.data.index]}while(e=e.next)}t.value=a}function l(t,i,c,h){if(!t.value)return!0;var d=t.x-e.x,l=t.y-e.y,f=h-i,g=d*d+l*l;if(f*f/u<g)return g<a&&(0===d&&(g+=(d=Tn(r))*d),0===l&&(g+=(l=Tn(r))*l),g<s&&(g=Math.sqrt(s*g)),e.vx+=d*t.value*n/g,e.vy+=l*t.value*n/g),!0;if(!(t.length||g>=a)){(t.data!==e||t.next)&&(0===d&&(g+=(d=Tn(r))*d),0===l&&(g+=(l=Tn(r))*l),g<s&&(g=Math.sqrt(s*g)));do{t.data!==e&&(f=o[t.data.index]*n/g,e.vx+=d*f,e.vy+=l*f)}while(t=t.next)}}return c.initialize=function(e,n){t=e,r=n,h()},c.strength=function(t){return arguments.length?(i="function"==typeof t?t:Dn(+t),h(),c):i},c.distanceMin=function(t){return arguments.length?(s=t*t,c):Math.sqrt(s)},c.distanceMax=function(t){return arguments.length?(a=t*t,c):Math.sqrt(a)},c.theta=function(t){return arguments.length?(u=t*t,c):Math.sqrt(u)},c}function wo(t,e,r){var n,o,i,s=Dn(.1);function a(t){for(var s=0,a=n.length;s<a;++s){var u=n[s],c=u.x-e||1e-6,h=u.y-r||1e-6,d=Math.sqrt(c*c+h*h),l=(i[s]-d)*o[s]*t/d;u.vx+=c*l,u.vy+=h*l}}function u(){if(n){var e,r=n.length;for(o=new Array(r),i=new Array(r),e=0;e<r;++e)i[e]=+t(n[e],e,n),o[e]=isNaN(i[e])?0:+s(n[e],e,n)}}return"function"!=typeof t&&(t=Dn(+t)),null==e&&(e=0),null==r&&(r=0),a.initialize=function(t){n=t,u()},a.strength=function(t){return arguments.length?(s="function"==typeof t?t:Dn(+t),u(),a):s},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:Dn(+e),u(),a):t},a.x=function(t){return arguments.length?(e=+t,a):e},a.y=function(t){return arguments.length?(r=+t,a):r},a}function bo(t){var e,r,n,o=Dn(.1);function i(t){for(var o,i=0,s=e.length;i<s;++i)(o=e[i]).vx+=(n[i]-o.x)*r[i]*t}function s(){if(e){var i,s=e.length;for(r=new Array(s),n=new Array(s),i=0;i<s;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=Dn(null==t?0:+t)),i.initialize=function(t){e=t,s()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:Dn(+t),s(),i):o},i.x=function(e){return arguments.length?(t="function"==typeof e?e:Dn(+e),s(),i):t},i}function xo(t){var e,r,n,o=Dn(.1);function i(t){for(var o,i=0,s=e.length;i<s;++i)(o=e[i]).vy+=(n[i]-o.y)*r[i]*t}function s(){if(e){var i,s=e.length;for(r=new Array(s),n=new Array(s),i=0;i<s;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=Dn(null==t?0:+t)),i.initialize=function(t){e=t,s()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:Dn(+t),s(),i):o},i.y=function(e){return arguments.length?(t="function"==typeof e?e:Dn(+e),s(),i):t},i}class Eo{constructor(t){this.id="d3-force",this.config={inputNodeAttrs:["x","y","vx","vy","fx","fy"],outputNodeAttrs:["x","y","vx","vy"],simulationAttrs:["alpha","alphaMin","alphaDecay","alphaTarget","velocityDecay","randomSource"]},this.forceMap={link:Bn,manyBody:mo,center:Pn,collide:qn,radial:wo,x:bo,y:xo},this.options={link:{id:t=>t.id},manyBody:{},center:{x:0,y:0}},this.context={options:{},assign:!1,nodes:[],edges:[]},q(this.options,t),this.options.forceSimulation&&(this.simulation=this.options.forceSimulation)}execute(t,e){return o(this,void 0,void 0,(function*(){return this.genericLayout(!1,t,e)}))}assign(t,e){return o(this,void 0,void 0,(function*(){yield this.genericLayout(!0,t,e)}))}stop(){this.simulation.stop()}tick(t){return this.simulation.tick(t),this.getResult()}restart(){this.simulation.restart()}setFixedPosition(t,e){const r=this.context.nodes.find((e=>e.id===t));r&&e.forEach(((t,e)=>{if("number"==typeof t||null===t){r[["fx","fy","fz"][e]]=t}}))}getOptions(t){var e,r;const n=q({},this.options,t);return n.collide&&void 0===(null===(e=n.collide)||void 0===e?void 0:e.radius)&&(n.collide=n.collide||{},n.collide.radius=null!==(r=n.nodeSize)&&void 0!==r?r:10),void 0===n.iterations&&(n.link&&void 0===n.link.iterations&&(n.iterations=n.link.iterations),n.collide&&void 0===n.collide.iterations&&(n.iterations=n.collide.iterations)),this.context.options=n,n}genericLayout(t,e,r){var n;return o(this,void 0,void 0,(function*(){const o=this.getOptions(r),i=e.getAllNodes().map((({id:t,data:e})=>Object.assign(Object.assign({id:t},e),G(e.data,this.config.inputNodeAttrs)))),s=e.getAllEdges().map((t=>Object.assign({},t)));Object.assign(this.context,{assign:t,nodes:i,edges:s,graph:e});const a=new Promise((t=>{this.resolver=t})),u=this.setSimulation(o);return u.nodes(i),null===(n=u.force("link"))||void 0===n||n.links(s),a}))}getResult(){const{assign:t,nodes:e,edges:r,graph:n}=this.context,o=e.map((t=>({id:t.id,data:Object.assign(Object.assign({},t.data),G(t,this.config.outputNodeAttrs))}))),i=r.map((({id:t,source:e,target:r,data:n})=>({id:t,source:"object"==typeof e?e.id:e,target:"object"==typeof r?r.id:r,data:n})));return t&&o.forEach((t=>n.mergeNodeData(t.id,t.data))),{nodes:o,edges:i}}initSimulation(){return yo()}setSimulation(t){const e=this.simulation||this.options.forceSimulation||this.initSimulation();return this.simulation||(this.simulation=e.on("tick",(()=>{var e;return null===(e=t.onTick)||void 0===e?void 0:e.call(t,this.getResult())})).on("end",(()=>{var t;return null===(t=this.resolver)||void 0===t?void 0:t.call(this,this.getResult())}))),No(e,this.config.simulationAttrs.map((e=>[e,t[e]]))),Object.entries(this.forceMap).forEach((([r,n])=>{const o=r;if(t[r]){let r=e.force(o);r||(r=n(),e.force(o,r)),No(r,Object.entries(t[o]))}else e.force(o,null)})),e}}const No=(t,e)=>e.reduce(((e,[r,n])=>e[r]&&void 0!==n?e[r].call(t,n):e),t);function _o(t,e,r){var n,o=1;function i(){var i,s,a=n.length,u=0,c=0,h=0;for(i=0;i<a;++i)u+=(s=n[i]).x||0,c+=s.y||0,h+=s.z||0;for(u=(u/a-t)*o,c=(c/a-e)*o,h=(h/a-r)*o,i=0;i<a;++i)s=n[i],u&&(s.x-=u),c&&(s.y-=c),h&&(s.z-=h)}return null==t&&(t=0),null==e&&(e=0),null==r&&(r=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i.z=function(t){return arguments.length?(r=+t,i):r},i.strength=function(t){return arguments.length?(o=+t,i):o},i}function Mo(t,e,r){if(isNaN(e))return t;var n,o,i,s,a,u,c=t._root,h={data:r},d=t._x0,l=t._x1;if(!c)return t._root=h,t;for(;c.length;)if((s=e>=(o=(d+l)/2))?d=o:l=o,n=c,!(c=c[a=+s]))return n[a]=h,t;if(e===(i=+t._x.call(null,c.data)))return h.next=c,n?n[a]=h:t._root=h,t;do{n=n?n[a]=new Array(2):t._root=new Array(2),(s=e>=(o=(d+l)/2))?d=o:l=o}while((a=+s)===(u=+(i>=o)));return n[u]=c,n[a]=h,t}function ko(t,e,r){this.node=t,this.x0=e,this.x1=r}function Ao(t){return t[0]}function jo(t,e){var r=new So(null==e?Ao:e,NaN,NaN);return null==t?r:r.addAll(t)}function So(t,e,r){this._x=t,this._x0=e,this._x1=r,this._root=void 0}function Oo(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var zo=jo.prototype=So.prototype;function Ro(t){return function(){return t}}function Io(t){return 1e-6*(t()-.5)}function Co(t){return t.x+t.vx}function Po(t){return t.y+t.vy}function Do(t){return t.z+t.vz}function To(t){var e,r,n,o,i=1,s=1;function a(){for(var t,a,c,h,d,l,f,g,p=e.length,v=0;v<s;++v)for(a=(1===r?jo(e,Co):2===r?nr(e,Co,Po):3===r?fr(e,Co,Po,Do):null).visitAfter(u),t=0;t<p;++t)c=e[t],f=n[c.index],g=f*f,h=c.x+c.vx,r>1&&(d=c.y+c.vy),r>2&&(l=c.z+c.vz),a.visit(y);function y(t,e,n,s,a,u,p){var v=[e,n,s,a,u,p],y=v[0],m=v[1],w=v[2],b=v[r],x=v[r+1],E=v[r+2],N=t.data,_=t.r,M=f+_;if(!N)return y>h+M||b<h-M||r>1&&(m>d+M||x<d-M)||r>2&&(w>l+M||E<l-M);if(N.index>c.index){var k=h-N.x-N.vx,A=r>1?d-N.y-N.vy:0,j=r>2?l-N.z-N.vz:0,S=k*k+A*A+j*j;S<M*M&&(0===k&&(S+=(k=Io(o))*k),r>1&&0===A&&(S+=(A=Io(o))*A),r>2&&0===j&&(S+=(j=Io(o))*j),S=(M-(S=Math.sqrt(S)))/S*i,c.vx+=(k*=S)*(M=(_*=_)/(g+_)),r>1&&(c.vy+=(A*=S)*M),r>2&&(c.vz+=(j*=S)*M),N.vx-=k*(M=1-M),r>1&&(N.vy-=A*M),r>2&&(N.vz-=j*M))}}}function u(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<Math.pow(2,r);++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function c(){if(e){var r,o,i=e.length;for(n=new Array(i),r=0;r<i;++r)o=e[r],n[o.index]=+t(o,r,e)}}return"function"!=typeof t&&(t=Ro(null==t?1:+t)),a.initialize=function(t,...n){e=t,o=n.find((t=>"function"==typeof t))||Math.random,r=n.find((t=>[1,2,3].includes(t)))||2,c()},a.iterations=function(t){return arguments.length?(s=+t,a):s},a.strength=function(t){return arguments.length?(i=+t,a):i},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:Ro(+e),c(),a):t},a}function Fo(t){return t.index}function Lo(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function qo(t){var e,r,n,o,i,s,a,u=Fo,c=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},h=Ro(30),d=1;function l(n){for(var i=0,u=t.length;i<d;++i)for(var c,h,l,f,g,p=0,v=0,y=0,m=0;p<u;++p)h=(c=t[p]).source,v=(l=c.target).x+l.vx-h.x-h.vx||Io(a),o>1&&(y=l.y+l.vy-h.y-h.vy||Io(a)),o>2&&(m=l.z+l.vz-h.z-h.vz||Io(a)),v*=f=((f=Math.sqrt(v*v+y*y+m*m))-r[p])/f*n*e[p],y*=f,m*=f,l.vx-=v*(g=s[p]),o>1&&(l.vy-=y*g),o>2&&(l.vz-=m*g),h.vx+=v*(g=1-g),o>1&&(h.vy+=y*g),o>2&&(h.vz+=m*g)}function f(){if(n){var o,a,c=n.length,h=t.length,d=new Map(n.map(((t,e)=>[u(t,e,n),t])));for(o=0,i=new Array(c);o<h;++o)(a=t[o]).index=o,"object"!=typeof a.source&&(a.source=Lo(d,a.source)),"object"!=typeof a.target&&(a.target=Lo(d,a.target)),i[a.source.index]=(i[a.source.index]||0)+1,i[a.target.index]=(i[a.target.index]||0)+1;for(o=0,s=new Array(h);o<h;++o)a=t[o],s[o]=i[a.source.index]/(i[a.source.index]+i[a.target.index]);e=new Array(h),g(),r=new Array(h),p()}}function g(){if(n)for(var r=0,o=t.length;r<o;++r)e[r]=+c(t[r],r,t)}function p(){if(n)for(var e=0,o=t.length;e<o;++e)r[e]=+h(t[e],e,t)}return null==t&&(t=[]),l.initialize=function(t,...e){n=t,a=e.find((t=>"function"==typeof t))||Math.random,o=e.find((t=>[1,2,3].includes(t)))||2,f()},l.links=function(e){return arguments.length?(t=e,f(),l):t},l.id=function(t){return arguments.length?(u=t,l):u},l.iterations=function(t){return arguments.length?(d=+t,l):d},l.strength=function(t){return arguments.length?(c="function"==typeof t?t:Ro(+t),g(),l):c},l.distance=function(t){return arguments.length?(h="function"==typeof t?t:Ro(+t),p(),l):h},l}zo.copy=function(){var t,e,r=new So(this._x,this._x0,this._x1),n=this._root;if(!n)return r;if(!n.length)return r._root=Oo(n),r;for(t=[{source:n,target:r._root=new Array(2)}];n=t.pop();)for(var o=0;o<2;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(2)}):n.target[o]=Oo(e));return r},zo.add=function(t){const e=+this._x.call(null,t);return Mo(this.cover(e),e,t)},zo.addAll=function(t){Array.isArray(t)||(t=Array.from(t));const e=t.length,r=new Float64Array(e);let n=1/0,o=-1/0;for(let i,s=0;s<e;++s)isNaN(i=+this._x.call(null,t[s]))||(r[s]=i,i<n&&(n=i),i>o&&(o=i));if(n>o)return this;this.cover(n).cover(o);for(let i=0;i<e;++i)Mo(this,r[i],t[i]);return this},zo.cover=function(t){if(isNaN(t=+t))return this;var e=this._x0,r=this._x1;if(isNaN(e))r=(e=Math.floor(t))+1;else{for(var n,o,i=r-e||1,s=this._root;e>t||t>=r;)switch(o=+(t<e),(n=new Array(2))[o]=s,s=n,i*=2,o){case 0:r=e+i;break;case 1:e=r-i}this._root&&this._root.length&&(this._root=s)}return this._x0=e,this._x1=r,this},zo.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},zo.extent=function(t){return arguments.length?this.cover(+t[0][0]).cover(+t[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]},zo.find=function(t,e){var r,n,o,i,s,a=this._x0,u=this._x1,c=[],h=this._root;for(h&&c.push(new ko(h,a,u)),null==e?e=1/0:(a=t-e,u=t+e);i=c.pop();)if(!(!(h=i.node)||(n=i.x0)>u||(o=i.x1)<a))if(h.length){var d=(n+o)/2;c.push(new ko(h[1],d,o),new ko(h[0],n,d)),(s=+(t>=d))&&(i=c[c.length-1],c[c.length-1]=c[c.length-1-s],c[c.length-1-s]=i)}else{var l=Math.abs(t-+this._x.call(null,h.data));l<e&&(e=l,a=t-l,u=t+l,r=h.data)}return r},zo.remove=function(t){if(isNaN(i=+this._x.call(null,t)))return this;var e,r,n,o,i,s,a,u,c,h=this._root,d=this._x0,l=this._x1;if(!h)return this;if(h.length)for(;;){if((a=i>=(s=(d+l)/2))?d=s:l=s,e=h,!(h=h[u=+a]))return this;if(!h.length)break;e[u+1&1]&&(r=e,c=u)}for(;h.data!==t;)if(n=h,!(h=h.next))return this;return(o=h.next)&&delete h.next,n?(o?n.next=o:delete n.next,this):e?(o?e[u]=o:delete e[u],(h=e[0]||e[1])&&h===(e[1]||e[0])&&!h.length&&(r?r[c]=h:this._root=h),this):(this._root=o,this)},zo.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},zo.root=function(){return this._root},zo.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},zo.visit=function(t){var e,r,n,o,i=[],s=this._root;for(s&&i.push(new ko(s,this._x0,this._x1));e=i.pop();)if(!t(s=e.node,n=e.x0,o=e.x1)&&s.length){var a=(n+o)/2;(r=s[1])&&i.push(new ko(r,a,o)),(r=s[0])&&i.push(new ko(r,n,a))}return this},zo.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new ko(this._root,this._x0,this._x1));e=r.pop();){var o=e.node;if(o.length){var i,s=e.x0,a=e.x1,u=(s+a)/2;(i=o[0])&&r.push(new ko(i,s,u)),(i=o[1])&&r.push(new ko(i,u,a))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.x1);return this},zo.x=function(t){return arguments.length?(this._x=t,this):this._x};const Vo=4294967296;function Go(t){return t.x}function Bo(t){return t.y}function Uo(t){return t.z}var $o,Wo,Yo,Ho,Ko,Jo,Qo,Xo,Zo,ti,ei,ri,ni,oi,ii,si,ai,ui,ci,hi,di,li,fi,gi,pi,vi,yi,mi,wi,bi,xi,Ei,Ni,_i,Mi,ki,Ai,ji,Si,Oi,zi,Ri,Ii,Ci,Pi,Di,Ti,Fi,Li,qi,Vi,Gi,Bi,Ui,$i,Wi,Yi,Hi,Ki,Ji,Qi,Xi,Zi,ts,es,rs,ns,os,is,ss,as,us,cs,hs,ds,ls,fs,gs,ps,vs,ys,ms,ws,bs,xs,Es,Ns,_s,Ms,ks,As,js,Ss,Os,zs,Rs,Is,Cs,Ps,Ds,Ts,Fs,Ls,qs,Vs,Gs,Bs,Us,$s=Math.PI*(3-Math.sqrt(5)),Ws=20*Math.PI/(9+Math.sqrt(221));function Ys(t,e){e=e||2;var r,n=Math.min(3,Math.max(1,Math.round(e))),o=1,i=.001,s=1-Math.pow(i,1/300),a=0,u=.6,c=new Map,h=uo(f),d=$n("tick","end"),l=function(){let t=1;return()=>(t=(1664525*t+1013904223)%Vo)/Vo}();function f(){g(),d.call("tick",r),o<i&&(h.stop(),d.call("end",r))}function g(e){var i,h,d=t.length;void 0===e&&(e=1);for(var l=0;l<e;++l)for(o+=(a-o)*s,c.forEach((function(t){t(o)})),i=0;i<d;++i)null==(h=t[i]).fx?h.x+=h.vx*=u:(h.x=h.fx,h.vx=0),n>1&&(null==h.fy?h.y+=h.vy*=u:(h.y=h.fy,h.vy=0)),n>2&&(null==h.fz?h.z+=h.vz*=u:(h.z=h.fz,h.vz=0));return r}function p(){for(var e,r=0,o=t.length;r<o;++r){if((e=t[r]).index=r,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),null!=e.fz&&(e.z=e.fz),isNaN(e.x)||n>1&&isNaN(e.y)||n>2&&isNaN(e.z)){var i=10*(n>2?Math.cbrt(.5+r):n>1?Math.sqrt(.5+r):r),s=r*$s,a=r*Ws;1===n?e.x=i:2===n?(e.x=i*Math.cos(s),e.y=i*Math.sin(s)):(e.x=i*Math.sin(s)*Math.cos(a),e.y=i*Math.cos(s),e.z=i*Math.sin(s)*Math.sin(a))}(isNaN(e.vx)||n>1&&isNaN(e.vy)||n>2&&isNaN(e.vz))&&(e.vx=0,n>1&&(e.vy=0),n>2&&(e.vz=0))}}function v(e){return e.initialize&&e.initialize(t,l,n),e}return null==t&&(t=[]),p(),r={tick:g,restart:function(){return h.restart(f),r},stop:function(){return h.stop(),r},numDimensions:function(t){return arguments.length?(n=Math.min(3,Math.max(1,Math.round(t))),c.forEach(v),r):n},nodes:function(e){return arguments.length?(t=e,p(),c.forEach(v),r):t},alpha:function(t){return arguments.length?(o=+t,r):o},alphaMin:function(t){return arguments.length?(i=+t,r):i},alphaDecay:function(t){return arguments.length?(s=+t,r):+s},alphaTarget:function(t){return arguments.length?(a=+t,r):a},velocityDecay:function(t){return arguments.length?(u=1-t,r):1-u},randomSource:function(t){return arguments.length?(l=t,c.forEach(v),r):l},force:function(t,e){return arguments.length>1?(null==e?c.delete(t):c.set(t,v(e)),r):c.get(t)},find:function(){var e,r,o,i,s,a,u=Array.prototype.slice.call(arguments),c=u.shift()||0,h=(n>1?u.shift():null)||0,d=(n>2?u.shift():null)||0,l=u.shift()||1/0,f=0,g=t.length;for(l*=l,f=0;f<g;++f)(i=(e=c-(s=t[f]).x)*e+(r=h-(s.y||0))*r+(o=d-(s.z||0))*o)<l&&(a=s,l=i);return a},on:function(t,e){return arguments.length>1?(d.on(t,e),r):d.on(t)}}}function Hs(){var t,e,r,n,o,i,s=Ro(-30),a=1,u=1/0,c=.81;function h(n){var i,s=t.length,a=(1===e?jo(t,Go):2===e?nr(t,Go,Bo):3===e?fr(t,Go,Bo,Uo):null).visitAfter(l);for(o=n,i=0;i<s;++i)r=t[i],a.visit(f)}function d(){if(t){var e,r,n=t.length;for(i=new Array(n),e=0;e<n;++e)r=t[e],i[r.index]=+s(r,e,t)}}function l(t){var r,n,o,s,a,u,c=0,h=0,d=t.length;if(d){for(o=s=a=u=0;u<d;++u)(r=t[u])&&(n=Math.abs(r.value))&&(c+=r.value,h+=n,o+=n*(r.x||0),s+=n*(r.y||0),a+=n*(r.z||0));c*=Math.sqrt(4/d),t.x=o/h,e>1&&(t.y=s/h),e>2&&(t.z=a/h)}else{(r=t).x=r.data.x,e>1&&(r.y=r.data.y),e>2&&(r.z=r.data.z);do{c+=i[r.data.index]}while(r=r.next)}t.value=c}function f(t,s,h,d,l){if(!t.value)return!0;var f=[h,d,l][e-1],g=t.x-r.x,p=e>1?t.y-r.y:0,v=e>2?t.z-r.z:0,y=f-s,m=g*g+p*p+v*v;if(y*y/c<m)return m<u&&(0===g&&(m+=(g=Io(n))*g),e>1&&0===p&&(m+=(p=Io(n))*p),e>2&&0===v&&(m+=(v=Io(n))*v),m<a&&(m=Math.sqrt(a*m)),r.vx+=g*t.value*o/m,e>1&&(r.vy+=p*t.value*o/m),e>2&&(r.vz+=v*t.value*o/m)),!0;if(!(t.length||m>=u)){(t.data!==r||t.next)&&(0===g&&(m+=(g=Io(n))*g),e>1&&0===p&&(m+=(p=Io(n))*p),e>2&&0===v&&(m+=(v=Io(n))*v),m<a&&(m=Math.sqrt(a*m)));do{t.data!==r&&(y=i[t.data.index]*o/m,r.vx+=g*y,e>1&&(r.vy+=p*y),e>2&&(r.vz+=v*y))}while(t=t.next)}}return h.initialize=function(r,...o){t=r,n=o.find((t=>"function"==typeof t))||Math.random,e=o.find((t=>[1,2,3].includes(t)))||2,d()},h.strength=function(t){return arguments.length?(s="function"==typeof t?t:Ro(+t),d(),h):s},h.distanceMin=function(t){return arguments.length?(a=t*t,h):Math.sqrt(a)},h.distanceMax=function(t){return arguments.length?(u=t*t,h):Math.sqrt(u)},h.theta=function(t){return arguments.length?(c=t*t,h):Math.sqrt(c)},h}function Ks(t,e,r,n){var o,i,s,a,u=Ro(.1);function c(t){for(var u=0,c=o.length;u<c;++u){var h=o[u],d=h.x-e||1e-6,l=(h.y||0)-r||1e-6,f=(h.z||0)-n||1e-6,g=Math.sqrt(d*d+l*l+f*f),p=(a[u]-g)*s[u]*t/g;h.vx+=d*p,i>1&&(h.vy+=l*p),i>2&&(h.vz+=f*p)}}function h(){if(o){var e,r=o.length;for(s=new Array(r),a=new Array(r),e=0;e<r;++e)a[e]=+t(o[e],e,o),s[e]=isNaN(a[e])?0:+u(o[e],e,o)}}return"function"!=typeof t&&(t=Ro(+t)),null==e&&(e=0),null==r&&(r=0),null==n&&(n=0),c.initialize=function(t,...e){o=t,i=e.find((t=>[1,2,3].includes(t)))||2,h()},c.strength=function(t){return arguments.length?(u="function"==typeof t?t:Ro(+t),h(),c):u},c.radius=function(e){return arguments.length?(t="function"==typeof e?e:Ro(+e),h(),c):t},c.x=function(t){return arguments.length?(e=+t,c):e},c.y=function(t){return arguments.length?(r=+t,c):r},c.z=function(t){return arguments.length?(n=+t,c):n},c}function Js(t){var e,r,n,o=Ro(.1);function i(t){for(var o,i=0,s=e.length;i<s;++i)(o=e[i]).vx+=(n[i]-o.x)*r[i]*t}function s(){if(e){var i,s=e.length;for(r=new Array(s),n=new Array(s),i=0;i<s;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=Ro(null==t?0:+t)),i.initialize=function(t){e=t,s()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:Ro(+t),s(),i):o},i.x=function(e){return arguments.length?(t="function"==typeof e?e:Ro(+e),s(),i):t},i}function Qs(t){var e,r,n,o=Ro(.1);function i(t){for(var o,i=0,s=e.length;i<s;++i)(o=e[i]).vy+=(n[i]-o.y)*r[i]*t}function s(){if(e){var i,s=e.length;for(r=new Array(s),n=new Array(s),i=0;i<s;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=Ro(null==t?0:+t)),i.initialize=function(t){e=t,s()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:Ro(+t),s(),i):o},i.y=function(e){return arguments.length?(t="function"==typeof e?e:Ro(+e),s(),i):t},i}function Xs(t){var e,r,n,o=Ro(.1);function i(t){for(var o,i=0,s=e.length;i<s;++i)(o=e[i]).vz+=(n[i]-o.z)*r[i]*t}function s(){if(e){var i,s=e.length;for(r=new Array(s),n=new Array(s),i=0;i<s;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=Ro(null==t?0:+t)),i.initialize=function(t){e=t,s()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:Ro(+t),s(),i):o},i.z=function(e){return arguments.length?(t="function"==typeof e?e:Ro(+e),s(),i):t},i}function Zs(){if(Ho)return Yo;return Ho=1,Yo=function(t,e){return t===e||t!=t&&e!=e}}function ta(){if(Jo)return Ko;Jo=1;var t=Zs();return Ko=function(e,r){for(var n=e.length;n--;)if(t(e[n][0],r))return n;return-1}}function ea(){if(si)return ii;si=1;var t=Wo?$o:(Wo=1,$o=function(){this.__data__=[],this.size=0}),e=function(){if(Xo)return Qo;Xo=1;var t=ta(),e=Array.prototype.splice;return Qo=function(r){var n=this.__data__,o=t(n,r);return!(o<0||(o==n.length-1?n.pop():e.call(n,o,1),--this.size,0))}}(),r=function(){if(ti)return Zo;ti=1;var t=ta();return Zo=function(e){var r=this.__data__,n=t(r,e);return n<0?void 0:r[n][1]}}(),n=function(){if(ri)return ei;ri=1;var t=ta();return ei=function(e){return t(this.__data__,e)>-1}}(),o=function(){if(oi)return ni;oi=1;var t=ta();return ni=function(e,r){var n=this.__data__,o=t(n,e);return o<0?(++this.size,n.push([e,r])):n[o][1]=r,this}}();function i(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}return i.prototype.clear=t,i.prototype.delete=e,i.prototype.get=r,i.prototype.has=n,i.prototype.set=o,ii=i}function ra(){if(vi)return pi;vi=1;var t="object"==typeof Ar&&Ar&&Ar.Object===Object&&Ar;return pi=t}function na(){if(mi)return yi;mi=1;var t=ra(),e="object"==typeof self&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return yi=r}function oa(){if(bi)return wi;bi=1;var t=na().Symbol;return wi=t}function ia(){if(ki)return Mi;ki=1;var t=oa(),e=function(){if(Ei)return xi;Ei=1;var t=oa(),e=Object.prototype,r=e.hasOwnProperty,n=e.toString,o=t?t.toStringTag:void 0;return xi=function(t){var e=r.call(t,o),i=t[o];try{t[o]=void 0;var s=!0}catch(u){}var a=n.call(t);return s&&(e?t[o]=i:delete t[o]),a}}(),r=function(){if(_i)return Ni;_i=1;var t=Object.prototype.toString;return Ni=function(e){return t.call(e)}}(),n=t?t.toStringTag:void 0;return Mi=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":n&&n in Object(t)?e(t):r(t)}}function sa(){if(ji)return Ai;return ji=1,Ai=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}}function aa(){if(Oi)return Si;Oi=1;var t=ia(),e=sa();return Si=function(r){if(!e(r))return!1;var n=t(r);return"[object Function]"==n||"[object GeneratorFunction]"==n||"[object AsyncFunction]"==n||"[object Proxy]"==n}}function ua(){if(Ci)return Ii;Ci=1;var t,e=function(){if(Ri)return zi;Ri=1;var t=na()["__core-js_shared__"];return zi=t}(),r=(t=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||""))?"Symbol(src)_1."+t:"";return Ii=function(t){return!!r&&r in t}}function ca(){if(Di)return Pi;Di=1;var t=Function.prototype.toString;return Pi=function(e){if(null!=e){try{return t.call(e)}catch(r){}try{return e+""}catch(r){}}return""}}function ha(){if(Gi)return Vi;Gi=1;var t=function(){if(Fi)return Ti;Fi=1;var t=aa(),e=ua(),r=sa(),n=ca(),o=/^\[object .+?Constructor\]$/,i=Function.prototype,s=Object.prototype,a=i.toString,u=s.hasOwnProperty,c=RegExp("^"+a.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");return Ti=function(i){return!(!r(i)||e(i))&&(t(i)?c:o).test(n(i))}}(),e=qi?Li:(qi=1,Li=function(t,e){return null==t?void 0:t[e]});return Vi=function(r,n){var o=e(r,n);return t(o)?o:void 0}}function da(){if(Ui)return Bi;Ui=1;var t=ha()(na(),"Map");return Bi=t}function la(){if(Wi)return $i;Wi=1;var t=ha()(Object,"create");return $i=t}function fa(){if(os)return ns;os=1;var t=function(){if(Hi)return Yi;Hi=1;var t=la();return Yi=function(){this.__data__=t?t(null):{},this.size=0}}(),e=Ji?Ki:(Ji=1,Ki=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}),r=function(){if(Xi)return Qi;Xi=1;var t=la(),e=Object.prototype.hasOwnProperty;return Qi=function(r){var n=this.__data__;if(t){var o=n[r];return"__lodash_hash_undefined__"===o?void 0:o}return e.call(n,r)?n[r]:void 0}}(),n=function(){if(ts)return Zi;ts=1;var t=la(),e=Object.prototype.hasOwnProperty;return Zi=function(r){var n=this.__data__;return t?void 0!==n[r]:e.call(n,r)}}(),o=function(){if(rs)return es;rs=1;var t=la();return es=function(e,r){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=t&&void 0===r?"__lodash_hash_undefined__":r,this}}();function i(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}return i.prototype.clear=t,i.prototype.delete=e,i.prototype.get=r,i.prototype.has=n,i.prototype.set=o,ns=i}function ga(){if(hs)return cs;hs=1;var t=us?as:(us=1,as=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t});return cs=function(e,r){var n=e.__data__;return t(r)?n["string"==typeof r?"string":"hash"]:n.map}}function pa(){if(bs)return ws;bs=1;var t=function(){if(ss)return is;ss=1;var t=fa(),e=ea(),r=da();return is=function(){this.size=0,this.__data__={hash:new t,map:new(r||e),string:new t}}}(),e=function(){if(ls)return ds;ls=1;var t=ga();return ds=function(e){var r=t(this,e).delete(e);return this.size-=r?1:0,r}}(),r=function(){if(gs)return fs;gs=1;var t=ga();return fs=function(e){return t(this,e).get(e)}}(),n=function(){if(vs)return ps;vs=1;var t=ga();return ps=function(e){return t(this,e).has(e)}}(),o=function(){if(ms)return ys;ms=1;var t=ga();return ys=function(e,r){var n=t(this,e),o=n.size;return n.set(e,r),this.size+=n.size==o?0:1,this}}();function i(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}return i.prototype.clear=t,i.prototype.delete=e,i.prototype.get=r,i.prototype.has=n,i.prototype.set=o,ws=i}function va(){if(_s)return Ns;_s=1;var t=ea(),e=function(){if(ui)return ai;ui=1;var t=ea();return ai=function(){this.__data__=new t,this.size=0}}(),r=hi?ci:(hi=1,ci=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}),n=li?di:(li=1,di=function(t){return this.__data__.get(t)}),o=gi?fi:(gi=1,fi=function(t){return this.__data__.has(t)}),i=function(){if(Es)return xs;Es=1;var t=ea(),e=da(),r=pa();return xs=function(n,o){var i=this.__data__;if(i instanceof t){var s=i.__data__;if(!e||s.length<199)return s.push([n,o]),this.size=++i.size,this;i=this.__data__=new r(s)}return i.set(n,o),this.size=i.size,this}}();function s(e){var r=this.__data__=new t(e);this.size=r.size}return s.prototype.clear=e,s.prototype.delete=r,s.prototype.get=n,s.prototype.has=o,s.prototype.set=i,Ns=s}function ya(){if(ks)return Ms;return ks=1,Ms=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t}}function ma(){if(js)return As;js=1;var t=ha(),e=function(){try{var e=t(Object,"defineProperty");return e({},"",{}),e}catch(r){}}();return As=e}function wa(){if(Os)return Ss;Os=1;var t=ma();return Ss=function(e,r,n){"__proto__"==r&&t?t(e,r,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[r]=n}}function ba(){if(Rs)return zs;Rs=1;var t=wa(),e=Zs(),r=Object.prototype.hasOwnProperty;return zs=function(n,o,i){var s=n[o];r.call(n,o)&&e(s,i)&&(void 0!==i||o in n)||t(n,o,i)}}function xa(){if(Cs)return Is;Cs=1;var t=ba(),e=wa();return Is=function(r,n,o,i){var s=!o;o||(o={});for(var a=-1,u=n.length;++a<u;){var c=n[a],h=i?i(o[c],r[c],c,o,r):void 0;void 0===h&&(h=r[c]),s?e(o,c,h):t(o,c,h)}return o}}function Ea(){if(Fs)return Ts;return Fs=1,Ts=function(t){return null!=t&&"object"==typeof t}}function Na(){if(Gs)return Vs;Gs=1;var t=function(){if(qs)return Ls;qs=1;var t=ia(),e=Ea();return Ls=function(r){return e(r)&&"[object Arguments]"==t(r)}}(),e=Ea(),r=Object.prototype,n=r.hasOwnProperty,o=r.propertyIsEnumerable,i=t(function(){return arguments}())?t:function(t){return e(t)&&n.call(t,"callee")&&!o.call(t,"callee")};return Vs=i}function _a(){if(Us)return Bs;Us=1;var t=Array.isArray;return Bs=t}var Ma,ka,Aa,ja,Sa,Oa,za,Ra,Ia,Ca,Pa,Da={exports:{}};function Ta(){return Aa||(Aa=1,t=Da,e=Da.exports,r=na(),n=ka?Ma:(ka=1,Ma=function(){return!1}),o=e&&!e.nodeType&&e,i=o&&t&&!t.nodeType&&t,s=i&&i.exports===o?r.Buffer:void 0,a=(s?s.isBuffer:void 0)||n,t.exports=a),Da.exports;var t,e,r,n,o,i,s,a}function Fa(){if(Sa)return ja;Sa=1;var t=/^(?:0|[1-9]\d*)$/;return ja=function(e,r){var n=typeof e;return!!(r=null==r?9007199254740991:r)&&("number"==n||"symbol"!=n&&t.test(e))&&e>-1&&e%1==0&&e<r}}function La(){if(za)return Oa;za=1;return Oa=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}}function qa(){if(Pa)return Ca;return Pa=1,Ca=function(t){return function(e){return t(e)}}}var Va,Ga,Ba,Ua,$a,Wa,Ya,Ha,Ka,Ja,Qa,Xa,Za,tu,eu,ru,nu,ou,iu,su,au,uu,cu,hu,du,lu,fu,gu={exports:{}};function pu(){return Va||(Va=1,t=gu,e=gu.exports,r=ra(),n=e&&!e.nodeType&&e,o=n&&t&&!t.nodeType&&t,i=o&&o.exports===n&&r.process,s=function(){try{var t=o&&o.require&&o.require("util").types;return t||i&&i.binding&&i.binding("util")}catch(e){}}(),t.exports=s),gu.exports;var t,e,r,n,o,i,s}function vu(){if(Ba)return Ga;Ba=1;var t=function(){if(Ia)return Ra;Ia=1;var t=ia(),e=La(),r=Ea(),n={};return n["[object Float32Array]"]=n["[object Float64Array]"]=n["[object Int8Array]"]=n["[object Int16Array]"]=n["[object Int32Array]"]=n["[object Uint8Array]"]=n["[object Uint8ClampedArray]"]=n["[object Uint16Array]"]=n["[object Uint32Array]"]=!0,n["[object Arguments]"]=n["[object Array]"]=n["[object ArrayBuffer]"]=n["[object Boolean]"]=n["[object DataView]"]=n["[object Date]"]=n["[object Error]"]=n["[object Function]"]=n["[object Map]"]=n["[object Number]"]=n["[object Object]"]=n["[object RegExp]"]=n["[object Set]"]=n["[object String]"]=n["[object WeakMap]"]=!1,Ra=function(o){return r(o)&&e(o.length)&&!!n[t(o)]}}(),e=qa(),r=pu(),n=r&&r.isTypedArray,o=n?e(n):t;return Ga=o}function yu(){if($a)return Ua;$a=1;var t=Ds?Ps:(Ds=1,Ps=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}),e=Na(),r=_a(),n=Ta(),o=Fa(),i=vu(),s=Object.prototype.hasOwnProperty;return Ua=function(a,u){var c=r(a),h=!c&&e(a),d=!c&&!h&&n(a),l=!c&&!h&&!d&&i(a),f=c||h||d||l,g=f?t(a.length,String):[],p=g.length;for(var v in a)!u&&!s.call(a,v)||f&&("length"==v||d&&("offset"==v||"parent"==v)||l&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||o(v,p))||g.push(v);return g}}function mu(){if(Ya)return Wa;Ya=1;var t=Object.prototype;return Wa=function(e){var r=e&&e.constructor;return e===("function"==typeof r&&r.prototype||t)}}function wu(){if(Ka)return Ha;return Ka=1,Ha=function(t,e){return function(r){return t(e(r))}}}function bu(){if(Za)return Xa;Za=1;var t=mu(),e=function(){if(Qa)return Ja;Qa=1;var t=wu()(Object.keys,Object);return Ja=t}(),r=Object.prototype.hasOwnProperty;return Xa=function(n){if(!t(n))return e(n);var o=[];for(var i in Object(n))r.call(n,i)&&"constructor"!=i&&o.push(i);return o}}function xu(){if(eu)return tu;eu=1;var t=aa(),e=La();return tu=function(r){return null!=r&&e(r.length)&&!t(r)}}function Eu(){if(nu)return ru;nu=1;var t=yu(),e=bu(),r=xu();return ru=function(n){return r(n)?t(n):e(n)}}function Nu(){if(cu)return uu;cu=1;var t=sa(),e=mu(),r=au?su:(au=1,su=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}),n=Object.prototype.hasOwnProperty;return uu=function(o){if(!t(o))return r(o);var i=e(o),s=[];for(var a in o)("constructor"!=a||!i&&n.call(o,a))&&s.push(a);return s}}function _u(){if(du)return hu;du=1;var t=yu(),e=Nu(),r=xu();return hu=function(n){return r(n)?t(n,!0):e(n)}}var Mu,ku,Au,ju,Su,Ou,zu,Ru,Iu,Cu,Pu,Du,Tu,Fu,Lu,qu,Vu,Gu,Bu,Uu,$u,Wu,Yu,Hu,Ku,Ju,Qu,Xu,Zu,tc,ec,rc,nc,oc,ic,sc,ac,uc,cc,hc,dc,lc,fc,gc,pc,vc,yc,mc,wc,bc,xc,Ec,Nc,_c,Mc,kc,Ac,jc,Sc,Oc,zc,Rc,Ic,Cc,Pc,Dc,Tc,Fc,Lc,qc,Vc,Gc,Bc,Uc,$c,Wc,Yc,Hc,Kc,Jc,Qc,Xc,Zc,th,eh,rh,nh,oh,ih,sh,ah,uh,ch,hh,dh,lh,fh,gh,ph,vh,yh,mh,wh,bh,xh,Eh,Nh,_h,Mh,kh,Ah,jh,Sh,Oh,zh,Rh,Ih,Ch,Ph,Dh,Th,Fh,Lh,qh,Vh,Gh,Bh,Uh,$h,Wh,Yh,Hh,Kh,Jh,Qh,Xh,Zh,td,ed,rd,nd,od,id,sd,ad,ud,cd,hd,dd,ld,fd,gd,pd,vd,yd,md,wd,bd,xd,Ed,Nd,_d,Md,kd,Ad,jd,Sd,Od,zd,Rd,Id,Cd,Pd,Dd,Td,Fd,Ld,qd,Vd,Gd,Bd,Ud,$d,Wd,Yd,Hd,Kd,Jd,Qd,Xd,Zd,tl,el,rl,nl,ol,il,sl,al,ul,cl,hl,dl,ll,fl,gl,pl,vl,yl,ml,wl,bl,xl,El,Nl,_l,Ml,kl,Al,jl,Sl,Ol,zl,Rl,Il,Cl,Pl,Dl,Tl,Fl,Ll,ql,Vl,Gl,Bl,Ul,$l,Wl,Yl,Hl,Kl,Jl,Ql,Xl,Zl,tf,ef,rf,nf,of,sf,af,uf,cf,hf,df,lf,ff,gf,pf,vf,yf,mf,wf,bf,xf,Ef,Nf,_f,Mf,kf,Af,jf,Sf,Of,zf,Rf,If,Cf,Pf,Df={exports:{}};function Tf(){return Mu||(Mu=1,t=Df,e=Df.exports,r=na(),n=e&&!e.nodeType&&e,o=n&&t&&!t.nodeType&&t,i=o&&o.exports===n?r.Buffer:void 0,s=i?i.allocUnsafe:void 0,t.exports=function(t,e){if(e)return t.slice();var r=t.length,n=s?s(r):new t.constructor(r);return t.copy(n),n}),Df.exports;var t,e,r,n,o,i,s}function Ff(){if(Au)return ku;return Au=1,ku=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}}function Lf(){if(Su)return ju;return Su=1,ju=function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var s=t[r];e(s,r,t)&&(i[o++]=s)}return i}}function qf(){if(zu)return Ou;return zu=1,Ou=function(){return[]}}function Vf(){if(Iu)return Ru;Iu=1;var t=Lf(),e=qf(),r=Object.prototype.propertyIsEnumerable,n=Object.getOwnPropertySymbols;return Ru=n?function(e){return null==e?[]:(e=Object(e),t(n(e),(function(t){return r.call(e,t)})))}:e}function Gf(){if(Tu)return Du;return Tu=1,Du=function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}}function Bf(){if(Lu)return Fu;Lu=1;var t=wu()(Object.getPrototypeOf,Object);return Fu=t}function Uf(){if(Vu)return qu;Vu=1;var t=Gf(),e=Bf(),r=Vf(),n=qf(),o=Object.getOwnPropertySymbols;return qu=o?function(n){for(var o=[];n;)t(o,r(n)),n=e(n);return o}:n}function $f(){if($u)return Uu;$u=1;var t=Gf(),e=_a();return Uu=function(r,n,o){var i=n(r);return e(r)?i:t(i,o(r))}}function Wf(){if(Yu)return Wu;Yu=1;var t=$f(),e=Vf(),r=Eu();return Wu=function(n){return t(n,r,e)}}function Yf(){if(ec)return tc;ec=1;var t=ha()(na(),"Set");return tc=t}function Hf(){if(ic)return oc;ic=1;var t=function(){if(Qu)return Ju;Qu=1;var t=ha()(na(),"DataView");return Ju=t}(),e=da(),r=function(){if(Zu)return Xu;Zu=1;var t=ha()(na(),"Promise");return Xu=t}(),n=Yf(),o=function(){if(nc)return rc;nc=1;var t=ha()(na(),"WeakMap");return rc=t}(),i=ia(),s=ca(),a="[object Map]",u="[object Promise]",c="[object Set]",h="[object WeakMap]",d="[object DataView]",l=s(t),f=s(e),g=s(r),p=s(n),v=s(o),y=i;return(t&&y(new t(new ArrayBuffer(1)))!=d||e&&y(new e)!=a||r&&y(r.resolve())!=u||n&&y(new n)!=c||o&&y(new o)!=h)&&(y=function(t){var e=i(t),r="[object Object]"==e?t.constructor:void 0,n=r?s(r):"";if(n)switch(n){case l:return d;case f:return a;case g:return u;case p:return c;case v:return h}return e}),oc=y}function Kf(){if(cc)return uc;cc=1;var t=na().Uint8Array;return uc=t}function Jf(){if(dc)return hc;dc=1;var t=Kf();return hc=function(e){var r=new e.constructor(e.byteLength);return new t(r).set(new t(e)),r}}function Qf(){if(wc)return mc;wc=1;var t=Jf();return mc=function(e,r){var n=r?t(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}}function Xf(){if(xc)return bc;xc=1;var t=Jf(),e=function(){if(fc)return lc;fc=1;var t=Jf();return lc=function(e,r){var n=r?t(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}}(),r=function(){if(pc)return gc;pc=1;var t=/\w*$/;return gc=function(e){var r=new e.constructor(e.source,t.exec(e));return r.lastIndex=e.lastIndex,r}}(),n=function(){if(yc)return vc;yc=1;var t=oa(),e=t?t.prototype:void 0,r=e?e.valueOf:void 0;return vc=function(t){return r?Object(r.call(t)):{}}}(),o=Qf();return bc=function(i,s,a){var u=i.constructor;switch(s){case"[object ArrayBuffer]":return t(i);case"[object Boolean]":case"[object Date]":return new u(+i);case"[object DataView]":return e(i,a);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return o(i,a);case"[object Map]":case"[object Set]":return new u;case"[object Number]":case"[object String]":return new u(i);case"[object RegExp]":return r(i);case"[object Symbol]":return n(i)}}}function Zf(){if(Nc)return Ec;Nc=1;var t=sa(),e=Object.create;return Ec=function(){function r(){}return function(n){if(!t(n))return{};if(e)return e(n);r.prototype=n;var o=new r;return r.prototype=void 0,o}}()}function tg(){if(Mc)return _c;Mc=1;var t=Zf(),e=Bf(),r=mu();return _c=function(n){return"function"!=typeof n.constructor||r(n)?{}:t(e(n))}}function eg(){if(Sc)return jc;Sc=1;var t=function(){if(Ac)return kc;Ac=1;var t=Hf(),e=Ea();return kc=function(r){return e(r)&&"[object Map]"==t(r)}}(),e=qa(),r=pu(),n=r&&r.isMap,o=n?e(n):t;return jc=o}function rg(){if(Ic)return Rc;Ic=1;var t=function(){if(zc)return Oc;zc=1;var t=Hf(),e=Ea();return Oc=function(r){return e(r)&&"[object Set]"==t(r)}}(),e=qa(),r=pu(),n=r&&r.isSet,o=n?e(n):t;return Rc=o}function ng(){if(Pc)return Cc;Pc=1;var t=va(),e=ya(),r=ba(),n=function(){if(iu)return ou;iu=1;var t=xa(),e=Eu();return ou=function(r,n){return r&&t(n,e(n),r)}}(),o=function(){if(fu)return lu;fu=1;var t=xa(),e=_u();return lu=function(r,n){return r&&t(n,e(n),r)}}(),i=Tf(),s=Ff(),a=function(){if(Pu)return Cu;Pu=1;var t=xa(),e=Vf();return Cu=function(r,n){return t(r,e(r),n)}}(),u=function(){if(Bu)return Gu;Bu=1;var t=xa(),e=Uf();return Gu=function(r,n){return t(r,e(r),n)}}(),c=Wf(),h=function(){if(Ku)return Hu;Ku=1;var t=$f(),e=Uf(),r=_u();return Hu=function(n){return t(n,r,e)}}(),d=Hf(),l=function(){if(ac)return sc;ac=1;var t=Object.prototype.hasOwnProperty;return sc=function(e){var r=e.length,n=new e.constructor(r);return r&&"string"==typeof e[0]&&t.call(e,"index")&&(n.index=e.index,n.input=e.input),n}}(),f=Xf(),g=tg(),p=_a(),v=Ta(),y=eg(),m=sa(),w=rg(),b=Eu(),x=_u(),E="[object Arguments]",N="[object Function]",_="[object Object]",M={};return M[E]=M["[object Array]"]=M["[object ArrayBuffer]"]=M["[object DataView]"]=M["[object Boolean]"]=M["[object Date]"]=M["[object Float32Array]"]=M["[object Float64Array]"]=M["[object Int8Array]"]=M["[object Int16Array]"]=M["[object Int32Array]"]=M["[object Map]"]=M["[object Number]"]=M[_]=M["[object RegExp]"]=M["[object Set]"]=M["[object String]"]=M["[object Symbol]"]=M["[object Uint8Array]"]=M["[object Uint8ClampedArray]"]=M["[object Uint16Array]"]=M["[object Uint32Array]"]=!0,M["[object Error]"]=M[N]=M["[object WeakMap]"]=!1,Cc=function k(A,j,S,O,z,R){var I,C=1&j,P=2&j,D=4&j;if(S&&(I=z?S(A,O,z,R):S(A)),void 0!==I)return I;if(!m(A))return A;var T=p(A);if(T){if(I=l(A),!C)return s(A,I)}else{var F=d(A),L=F==N||"[object GeneratorFunction]"==F;if(v(A))return i(A,C);if(F==_||F==E||L&&!z){if(I=P||L?{}:g(A),!C)return P?u(A,o(I,A)):a(A,n(I,A))}else{if(!M[F])return z?A:{};I=f(A,F,C)}}R||(R=new t);var q=R.get(A);if(q)return q;R.set(A,I),w(A)?A.forEach((function(t){I.add(k(t,j,S,t,A,R))})):y(A)&&A.forEach((function(t,e){I.set(e,k(t,j,S,e,A,R))}));var V=T?void 0:(D?P?h:c:P?x:b)(A);return e(V||A,(function(t,e){V&&(t=A[e=t]),r(I,e,k(t,j,S,e,A,R))})),I},Cc}function og(){if(Tc)return Dc;Tc=1;var t=ng();return Dc=function(e){return t(e,4)}}function ig(){if(Lc)return Fc;return Lc=1,Fc=function(t){return function(){return t}}}function sg(){if(Bc)return Gc;Bc=1;var t=(Vc?qc:(Vc=1,qc=function(t){return function(e,r,n){for(var o=-1,i=Object(e),s=n(e),a=s.length;a--;){var u=s[t?a:++o];if(!1===r(i[u],u,i))break}return e}}))();return Gc=t}function ag(){if($c)return Uc;$c=1;var t=sg(),e=Eu();return Uc=function(r,n){return r&&t(r,n,e)}}function ug(){if(Kc)return Hc;Kc=1;var t=ag(),e=function(){if(Yc)return Wc;Yc=1;var t=xu();return Wc=function(e,r){return function(n,o){if(null==n)return n;if(!t(n))return e(n,o);for(var i=n.length,s=r?i:-1,a=Object(n);(r?s--:++s<i)&&!1!==o(a[s],s,a););return n}}}()(t);return Hc=e}function cg(){if(Qc)return Jc;return Qc=1,Jc=function(t){return t}}function hg(){if(Zc)return Xc;Zc=1;var t=cg();return Xc=function(e){return"function"==typeof e?e:t}}function dg(){if(eh)return th;eh=1;var t=ya(),e=ug(),r=hg(),n=_a();return th=function(o,i){return(n(o)?t:e)(o,r(i))}}function lg(){return nh?rh:(nh=1,rh=dg())}function fg(){if(dh)return hh;dh=1;var t=pa(),e=ah?sh:(ah=1,sh=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}),r=ch?uh:(ch=1,uh=function(t){return this.__data__.has(t)});function n(e){var r=-1,n=null==e?0:e.length;for(this.__data__=new t;++r<n;)this.add(e[r])}return n.prototype.add=n.prototype.push=e,n.prototype.has=r,hh=n}function gg(){if(ph)return gh;return ph=1,gh=function(t,e){return t.has(e)}}function pg(){if(yh)return vh;yh=1;var t=fg(),e=fh?lh:(fh=1,lh=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}),r=gg();return vh=function(n,o,i,s,a,u){var c=1&i,h=n.length,d=o.length;if(h!=d&&!(c&&d>h))return!1;var l=u.get(n),f=u.get(o);if(l&&f)return l==o&&f==n;var g=-1,p=!0,v=2&i?new t:void 0;for(u.set(n,o),u.set(o,n);++g<h;){var y=n[g],m=o[g];if(s)var w=c?s(m,y,g,o,n,u):s(y,m,g,n,o,u);if(void 0!==w){if(w)continue;p=!1;break}if(v){if(!e(o,(function(t,e){if(!r(v,e)&&(y===t||a(y,t,i,s,u)))return v.push(e)}))){p=!1;break}}else if(y!==m&&!a(y,m,i,s,u)){p=!1;break}}return u.delete(n),u.delete(o),p}}function vg(){if(xh)return bh;return xh=1,bh=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}}function yg(){if(Nh)return Eh;Nh=1;var t=oa(),e=Kf(),r=Zs(),n=pg(),o=wh?mh:(wh=1,mh=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r}),i=vg(),s=t?t.prototype:void 0,a=s?s.valueOf:void 0;return Eh=function(t,s,u,c,h,d,l){switch(u){case"[object DataView]":if(t.byteLength!=s.byteLength||t.byteOffset!=s.byteOffset)return!1;t=t.buffer,s=s.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=s.byteLength||!d(new e(t),new e(s)));case"[object Boolean]":case"[object Date]":case"[object Number]":return r(+t,+s);case"[object Error]":return t.name==s.name&&t.message==s.message;case"[object RegExp]":case"[object String]":return t==s+"";case"[object Map]":var f=o;case"[object Set]":var g=1&c;if(f||(f=i),t.size!=s.size&&!g)return!1;var p=l.get(t);if(p)return p==s;c|=2,l.set(t,s);var v=n(f(t),f(s),c,h,d,l);return l.delete(t),v;case"[object Symbol]":if(a)return a.call(t)==a.call(s)}return!1}}function mg(){if(Ah)return kh;Ah=1;var t=va(),e=pg(),r=yg(),n=function(){if(Mh)return _h;Mh=1;var t=Wf(),e=Object.prototype.hasOwnProperty;return _h=function(r,n,o,i,s,a){var u=1&o,c=t(r),h=c.length;if(h!=t(n).length&&!u)return!1;for(var d=h;d--;){var l=c[d];if(!(u?l in n:e.call(n,l)))return!1}var f=a.get(r),g=a.get(n);if(f&&g)return f==n&&g==r;var p=!0;a.set(r,n),a.set(n,r);for(var v=u;++d<h;){var y=r[l=c[d]],m=n[l];if(i)var w=u?i(m,y,l,n,r,a):i(y,m,l,r,n,a);if(!(void 0===w?y===m||s(y,m,o,i,a):w)){p=!1;break}v||(v="constructor"==l)}if(p&&!v){var b=r.constructor,x=n.constructor;b==x||!("constructor"in r)||!("constructor"in n)||"function"==typeof b&&b instanceof b&&"function"==typeof x&&x instanceof x||(p=!1)}return a.delete(r),a.delete(n),p}}(),o=Hf(),i=_a(),s=Ta(),a=vu(),u="[object Arguments]",c="[object Array]",h="[object Object]",d=Object.prototype.hasOwnProperty;return kh=function(l,f,g,p,v,y){var m=i(l),w=i(f),b=m?c:o(l),x=w?c:o(f),E=(b=b==u?h:b)==h,N=(x=x==u?h:x)==h,_=b==x;if(_&&s(l)){if(!s(f))return!1;m=!0,E=!1}if(_&&!E)return y||(y=new t),m||a(l)?e(l,f,g,p,v,y):r(l,f,b,g,p,v,y);if(!(1&g)){var M=E&&d.call(l,"__wrapped__"),k=N&&d.call(f,"__wrapped__");if(M||k){var A=M?l.value():l,j=k?f.value():f;return y||(y=new t),v(A,j,g,p,y)}}return!!_&&(y||(y=new t),n(l,f,g,p,v,y))}}function wg(){if(Sh)return jh;Sh=1;var t=mg(),e=Ea();return jh=function r(n,o,i,s,a){return n===o||(null==n||null==o||!e(n)&&!e(o)?n!=n&&o!=o:t(n,o,i,s,r,a))},jh}function bg(){if(Ih)return Rh;Ih=1;var t=sa();return Rh=function(e){return e==e&&!t(e)}}function xg(){if(Th)return Dh;return Th=1,Dh=function(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}}}function Eg(){if(Lh)return Fh;Lh=1;var t=function(){if(zh)return Oh;zh=1;var t=va(),e=wg();return Oh=function(r,n,o,i){var s=o.length,a=s,u=!i;if(null==r)return!a;for(r=Object(r);s--;){var c=o[s];if(u&&c[2]?c[1]!==r[c[0]]:!(c[0]in r))return!1}for(;++s<a;){var h=(c=o[s])[0],d=r[h],l=c[1];if(u&&c[2]){if(void 0===d&&!(h in r))return!1}else{var f=new t;if(i)var g=i(d,l,h,r,n,f);if(!(void 0===g?e(l,d,3,i,f):g))return!1}}return!0}}(),e=function(){if(Ph)return Ch;Ph=1;var t=bg(),e=Eu();return Ch=function(r){for(var n=e(r),o=n.length;o--;){var i=n[o],s=r[i];n[o]=[i,s,t(s)]}return n}}(),r=xg();return Fh=function(n){var o=e(n);return 1==o.length&&o[0][2]?r(o[0][0],o[0][1]):function(e){return e===n||t(e,n,o)}}}function Ng(){if(Vh)return qh;Vh=1;var t=ia(),e=Ea();return qh=function(r){return"symbol"==typeof r||e(r)&&"[object Symbol]"==t(r)}}function _g(){if(Bh)return Gh;Bh=1;var t=_a(),e=Ng(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;return Gh=function(o,i){if(t(o))return!1;var s=typeof o;return!("number"!=s&&"symbol"!=s&&"boolean"!=s&&null!=o&&!e(o))||(n.test(o)||!r.test(o)||null!=i&&o in Object(i))}}function Mg(){if(Yh)return Wh;Yh=1;var t=function(){if($h)return Uh;$h=1;var t=pa();function e(r,n){if("function"!=typeof r||null!=n&&"function"!=typeof n)throw new TypeError("Expected a function");var o=function(){var t=arguments,e=n?n.apply(this,t):t[0],i=o.cache;if(i.has(e))return i.get(e);var s=r.apply(this,t);return o.cache=i.set(e,s)||i,s};return o.cache=new(e.Cache||t),o}return e.Cache=t,Uh=e}();return Wh=function(e){var r=t(e,(function(t){return 500===n.size&&n.clear(),t})),n=r.cache;return r}}function kg(){if(Qh)return Jh;return Qh=1,Jh=function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}}function Ag(){if(ed)return td;ed=1;var t=function(){if(Zh)return Xh;Zh=1;var t=oa(),e=kg(),r=_a(),n=Ng(),o=t?t.prototype:void 0,i=o?o.toString:void 0;return Xh=function t(o){if("string"==typeof o)return o;if(r(o))return e(o,t)+"";if(n(o))return i?i.call(o):"";var s=o+"";return"0"==s&&1/o==-1/0?"-0":s},Xh}();return td=function(e){return null==e?"":t(e)}}function jg(){if(nd)return rd;nd=1;var t=_a(),e=_g(),r=function(){if(Kh)return Hh;Kh=1;var t=Mg(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=t((function(t){var n=[];return 46===t.charCodeAt(0)&&n.push(""),t.replace(e,(function(t,e,o,i){n.push(o?i.replace(r,"$1"):e||t)})),n}));return Hh=n}(),n=Ag();return rd=function(o,i){return t(o)?o:e(o,i)?[o]:r(n(o))}}function Sg(){if(id)return od;id=1;var t=Ng();return od=function(e){if("string"==typeof e||t(e))return e;var r=e+"";return"0"==r&&1/e==-1/0?"-0":r}}function Og(){if(ad)return sd;ad=1;var t=jg(),e=Sg();return sd=function(r,n){for(var o=0,i=(n=t(n,r)).length;null!=r&&o<i;)r=r[e(n[o++])];return o&&o==i?r:void 0}}function zg(){if(fd)return ld;fd=1;var t=jg(),e=Na(),r=_a(),n=Fa(),o=La(),i=Sg();return ld=function(s,a,u){for(var c=-1,h=(a=t(a,s)).length,d=!1;++c<h;){var l=i(a[c]);if(!(d=null!=s&&u(s,l)))break;s=s[l]}return d||++c!=h?d:!!(h=null==s?0:s.length)&&o(h)&&n(l,h)&&(r(s)||e(s))}}function Rg(){if(pd)return gd;pd=1;var t=dd?hd:(dd=1,hd=function(t,e){return null!=t&&e in Object(t)}),e=zg();return gd=function(r,n){return null!=r&&e(r,n,t)}}function Ig(){if(yd)return vd;yd=1;var t=wg(),e=function(){if(cd)return ud;cd=1;var t=Og();return ud=function(e,r,n){var o=null==e?void 0:t(e,r);return void 0===o?n:o}}(),r=Rg(),n=_g(),o=bg(),i=xg(),s=Sg();return vd=function(a,u){return n(a)&&o(u)?i(s(a),u):function(n){var o=e(n,a);return void 0===o&&o===u?r(n,a):t(u,o,3)}}}function Cg(){if(wd)return md;return wd=1,md=function(t){return function(e){return null==e?void 0:e[t]}}}function Pg(){if(Nd)return Ed;Nd=1;var t=Cg(),e=function(){if(xd)return bd;xd=1;var t=Og();return bd=function(e){return function(r){return t(r,e)}}}(),r=_g(),n=Sg();return Ed=function(o){return r(o)?t(n(o)):e(o)}}function Dg(){if(Md)return _d;Md=1;var t=Eg(),e=Ig(),r=cg(),n=_a(),o=Pg();return _d=function(i){return"function"==typeof i?i:null==i?r:"object"==typeof i?n(i)?e(i[0],i[1]):t(i):o(i)}}function Tg(){if(Ad)return kd;Ad=1;var t=Lf(),e=function(){if(ih)return oh;ih=1;var t=ug();return oh=function(e,r){var n=[];return t(e,(function(t,e,o){r(t,e,o)&&n.push(t)})),n}}(),r=Dg(),n=_a();return kd=function(o,i){return(n(o)?t:e)(o,r(i,3))}}function Fg(){if(zd)return Od;zd=1;var t=function(){if(Sd)return jd;Sd=1;var t=Object.prototype.hasOwnProperty;return jd=function(e,r){return null!=e&&t.call(e,r)}}(),e=zg();return Od=function(r,n){return null!=r&&e(r,n,t)}}function Lg(){if(Id)return Rd;Id=1;var t=bu(),e=Hf(),r=Na(),n=_a(),o=xu(),i=Ta(),s=mu(),a=vu(),u=Object.prototype.hasOwnProperty;return Rd=function(c){if(null==c)return!0;if(o(c)&&(n(c)||"string"==typeof c||"function"==typeof c.splice||i(c)||a(c)||r(c)))return!c.length;var h=e(c);if("[object Map]"==h||"[object Set]"==h)return!c.size;if(s(c))return!t(c).length;for(var d in c)if(u.call(c,d))return!1;return!0}}function qg(){if(Pd)return Cd;return Pd=1,Cd=function(t){return void 0===t}}function Vg(){if(Td)return Dd;Td=1;var t=ug(),e=xu();return Dd=function(r,n){var o=-1,i=e(r)?Array(r.length):[];return t(r,(function(t,e,r){i[++o]=n(t,e,r)})),i}}function Gg(){if(Ld)return Fd;Ld=1;var t=kg(),e=Dg(),r=Vg(),n=_a();return Fd=function(o,i){return(n(o)?t:r)(o,e(i,3))}}function Bg(){if($d)return Ud;$d=1;var t=Vd?qd:(Vd=1,qd=function(t,e,r,n){var o=-1,i=null==t?0:t.length;for(n&&i&&(r=t[++o]);++o<i;)r=e(r,t[o],o,t);return r}),e=ug(),r=Dg(),n=Bd?Gd:(Bd=1,Gd=function(t,e,r,n,o){return o(t,(function(t,o,i){r=n?(n=!1,t):e(r,t,o,i)})),r}),o=_a();return Ud=function(i,s,a){var u=o(i)?t:n,c=arguments.length<3;return u(i,r(s,4),a,c,e)},Ud}function Ug(){if(el)return tl;el=1;var t=function(){if(Kd)return Hd;Kd=1;var t=Cg()("length");return Hd=t}(),e=function(){if(Qd)return Jd;Qd=1;var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");return Jd=function(e){return t.test(e)}}(),r=function(){if(Zd)return Xd;Zd=1;var t="\\ud800-\\udfff",e="["+t+"]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",n="\\ud83c[\\udffb-\\udfff]",o="[^"+t+"]",i="(?:\\ud83c[\\udde6-\\uddff]){2}",s="[\\ud800-\\udbff][\\udc00-\\udfff]",a="(?:"+r+"|"+n+")?",u="[\\ufe0e\\ufe0f]?",c=u+a+"(?:\\u200d(?:"+[o,i,s].join("|")+")"+u+a+")*",h="(?:"+[o+r+"?",r,i,s,e].join("|")+")",d=RegExp(n+"(?="+n+")|"+h+c,"g");return Xd=function(t){for(var e=d.lastIndex=0;d.test(t);)++e;return e}}();return tl=function(n){return e(n)?r(n):t(n)}}function $g(){if(nl)return rl;nl=1;var t=bu(),e=Hf(),r=xu(),n=function(){if(Yd)return Wd;Yd=1;var t=ia(),e=_a(),r=Ea();return Wd=function(n){return"string"==typeof n||!e(n)&&r(n)&&"[object String]"==t(n)}}(),o=Ug();return rl=function(i){if(null==i)return 0;if(r(i))return n(i)?o(i):i.length;var s=e(i);return"[object Map]"==s||"[object Set]"==s?i.size:t(i).length}}function Wg(){if(il)return ol;il=1;var t=ya(),e=Zf(),r=ag(),n=Dg(),o=Bf(),i=_a(),s=Ta(),a=aa(),u=sa(),c=vu();return ol=function(h,d,l){var f=i(h),g=f||s(h)||c(h);if(d=n(d,4),null==l){var p=h&&h.constructor;l=g?f?new p:[]:u(h)&&a(p)?e(o(h)):{}}return(g?t:r)(h,(function(t,e,r){return d(l,t,e,r)})),l}}function Yg(){if(cl)return ul;cl=1;var t=Gf(),e=function(){if(al)return sl;al=1;var t=oa(),e=Na(),r=_a(),n=t?t.isConcatSpreadable:void 0;return sl=function(t){return r(t)||e(t)||!!(n&&t&&t[n])}}();return ul=function r(n,o,i,s,a){var u=-1,c=n.length;for(i||(i=e),a||(a=[]);++u<c;){var h=n[u];o>0&&i(h)?o>1?r(h,o-1,i,s,a):t(a,h):s||(a[a.length]=h)}return a},ul}function Hg(){if(fl)return ll;fl=1;var t=dl?hl:(dl=1,hl=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}),e=Math.max;return ll=function(r,n,o){return n=e(void 0===n?r.length-1:n,0),function(){for(var i=arguments,s=-1,a=e(i.length-n,0),u=Array(a);++s<a;)u[s]=i[n+s];s=-1;for(var c=Array(n+1);++s<n;)c[s]=i[s];return c[n]=o(u),t(r,this,c)}},ll}function Kg(){if(wl)return ml;wl=1;var t=function(){if(pl)return gl;pl=1;var t=ig(),e=ma(),r=cg();return gl=e?function(r,n){return e(r,"toString",{configurable:!0,enumerable:!1,value:t(n),writable:!0})}:r}(),e=function(){if(yl)return vl;yl=1;var t=Date.now;return vl=function(e){var r=0,n=0;return function(){var o=t(),i=16-(o-n);if(n=o,i>0){if(++r>=800)return arguments[0]}else r=0;return e.apply(void 0,arguments)}},vl}(),r=e(t);return ml=r}function Jg(){if(xl)return bl;xl=1;var t=cg(),e=Hg(),r=Kg();return bl=function(n,o){return r(e(n,o,t),n+"")}}function Qg(){if(Nl)return El;return Nl=1,El=function(t,e,r,n){for(var o=t.length,i=r+(n?1:-1);n?i--:++i<o;)if(e(t[i],i,t))return i;return-1}}function Xg(){if(Sl)return jl;Sl=1;var t=Qg(),e=Ml?_l:(Ml=1,_l=function(t){return t!=t}),r=Al?kl:(Al=1,kl=function(t,e,r){for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1});return jl=function(n,o,i){return o==o?r(n,o,i):t(n,e,i)}}function Zg(){if(Tl)return Dl;Tl=1;var t=Yf(),e=Pl?Cl:(Pl=1,Cl=function(){}),r=vg(),n=t&&1/r(new t([,-0]))[1]==1/0?function(e){return new t(e)}:e;return Dl=n}function tp(){if(Ll)return Fl;Ll=1;var t=fg(),e=function(){if(zl)return Ol;zl=1;var t=Xg();return Ol=function(e,r){return!(null==e||!e.length)&&t(e,r,0)>-1}}(),r=Il?Rl:(Il=1,Rl=function(t,e,r){for(var n=-1,o=null==t?0:t.length;++n<o;)if(r(e,t[n]))return!0;return!1}),n=gg(),o=Zg(),i=vg();return Fl=function(s,a,u){var c=-1,h=e,d=s.length,l=!0,f=[],g=f;if(u)l=!1,h=r;else if(d>=200){var p=a?null:o(s);if(p)return i(p);l=!1,h=n,g=new t}else g=a?[]:f;t:for(;++c<d;){var v=s[c],y=a?a(v):v;if(v=u||0!==v?v:0,l&&y==y){for(var m=g.length;m--;)if(g[m]===y)continue t;a&&g.push(y),f.push(v)}else h(g,y,u)||(g!==f&&g.push(y),f.push(v))}return f}}function ep(){if(Vl)return ql;Vl=1;var t=xu(),e=Ea();return ql=function(r){return e(r)&&t(r)}}function rp(){if(Bl)return Gl;Bl=1;var t=Yg(),e=Jg(),r=tp(),n=ep(),o=e((function(e){return r(t(e,1,n,!0))}));return Gl=o}function np(){if(Yl)return Wl;Yl=1;var t=function(){if($l)return Ul;$l=1;var t=kg();return Ul=function(e,r){return t(r,(function(t){return e[t]}))}}(),e=Eu();return Wl=function(r){return null==r?[]:t(r,e(r))}}function op(){if(Kl)return Hl;var t;Kl=1;try{t={clone:og(),constant:ig(),each:lg(),filter:Tg(),has:Fg(),isArray:_a(),isEmpty:Lg(),isFunction:aa(),isUndefined:qg(),keys:Eu(),map:Gg(),reduce:Bg(),size:$g(),transform:Wg(),union:rp(),values:np()}}catch(e){}return t||(t=window._),Hl=t}function ip(){if(Ql)return Jl;Ql=1;var t=op();Jl=r;var e="\0";function r(r){this._isDirected=!t.has(r,"directed")||r.directed,this._isMultigraph=!!t.has(r,"multigraph")&&r.multigraph,this._isCompound=!!t.has(r,"compound")&&r.compound,this._label=void 0,this._defaultNodeLabelFn=t.constant(void 0),this._defaultEdgeLabelFn=t.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[e]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function n(t,e){t[e]?t[e]++:t[e]=1}function o(t,e){--t[e]||delete t[e]}function i(e,r,n,o){var i=""+r,s=""+n;if(!e&&i>s){var a=i;i=s,s=a}return i+""+s+""+(t.isUndefined(o)?"\0":o)}function s(t,e){return i(t,e.v,e.w,e.name)}return r.prototype._nodeCount=0,r.prototype._edgeCount=0,r.prototype.isDirected=function(){return this._isDirected},r.prototype.isMultigraph=function(){return this._isMultigraph},r.prototype.isCompound=function(){return this._isCompound},r.prototype.setGraph=function(t){return this._label=t,this},r.prototype.graph=function(){return this._label},r.prototype.setDefaultNodeLabel=function(e){return t.isFunction(e)||(e=t.constant(e)),this._defaultNodeLabelFn=e,this},r.prototype.nodeCount=function(){return this._nodeCount},r.prototype.nodes=function(){return t.keys(this._nodes)},r.prototype.sources=function(){var e=this;return t.filter(this.nodes(),(function(r){return t.isEmpty(e._in[r])}))},r.prototype.sinks=function(){var e=this;return t.filter(this.nodes(),(function(r){return t.isEmpty(e._out[r])}))},r.prototype.setNodes=function(e,r){var n=arguments,o=this;return t.each(e,(function(t){n.length>1?o.setNode(t,r):o.setNode(t)})),this},r.prototype.setNode=function(r,n){return t.has(this._nodes,r)?(arguments.length>1&&(this._nodes[r]=n),this):(this._nodes[r]=arguments.length>1?n:this._defaultNodeLabelFn(r),this._isCompound&&(this._parent[r]=e,this._children[r]={},this._children[e][r]=!0),this._in[r]={},this._preds[r]={},this._out[r]={},this._sucs[r]={},++this._nodeCount,this)},r.prototype.node=function(t){return this._nodes[t]},r.prototype.hasNode=function(e){return t.has(this._nodes,e)},r.prototype.removeNode=function(e){var r=this;if(t.has(this._nodes,e)){var n=function(t){r.removeEdge(r._edgeObjs[t])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],t.each(this.children(e),(function(t){r.setParent(t)})),delete this._children[e]),t.each(t.keys(this._in[e]),n),delete this._in[e],delete this._preds[e],t.each(t.keys(this._out[e]),n),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},r.prototype.setParent=function(r,n){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(t.isUndefined(n))n=e;else{for(var o=n+="";!t.isUndefined(o);o=this.parent(o))if(o===r)throw new Error("Setting "+n+" as parent of "+r+" would create a cycle");this.setNode(n)}return this.setNode(r),this._removeFromParentsChildList(r),this._parent[r]=n,this._children[n][r]=!0,this},r.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},r.prototype.parent=function(t){if(this._isCompound){var r=this._parent[t];if(r!==e)return r}},r.prototype.children=function(r){if(t.isUndefined(r)&&(r=e),this._isCompound){var n=this._children[r];if(n)return t.keys(n)}else{if(r===e)return this.nodes();if(this.hasNode(r))return[]}},r.prototype.predecessors=function(e){var r=this._preds[e];if(r)return t.keys(r)},r.prototype.successors=function(e){var r=this._sucs[e];if(r)return t.keys(r)},r.prototype.neighbors=function(e){var r=this.predecessors(e);if(r)return t.union(r,this.successors(e))},r.prototype.isLeaf=function(t){return 0===(this.isDirected()?this.successors(t):this.neighbors(t)).length},r.prototype.filterNodes=function(e){var r=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});r.setGraph(this.graph());var n=this;t.each(this._nodes,(function(t,n){e(n)&&r.setNode(n,t)})),t.each(this._edgeObjs,(function(t){r.hasNode(t.v)&&r.hasNode(t.w)&&r.setEdge(t,n.edge(t))}));var o={};function i(t){var e=n.parent(t);return void 0===e||r.hasNode(e)?(o[t]=e,e):e in o?o[e]:i(e)}return this._isCompound&&t.each(r.nodes(),(function(t){r.setParent(t,i(t))})),r},r.prototype.setDefaultEdgeLabel=function(e){return t.isFunction(e)||(e=t.constant(e)),this._defaultEdgeLabelFn=e,this},r.prototype.edgeCount=function(){return this._edgeCount},r.prototype.edges=function(){return t.values(this._edgeObjs)},r.prototype.setPath=function(e,r){var n=this,o=arguments;return t.reduce(e,(function(t,e){return o.length>1?n.setEdge(t,e,r):n.setEdge(t,e),e})),this},r.prototype.setEdge=function(){var e,r,o,s,a=!1,u=arguments[0];"object"==typeof u&&null!==u&&"v"in u?(e=u.v,r=u.w,o=u.name,2===arguments.length&&(s=arguments[1],a=!0)):(e=u,r=arguments[1],o=arguments[3],arguments.length>2&&(s=arguments[2],a=!0)),e=""+e,r=""+r,t.isUndefined(o)||(o=""+o);var c=i(this._isDirected,e,r,o);if(t.has(this._edgeLabels,c))return a&&(this._edgeLabels[c]=s),this;if(!t.isUndefined(o)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(r),this._edgeLabels[c]=a?s:this._defaultEdgeLabelFn(e,r,o);var h=function(t,e,r,n){var o=""+e,i=""+r;if(!t&&o>i){var s=o;o=i,i=s}var a={v:o,w:i};n&&(a.name=n);return a}(this._isDirected,e,r,o);return e=h.v,r=h.w,Object.freeze(h),this._edgeObjs[c]=h,n(this._preds[r],e),n(this._sucs[e],r),this._in[r][c]=h,this._out[e][c]=h,this._edgeCount++,this},r.prototype.edge=function(t,e,r){var n=1===arguments.length?s(this._isDirected,arguments[0]):i(this._isDirected,t,e,r);return this._edgeLabels[n]},r.prototype.hasEdge=function(e,r,n){var o=1===arguments.length?s(this._isDirected,arguments[0]):i(this._isDirected,e,r,n);return t.has(this._edgeLabels,o)},r.prototype.removeEdge=function(t,e,r){var n=1===arguments.length?s(this._isDirected,arguments[0]):i(this._isDirected,t,e,r),a=this._edgeObjs[n];return a&&(t=a.v,e=a.w,delete this._edgeLabels[n],delete this._edgeObjs[n],o(this._preds[e],t),o(this._sucs[t],e),delete this._in[e][n],delete this._out[t][n],this._edgeCount--),this},r.prototype.inEdges=function(e,r){var n=this._in[e];if(n){var o=t.values(n);return r?t.filter(o,(function(t){return t.v===r})):o}},r.prototype.outEdges=function(e,r){var n=this._out[e];if(n){var o=t.values(n);return r?t.filter(o,(function(t){return t.w===r})):o}},r.prototype.nodeEdges=function(t,e){var r=this.inEdges(t,e);if(r)return r.concat(this.outEdges(t,e))},Jl}function sp(){if(nf)return rf;nf=1;var t=op(),e=ip();function r(e){return t.map(e.nodes(),(function(r){var n=e.node(r),o=e.parent(r),i={v:r};return t.isUndefined(n)||(i.value=n),t.isUndefined(o)||(i.parent=o),i}))}function n(e){return t.map(e.edges(),(function(r){var n=e.edge(r),o={v:r.v,w:r.w};return t.isUndefined(r.name)||(o.name=r.name),t.isUndefined(n)||(o.value=n),o}))}return rf={write:function(e){var o={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:r(e),edges:n(e)};t.isUndefined(e.graph())||(o.value=t.clone(e.graph()));return o},read:function(r){var n=new e(r.options).setGraph(r.value);return t.each(r.nodes,(function(t){n.setNode(t.v,t.value),t.parent&&n.setParent(t.v,t.parent)})),t.each(r.edges,(function(t){n.setEdge({v:t.v,w:t.w,name:t.name},t.value)})),n}}}function ap(){if(sf)return of;sf=1;var t=op();return of=function(e){var r,n={},o=[];function i(o){t.has(n,o)||(n[o]=!0,r.push(o),t.each(e.successors(o),i),t.each(e.predecessors(o),i))}return t.each(e.nodes(),(function(t){r=[],i(t),r.length&&o.push(r)})),o}}function up(){if(uf)return af;uf=1;var t=op();function e(){this._arr=[],this._keyIndices={}}return af=e,e.prototype.size=function(){return this._arr.length},e.prototype.keys=function(){return this._arr.map((function(t){return t.key}))},e.prototype.has=function(e){return t.has(this._keyIndices,e)},e.prototype.priority=function(t){var e=this._keyIndices[t];if(void 0!==e)return this._arr[e].priority},e.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},e.prototype.add=function(e,r){var n=this._keyIndices;if(e=String(e),!t.has(n,e)){var o=this._arr,i=o.length;return n[e]=i,o.push({key:e,priority:r}),this._decrease(i),!0}return!1},e.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},e.prototype.decrease=function(t,e){var r=this._keyIndices[t];if(e>this._arr[r].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[r].priority+" New: "+e);this._arr[r].priority=e,this._decrease(r)},e.prototype._heapify=function(t){var e=this._arr,r=2*t,n=r+1,o=t;r<e.length&&(o=e[r].priority<e[o].priority?r:o,n<e.length&&(o=e[n].priority<e[o].priority?n:o),o!==t&&(this._swap(t,o),this._heapify(o)))},e.prototype._decrease=function(t){for(var e,r=this._arr,n=r[t].priority;0!==t&&!(r[e=t>>1].priority<n);)this._swap(t,e),t=e},e.prototype._swap=function(t,e){var r=this._arr,n=this._keyIndices,o=r[t],i=r[e];r[t]=i,r[e]=o,n[i.key]=t,n[o.key]=e},af}function cp(){if(hf)return cf;hf=1;var t=op(),e=up();cf=function(t,n,o,i){return function(t,r,n,o){var i,s,a={},u=new e,c=function(t){var e=t.v!==i?t.v:t.w,r=a[e],o=n(t),c=s.distance+o;if(o<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+o);c<r.distance&&(r.distance=c,r.predecessor=i,u.decrease(e,c))};t.nodes().forEach((function(t){var e=t===r?0:Number.POSITIVE_INFINITY;a[t]={distance:e},u.add(t,e)}));for(;u.size()>0&&(i=u.removeMin(),(s=a[i]).distance!==Number.POSITIVE_INFINITY);)o(i).forEach(c);return a}(t,String(n),o||r,i||function(e){return t.outEdges(e)})};var r=t.constant(1);return cf}function hp(){if(lf)return df;lf=1;var t=cp(),e=op();return df=function(r,n,o){return e.transform(r.nodes(),(function(e,i){e[i]=t(r,i,n,o)}),{})}}function dp(){if(gf)return ff;gf=1;var t=op();return ff=function(e){var r=0,n=[],o={},i=[];function s(a){var u=o[a]={onStack:!0,lowlink:r,index:r++};if(n.push(a),e.successors(a).forEach((function(e){t.has(o,e)?o[e].onStack&&(u.lowlink=Math.min(u.lowlink,o[e].index)):(s(e),u.lowlink=Math.min(u.lowlink,o[e].lowlink))})),u.lowlink===u.index){var c,h=[];do{c=n.pop(),o[c].onStack=!1,h.push(c)}while(a!==c);i.push(h)}}return e.nodes().forEach((function(e){t.has(o,e)||s(e)})),i}}function lp(){if(vf)return pf;vf=1;var t=op(),e=dp();return pf=function(r){return t.filter(e(r),(function(t){return t.length>1||1===t.length&&r.hasEdge(t[0],t[0])}))}}function fp(){if(mf)return yf;mf=1;var t=op();yf=function(t,r,n){return function(t,e,r){var n={},o=t.nodes();return o.forEach((function(t){n[t]={},n[t][t]={distance:0},o.forEach((function(e){t!==e&&(n[t][e]={distance:Number.POSITIVE_INFINITY})})),r(t).forEach((function(r){var o=r.v===t?r.w:r.v,i=e(r);n[t][o]={distance:i,predecessor:t}}))})),o.forEach((function(t){var e=n[t];o.forEach((function(r){var i=n[r];o.forEach((function(r){var n=i[t],o=e[r],s=i[r],a=n.distance+o.distance;a<s.distance&&(s.distance=a,s.predecessor=o.predecessor)}))}))})),n}(t,r||e,n||function(e){return t.outEdges(e)})};var e=t.constant(1);return yf}function gp(){if(bf)return wf;bf=1;var t=op();function e(e){var n={},o={},i=[];if(t.each(e.sinks(),(function s(a){if(t.has(o,a))throw new r;t.has(n,a)||(o[a]=!0,n[a]=!0,t.each(e.predecessors(a),s),delete o[a],i.push(a))})),t.size(n)!==e.nodeCount())throw new r;return i}function r(){}return wf=e,e.CycleException=r,r.prototype=new Error,wf}function pp(){if(Ef)return xf;Ef=1;var t=gp();return xf=function(e){try{t(e)}catch(r){if(r instanceof t.CycleException)return!1;throw r}return!0}}function vp(){if(_f)return Nf;_f=1;var t=op();function e(r,n,o,i,s,a){t.has(i,n)||(i[n]=!0,o||a.push(n),t.each(s(n),(function(t){e(r,t,o,i,s,a)})),o&&a.push(n))}return Nf=function(r,n,o){t.isArray(n)||(n=[n]);var i=(r.isDirected()?r.successors:r.neighbors).bind(r),s=[],a={};return t.each(n,(function(t){if(!r.hasNode(t))throw new Error("Graph does not have node: "+t);e(r,t,"post"===o,a,i,s)})),s}}function yp(){if(kf)return Mf;kf=1;var t=vp();return Mf=function(e,r){return t(e,r,"post")}}function mp(){if(jf)return Af;jf=1;var t=vp();return Af=function(e,r){return t(e,r,"pre")}}function wp(){if(Of)return Sf;Of=1;var t=op(),e=ip(),r=up();return Sf=function(n,o){var i,s=new e,a={},u=new r;function c(t){var e=t.v===i?t.w:t.v,r=u.priority(e);if(void 0!==r){var n=o(t);n<r&&(a[e]=i,u.decrease(e,n))}}if(0===n.nodeCount())return s;t.each(n.nodes(),(function(t){u.add(t,Number.POSITIVE_INFINITY),s.setNode(t)})),u.decrease(n.nodes()[0],0);var h=!1;for(;u.size()>0;){if(i=u.removeMin(),t.has(a,i))s.setEdge(i,a[i]);else{if(h)throw new Error("Input graph is not connected: "+n);h=!0}n.nodeEdges(i).forEach(c)}return s}}try{Pf=function(){if(Cf)return If;Cf=1;var t=ef?tf:(ef=1,tf={Graph:ip(),version:Zl?Xl:(Zl=1,Xl="2.1.8")});return If={Graph:t.Graph,json:sp(),alg:Rf?zf:(Rf=1,zf={components:ap(),dijkstra:cp(),dijkstraAll:hp(),findCycles:lp(),floydWarshall:fp(),isAcyclic:pp(),postorder:yp(),preorder:mp(),prim:wp(),tarjan:dp(),topsort:gp()}),version:t.version}}()}catch(Eb){}Pf||(Pf=window.graphlib);var bp,xp,Ep,Np,_p,Mp,kp,Ap,jp,Sp,Op,zp,Rp,Ip,Cp,Pp,Dp,Tp,Fp,Lp,qp,Vp,Gp,Bp,Up,$p,Wp,Yp,Hp,Kp,Jp,Qp,Xp,Zp,tv,ev,rv,nv,ov,iv,sv,av,uv,cv,hv,dv,lv,fv,gv,pv,vv,yv,mv,wv,bv,xv,Ev,Nv,_v,Mv,kv,Av,jv,Sv,Ov,zv,Rv,Iv,Cv,Pv,Dv,Tv,Fv,Lv,qv,Vv,Gv,Bv,Uv,$v,Wv,Yv,Hv,Kv,Jv,Qv,Xv,Zv,ty,ey,ry,ny,oy,iy=Pf;function sy(){if(Np)return Ep;Np=1;var t=Zs(),e=xu(),r=Fa(),n=sa();return Ep=function(o,i,s){if(!n(s))return!1;var a=typeof i;return!!("number"==a?e(s)&&r(i,s.length):"string"==a&&i in s)&&t(s[i],o)}}function ay(){if(zp)return Op;zp=1;var t=function(){if(Sp)return jp;Sp=1;var t=/\s/;return jp=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}}(),e=/^\s+/;return Op=function(r){return r?r.slice(0,t(r)+1).replace(e,""):r}}function uy(){if(Pp)return Cp;Pp=1;var t=function(){if(Ip)return Rp;Ip=1;var t=ay(),e=sa(),r=Ng(),n=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,s=parseInt;return Rp=function(a){if("number"==typeof a)return a;if(r(a))return NaN;if(e(a)){var u="function"==typeof a.valueOf?a.valueOf():a;a=e(u)?u+"":u}if("string"!=typeof a)return 0===a?a:+a;a=t(a);var c=o.test(a);return c||i.test(a)?s(a.slice(2),c?2:8):n.test(a)?NaN:+a}}(),e=1/0;return Cp=function(r){return r?(r=t(r))===e||r===-1/0?17976931348623157e292*(r<0?-1:1):r==r?r:0:0===r?r:0}}function cy(){if(Lp)return Fp;Lp=1;var t=Qg(),e=Dg(),r=function(){if(Tp)return Dp;Tp=1;var t=uy();return Dp=function(e){var r=t(e),n=r%1;return r==r?n?r-n:r:0}}(),n=Math.max;return Fp=function(o,i,s){var a=null==o?0:o.length;if(!a)return-1;var u=null==s?0:r(s);return u<0&&(u=n(a+u,0)),t(o,e(i,3),u)}}function hy(){if(Bp)return Gp;Bp=1;var t=Yg();return Gp=function(e){return(null==e?0:e.length)?t(e,1):[]}}function dy(){if(Qp)return Jp;Qp=1;var t=Ng();return Jp=function(e,r,n){for(var o=-1,i=e.length;++o<i;){var s=e[o],a=r(s);if(null!=a&&(void 0===u?a==a&&!t(a):n(a,u)))var u=a,c=s}return c}}function ly(){if(nv)return rv;nv=1;var t=wa(),e=Zs();return rv=function(r,n,o){(void 0!==o&&!e(r[n],o)||void 0===o&&!(n in r))&&t(r,n,o)}}function fy(){if(av)return sv;return av=1,sv=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}}function gy(){if(dv)return hv;dv=1;var t=ly(),e=Tf(),r=Qf(),n=Ff(),o=tg(),i=Na(),s=_a(),a=ep(),u=Ta(),c=aa(),h=sa(),d=function(){if(iv)return ov;iv=1;var t=ia(),e=Bf(),r=Ea(),n=Function.prototype,o=Object.prototype,i=n.toString,s=o.hasOwnProperty,a=i.call(Object);return ov=function(n){if(!r(n)||"[object Object]"!=t(n))return!1;var o=e(n);if(null===o)return!0;var u=s.call(o,"constructor")&&o.constructor;return"function"==typeof u&&u instanceof u&&i.call(u)==a}}(),l=vu(),f=fy(),g=function(){if(cv)return uv;cv=1;var t=xa(),e=_u();return uv=function(r){return t(r,e(r))}}();return hv=function(p,v,y,m,w,b,x){var E=f(p,y),N=f(v,y),_=x.get(N);if(_)t(p,y,_);else{var M=b?b(E,N,y+"",p,v,x):void 0,k=void 0===M;if(k){var A=s(N),j=!A&&u(N),S=!A&&!j&&l(N);M=N,A||j||S?s(E)?M=E:a(E)?M=n(E):j?(k=!1,M=e(N,!0)):S?(k=!1,M=r(N,!0)):M=[]:d(N)||i(N)?(M=E,i(E)?M=g(E):h(E)&&!c(E)||(M=o(N))):k=!1}k&&(x.set(N,M),w(M,N,m,b,x),x.delete(N)),t(p,y,M)}}}function py(){if(wv)return mv;return wv=1,mv=function(t,e){return t<e}}function vy(){if(Sv)return jv;Sv=1;var t=Og(),e=function(){if(Av)return kv;Av=1;var t=ba(),e=jg(),r=Fa(),n=sa(),o=Sg();return kv=function(i,s,a,u){if(!n(i))return i;for(var c=-1,h=(s=e(s,i)).length,d=h-1,l=i;null!=l&&++c<h;){var f=o(s[c]),g=a;if("__proto__"===f||"constructor"===f||"prototype"===f)return i;if(c!=d){var p=l[f];void 0===(g=u?u(p,f,l):void 0)&&(g=n(p)?p:r(s[c+1])?[]:{})}t(l,f,g),l=l[f]}return i}}(),r=jg();return jv=function(n,o,i){for(var s=-1,a=o.length,u={};++s<a;){var c=o[s],h=t(n,c);i(h,c)&&e(u,r(c,n),h)}return u}}function yy(){if(Lv)return Fv;Lv=1;var t=function(){if(Tv)return Dv;Tv=1;var t=Math.ceil,e=Math.max;return Dv=function(r,n,o,i){for(var s=-1,a=e(t((n-r)/(o||1)),0),u=Array(a);a--;)u[i?a:++s]=r,r+=o;return u}}(),e=sy(),r=uy();return Fv=function(n){return function(o,i,s){return s&&"number"!=typeof s&&e(o,i,s)&&(i=s=void 0),o=r(o),void 0===i?(i=o,o=0):i=r(i),s=void 0===s?o<i?1:-1:r(s),t(o,i,s,n)}}}function my(){if(Yv)return Wv;Yv=1;var t=function(){if($v)return Uv;$v=1;var t=Ng();return Uv=function(e,r){if(e!==r){var n=void 0!==e,o=null===e,i=e==e,s=t(e),a=void 0!==r,u=null===r,c=r==r,h=t(r);if(!u&&!h&&!s&&e>r||s&&a&&c&&!u&&!h||o&&a&&c||!n&&c||!i)return 1;if(!o&&!s&&!h&&e<r||h&&n&&i&&!o&&!s||u&&n&&i||!a&&i||!c)return-1}return 0}}();return Wv=function(e,r,n){for(var o=-1,i=e.criteria,s=r.criteria,a=i.length,u=n.length;++o<a;){var c=t(i[o],s[o]);if(c)return o>=u?c:c*("desc"==n[o]?-1:1)}return e.index-r.index}}function wy(){if(Kv)return Hv;Kv=1;var t=kg(),e=Og(),r=Dg(),n=Vg(),o=Bv?Gv:(Bv=1,Gv=function(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}),i=qa(),s=my(),a=cg(),u=_a();return Hv=function(c,h,d){h=h.length?t(h,(function(t){return u(t)?function(r){return e(r,1===t.length?t[0]:t)}:t})):[a];var l=-1;h=t(h,i(r));var f=n(c,(function(e,r,n){return{criteria:t(h,(function(t){return t(e)})),index:++l,value:e}}));return o(f,(function(t,e){return s(t,e,d)}))}}try{oy={cloneDeep:function(){if(xp)return bp;xp=1;var t=ng();return bp=function(e){return t(e,5)}}(),constant:ig(),defaults:function(){if(Mp)return _p;Mp=1;var t=Jg(),e=Zs(),r=sy(),n=_u(),o=Object.prototype,i=o.hasOwnProperty,s=t((function(t,s){t=Object(t);var a=-1,u=s.length,c=u>2?s[2]:void 0;for(c&&r(s[0],s[1],c)&&(u=1);++a<u;)for(var h=s[a],d=n(h),l=-1,f=d.length;++l<f;){var g=d[l],p=t[g];(void 0===p||e(p,o[g])&&!i.call(t,g))&&(t[g]=h[g])}return t}));return _p=s}(),each:lg(),filter:Tg(),find:function(){if(Vp)return qp;Vp=1;var t=function(){if(Ap)return kp;Ap=1;var t=Dg(),e=xu(),r=Eu();return kp=function(n){return function(o,i,s){var a=Object(o);if(!e(o)){var u=t(i,3);o=r(o),i=function(t){return u(a[t],t,a)}}var c=n(o,i,s);return c>-1?a[u?o[c]:c]:void 0}}}()(cy());return qp=t}(),flatten:hy(),forEach:dg(),forIn:function(){if($p)return Up;$p=1;var t=sg(),e=hg(),r=_u();return Up=function(n,o){return null==n?n:t(n,e(o),r)}}(),has:Fg(),isUndefined:qg(),last:Yp?Wp:(Yp=1,Wp=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}),map:Gg(),mapValues:function(){if(Kp)return Hp;Kp=1;var t=wa(),e=ag(),r=Dg();return Hp=function(n,o){var i={};return o=r(o,3),e(n,(function(e,r,n){t(i,r,o(e,r,n))})),i}}(),max:function(){if(ev)return tv;ev=1;var t=dy(),e=Zp?Xp:(Zp=1,Xp=function(t,e){return t>e}),r=cg();return tv=function(n){return n&&n.length?t(n,r,e):void 0}}(),merge:function(){if(yv)return vv;yv=1;var t=function(){if(fv)return lv;fv=1;var t=va(),e=ly(),r=sg(),n=gy(),o=sa(),i=_u(),s=fy();return lv=function a(u,c,h,d,l){u!==c&&r(c,(function(r,i){if(l||(l=new t),o(r))n(u,c,i,h,a,d,l);else{var f=d?d(s(u,i),r,i+"",u,c,l):void 0;void 0===f&&(f=r),e(u,i,f)}}),i)},lv}(),e=function(){if(pv)return gv;pv=1;var t=Jg(),e=sy();return gv=function(r){return t((function(t,n){var o=-1,i=n.length,s=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(s=r.length>3&&"function"==typeof s?(i--,s):void 0,a&&e(n[0],n[1],a)&&(s=i<3?void 0:s,i=1),t=Object(t);++o<i;){var u=n[o];u&&r(t,u,o,s)}return t}))}}()((function(e,r,n){t(e,r,n)}));return vv=e}(),min:function(){if(xv)return bv;xv=1;var t=dy(),e=py(),r=cg();return bv=function(n){return n&&n.length?t(n,r,e):void 0}}(),minBy:function(){if(Nv)return Ev;Nv=1;var t=dy(),e=Dg(),r=py();return Ev=function(n,o){return n&&n.length?t(n,e(o,2),r):void 0}}(),now:function(){if(Mv)return _v;Mv=1;var t=na();return _v=function(){return t.Date.now()}}(),pick:function(){if(Pv)return Cv;Pv=1;var t=function(){if(zv)return Ov;zv=1;var t=vy(),e=Rg();return Ov=function(r,n){return t(r,n,(function(t,n){return e(r,n)}))}}(),e=function(){if(Iv)return Rv;Iv=1;var t=hy(),e=Hg(),r=Kg();return Rv=function(n){return r(e(n,void 0,t),n+"")}}()((function(e,r){return null==e?{}:t(e,r)}));return Cv=e}(),range:function(){if(Vv)return qv;Vv=1;var t=yy()();return qv=t}(),reduce:Bg(),sortBy:function(){if(Qv)return Jv;Qv=1;var t=Yg(),e=wy(),r=Jg(),n=sy(),o=r((function(r,o){if(null==r)return[];var i=o.length;return i>1&&n(r,o[0],o[1])?o=[]:i>2&&n(o[0],o[1],o[2])&&(o=[o[0]]),e(r,t(o,1),[])}));return Jv=o}(),uniqueId:function(){if(Zv)return Xv;Zv=1;var t=Ag(),e=0;return Xv=function(r){var n=++e;return t(r)+n}}(),values:np(),zipObject:function(){if(ny)return ry;ny=1;var t=ba(),e=ey?ty:(ey=1,ty=function(t,e,r){for(var n=-1,o=t.length,i=e.length,s={};++n<o;){var a=n<i?e[n]:void 0;r(s,t[n],a)}return s});return ry=function(r,n){return e(r||[],n||[],t)}}()}}catch(Eb){}oy||(oy=window._);var by=oy,xy=Ey;function Ey(){var t={};t._next=t._prev=t,this._sentinel=t}function Ny(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function _y(t,e){if("_next"!==t&&"_prev"!==t)return e}Ey.prototype.dequeue=function(){var t=this._sentinel,e=t._prev;if(e!==t)return Ny(e),e},Ey.prototype.enqueue=function(t){var e=this._sentinel;t._prev&&t._next&&Ny(t),t._next=e._next,e._next._prev=t,e._next=t,t._prev=e},Ey.prototype.toString=function(){for(var t=[],e=this._sentinel,r=e._prev;r!==e;)t.push(JSON.stringify(r,_y)),r=r._prev;return"["+t.join(", ")+"]"};var My=by,ky=iy.Graph,Ay=xy,jy=function(t,e){if(t.nodeCount()<=1)return[];var r=function(t,e){var r=new ky,n=0,o=0;My.forEach(t.nodes(),(function(t){r.setNode(t,{v:t,in:0,out:0})})),My.forEach(t.edges(),(function(t){var i=r.edge(t.v,t.w)||0,s=e(t),a=i+s;r.setEdge(t.v,t.w,a),o=Math.max(o,r.node(t.v).out+=s),n=Math.max(n,r.node(t.w).in+=s)}));var i=My.range(o+n+3).map((function(){return new Ay})),s=n+1;return My.forEach(r.nodes(),(function(t){zy(i,s,r.node(t))})),{graph:r,buckets:i,zeroIdx:s}}(t,e||Sy),n=function(t,e,r){var n,o=[],i=e[e.length-1],s=e[0];for(;t.nodeCount();){for(;n=s.dequeue();)Oy(t,e,r,n);for(;n=i.dequeue();)Oy(t,e,r,n);if(t.nodeCount())for(var a=e.length-2;a>0;--a)if(n=e[a].dequeue()){o=o.concat(Oy(t,e,r,n,!0));break}}return o}(r.graph,r.buckets,r.zeroIdx);return My.flatten(My.map(n,(function(e){return t.outEdges(e.v,e.w)})),!0)},Sy=My.constant(1);function Oy(t,e,r,n,o){var i=o?[]:void 0;return My.forEach(t.inEdges(n.v),(function(n){var s=t.edge(n),a=t.node(n.v);o&&i.push({v:n.v,w:n.w}),a.out-=s,zy(e,r,a)})),My.forEach(t.outEdges(n.v),(function(n){var o=t.edge(n),i=n.w,s=t.node(i);s.in-=o,zy(e,r,s)})),t.removeNode(n.v),i}function zy(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)}var Ry=by,Iy=jy,Cy={run:function(t){var e="greedy"===t.graph().acyclicer?Iy(t,(r=t,function(t){return r.edge(t).weight})):function(t){var e=[],r={},n={};function o(i){Ry.has(n,i)||(n[i]=!0,r[i]=!0,Ry.forEach(t.outEdges(i),(function(t){Ry.has(r,t.w)?e.push(t):o(t.w)})),delete r[i])}return Ry.forEach(t.nodes(),o),e}(t);var r;Ry.forEach(e,(function(e){var r=t.edge(e);t.removeEdge(e),r.forwardName=e.name,r.reversed=!0,t.setEdge(e.w,e.v,r,Ry.uniqueId("rev"))}))},undo:function(t){Ry.forEach(t.edges(),(function(e){var r=t.edge(e);if(r.reversed){t.removeEdge(e);var n=r.forwardName;delete r.reversed,delete r.forwardName,t.setEdge(e.w,e.v,r,n)}}))}};var Py=by,Dy=iy.Graph,Ty={addDummyNode:Fy,simplify:function(t){var e=(new Dy).setGraph(t.graph());return Py.forEach(t.nodes(),(function(r){e.setNode(r,t.node(r))})),Py.forEach(t.edges(),(function(r){var n=e.edge(r.v,r.w)||{weight:0,minlen:1},o=t.edge(r);e.setEdge(r.v,r.w,{weight:n.weight+o.weight,minlen:Math.max(n.minlen,o.minlen)})})),e},asNonCompoundGraph:function(t){var e=new Dy({multigraph:t.isMultigraph()}).setGraph(t.graph());return Py.forEach(t.nodes(),(function(r){t.children(r).length||e.setNode(r,t.node(r))})),Py.forEach(t.edges(),(function(r){e.setEdge(r,t.edge(r))})),e},successorWeights:function(t){var e=Py.map(t.nodes(),(function(e){var r={};return Py.forEach(t.outEdges(e),(function(e){r[e.w]=(r[e.w]||0)+t.edge(e).weight})),r}));return Py.zipObject(t.nodes(),e)},predecessorWeights:function(t){var e=Py.map(t.nodes(),(function(e){var r={};return Py.forEach(t.inEdges(e),(function(e){r[e.v]=(r[e.v]||0)+t.edge(e).weight})),r}));return Py.zipObject(t.nodes(),e)},intersectRect:function(t,e){var r,n,o=t.x,i=t.y,s=e.x-o,a=e.y-i,u=t.width/2,c=t.height/2;if(!s&&!a)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(a)*u>Math.abs(s)*c?(a<0&&(c=-c),r=c*s/a,n=c):(s<0&&(u=-u),r=u,n=u*a/s);return{x:o+r,y:i+n}},buildLayerMatrix:function(t){var e=Py.map(Py.range(Ly(t)+1),(function(){return[]}));return Py.forEach(t.nodes(),(function(r){var n=t.node(r),o=n.rank;Py.isUndefined(o)||(e[o][n.order]=r)})),e},normalizeRanks:function(t){var e=Py.min(Py.map(t.nodes(),(function(e){return t.node(e).rank})));Py.forEach(t.nodes(),(function(r){var n=t.node(r);Py.has(n,"rank")&&(n.rank-=e)}))},removeEmptyRanks:function(t){var e=Py.min(Py.map(t.nodes(),(function(e){return t.node(e).rank}))),r=[];Py.forEach(t.nodes(),(function(n){var o=t.node(n).rank-e;r[o]||(r[o]=[]),r[o].push(n)}));var n=0,o=t.graph().nodeRankFactor;Py.forEach(r,(function(e,r){Py.isUndefined(e)&&r%o!==0?--n:n&&Py.forEach(e,(function(e){t.node(e).rank+=n}))}))},addBorderNode:function(t,e,r,n){var o={width:0,height:0};arguments.length>=4&&(o.rank=r,o.order=n);return Fy(t,"border",o,e)},maxRank:Ly,partition:function(t,e){var r={lhs:[],rhs:[]};return Py.forEach(t,(function(t){e(t)?r.lhs.push(t):r.rhs.push(t)})),r},time:function(t,e){Py.now();try{return e()}finally{}},notime:function(t,e){return e()}};function Fy(t,e,r,n){var o;do{o=Py.uniqueId(n)}while(t.hasNode(o));return r.dummy=e,t.setNode(o,r),o}function Ly(t){return Py.max(Py.map(t.nodes(),(function(e){var r=t.node(e).rank;if(!Py.isUndefined(r))return r})))}var qy=by,Vy=Ty,Gy={run:function(t){t.graph().dummyChains=[],qy.forEach(t.edges(),(function(e){!function(t,e){var r,n,o,i=e.v,s=t.node(i).rank,a=e.w,u=t.node(a).rank,c=e.name,h=t.edge(e),d=h.labelRank;if(u===s+1)return;for(t.removeEdge(e),o=0,++s;s<u;++o,++s)h.points=[],n={width:0,height:0,edgeLabel:h,edgeObj:e,rank:s},r=Vy.addDummyNode(t,"edge",n,"_d"),s===d&&(n.width=h.width,n.height=h.height,n.dummy="edge-label",n.labelpos=h.labelpos),t.setEdge(i,r,{weight:h.weight},c),0===o&&t.graph().dummyChains.push(r),i=r;t.setEdge(i,a,{weight:h.weight},c)}(t,e)}))},undo:function(t){qy.forEach(t.graph().dummyChains,(function(e){var r,n=t.node(e),o=n.edgeLabel;for(t.setEdge(n.edgeObj,o);n.dummy;)r=t.successors(e)[0],t.removeNode(e),o.points.push({x:n.x,y:n.y}),"edge-label"===n.dummy&&(o.x=n.x,o.y=n.y,o.width=n.width,o.height=n.height),e=r,n=t.node(e)}))}};var By=by,Uy={longestPath:function(t){var e={};By.forEach(t.sources(),(function r(n){var o=t.node(n);if(By.has(e,n))return o.rank;e[n]=!0;var i=By.min(By.map(t.outEdges(n),(function(e){return r(e.w)-t.edge(e).minlen})));return i!==Number.POSITIVE_INFINITY&&null!=i||(i=0),o.rank=i}))},slack:function(t,e){return t.node(e.w).rank-t.node(e.v).rank-t.edge(e).minlen}};var $y=by,Wy=iy.Graph,Yy=Uy.slack,Hy=function(t){var e,r,n=new Wy({directed:!1}),o=t.nodes()[0],i=t.nodeCount();n.setNode(o,{});for(;Ky(n,t)<i;)e=Jy(n,t),r=n.hasNode(e.v)?Yy(t,e):-Yy(t,e),Qy(n,t,r);return n};function Ky(t,e){return $y.forEach(t.nodes(),(function r(n){$y.forEach(e.nodeEdges(n),(function(o){var i=o.v,s=n===i?o.w:i;t.hasNode(s)||Yy(e,o)||(t.setNode(s,{}),t.setEdge(n,s,{}),r(s))}))})),t.nodeCount()}function Jy(t,e){return $y.minBy(e.edges(),(function(r){if(t.hasNode(r.v)!==t.hasNode(r.w))return Yy(e,r)}))}function Qy(t,e,r){$y.forEach(t.nodes(),(function(t){e.node(t).rank+=r}))}var Xy=by,Zy=Hy,tm=Uy.slack,em=Uy.longestPath,rm=iy.alg.preorder,nm=iy.alg.postorder,om=Ty.simplify,im=sm;function sm(t){t=om(t),em(t);var e,r=Zy(t);for(cm(r),am(r,t);e=dm(r);)fm(r,t,e,lm(r,t,e))}function am(t,e){var r=nm(t,t.nodes());r=r.slice(0,r.length-1),Xy.forEach(r,(function(r){!function(t,e,r){var n=t.node(r),o=n.parent;t.edge(r,o).cutvalue=um(t,e,r)}(t,e,r)}))}function um(t,e,r){var n=t.node(r).parent,o=!0,i=e.edge(r,n),s=0;return i||(o=!1,i=e.edge(n,r)),s=i.weight,Xy.forEach(e.nodeEdges(r),(function(i){var a,u,c=i.v===r,h=c?i.w:i.v;if(h!==n){var d=c===o,l=e.edge(i).weight;if(s+=d?l:-l,a=r,u=h,t.hasEdge(a,u)){var f=t.edge(r,h).cutvalue;s+=d?-f:f}}})),s}function cm(t,e){arguments.length<2&&(e=t.nodes()[0]),hm(t,{},1,e)}function hm(t,e,r,n,o){var i=r,s=t.node(n);return e[n]=!0,Xy.forEach(t.neighbors(n),(function(o){Xy.has(e,o)||(r=hm(t,e,r,o,n))})),s.low=i,s.lim=r++,o?s.parent=o:delete s.parent,r}function dm(t){return Xy.find(t.edges(),(function(e){return t.edge(e).cutvalue<0}))}function lm(t,e,r){var n=r.v,o=r.w;e.hasEdge(n,o)||(n=r.w,o=r.v);var i=t.node(n),s=t.node(o),a=i,u=!1;i.lim>s.lim&&(a=s,u=!0);var c=Xy.filter(e.edges(),(function(e){return u===gm(t,t.node(e.v),a)&&u!==gm(t,t.node(e.w),a)}));return Xy.minBy(c,(function(t){return tm(e,t)}))}function fm(t,e,r,n){var o=r.v,i=r.w;t.removeEdge(o,i),t.setEdge(n.v,n.w,{}),cm(t),am(t,e),function(t,e){var r=Xy.find(t.nodes(),(function(t){return!e.node(t).parent})),n=rm(t,r);n=n.slice(1),Xy.forEach(n,(function(r){var n=t.node(r).parent,o=e.edge(r,n),i=!1;o||(o=e.edge(n,r),i=!0),e.node(r).rank=e.node(n).rank+(i?o.minlen:-o.minlen)}))}(t,e)}function gm(t,e,r){return r.low<=e.lim&&e.lim<=r.lim}sm.initLowLimValues=cm,sm.initCutValues=am,sm.calcCutValue=um,sm.leaveEdge=dm,sm.enterEdge=lm,sm.exchangeEdges=fm;var pm=Uy.longestPath,vm=Hy,ym=im,mm=function(t){switch(t.graph().ranker){case"network-simplex":default:bm(t);break;case"tight-tree":!function(t){pm(t),vm(t)}(t);break;case"longest-path":wm(t)}};var wm=pm;function bm(t){ym(t)}var xm=by,Em=function(t){var e=function(t){var e={},r=0;function n(o){var i=r;xm.forEach(t.children(o),n),e[o]={low:i,lim:r++}}return xm.forEach(t.children(),n),e}(t);xm.forEach(t.graph().dummyChains,(function(r){for(var n=t.node(r),o=n.edgeObj,i=function(t,e,r,n){var o,i,s=[],a=[],u=Math.min(e[r].low,e[n].low),c=Math.max(e[r].lim,e[n].lim);o=r;do{o=t.parent(o),s.push(o)}while(o&&(e[o].low>u||c>e[o].lim));i=o,o=n;for(;(o=t.parent(o))!==i;)a.push(o);return{path:s.concat(a.reverse()),lca:i}}(t,e,o.v,o.w),s=i.path,a=i.lca,u=0,c=s[u],h=!0;r!==o.w;){if(n=t.node(r),h){for(;(c=s[u])!==a&&t.node(c).maxRank<n.rank;)u++;c===a&&(h=!1)}if(!h){for(;u<s.length-1&&t.node(c=s[u+1]).minRank<=n.rank;)u++;c=s[u]}t.setParent(r,c),r=t.successors(r)[0]}}))};var Nm=by,_m=Ty,Mm={run:function(t){var e=_m.addDummyNode(t,"root",{},"_root"),r=function(t){var e={};function r(n,o){var i=t.children(n);i&&i.length&&Nm.forEach(i,(function(t){r(t,o+1)})),e[n]=o}return Nm.forEach(t.children(),(function(t){r(t,1)})),e}(t),n=Nm.max(Nm.values(r))-1,o=2*n+1;t.graph().nestingRoot=e,Nm.forEach(t.edges(),(function(e){t.edge(e).minlen*=o}));var i=function(t){return Nm.reduce(t.edges(),(function(e,r){return e+t.edge(r).weight}),0)}(t)+1;Nm.forEach(t.children(),(function(s){km(t,e,o,i,n,r,s)})),t.graph().nodeRankFactor=o},cleanup:function(t){var e=t.graph();t.removeNode(e.nestingRoot),delete e.nestingRoot,Nm.forEach(t.edges(),(function(e){t.edge(e).nestingEdge&&t.removeEdge(e)}))}};function km(t,e,r,n,o,i,s){var a=t.children(s);if(a.length){var u=_m.addBorderNode(t,"_bt"),c=_m.addBorderNode(t,"_bb"),h=t.node(s);t.setParent(u,s),h.borderTop=u,t.setParent(c,s),h.borderBottom=c,Nm.forEach(a,(function(a){km(t,e,r,n,o,i,a);var h=t.node(a),d=h.borderTop?h.borderTop:a,l=h.borderBottom?h.borderBottom:a,f=h.borderTop?n:2*n,g=d!==l?1:o-i[s]+1;t.setEdge(u,d,{weight:f,minlen:g,nestingEdge:!0}),t.setEdge(l,c,{weight:f,minlen:g,nestingEdge:!0})})),t.parent(s)||t.setEdge(e,u,{weight:0,minlen:o+i[s]})}else s!==e&&t.setEdge(e,s,{weight:0,minlen:r})}var Am=by,jm=Ty,Sm=function(t){Am.forEach(t.children(),(function e(r){var n=t.children(r),o=t.node(r);if(n.length&&Am.forEach(n,e),Am.has(o,"minRank")){o.borderLeft=[],o.borderRight=[];for(var i=o.minRank,s=o.maxRank+1;i<s;++i)Om(t,"borderLeft","_bl",r,o,i),Om(t,"borderRight","_br",r,o,i)}}))};function Om(t,e,r,n,o,i){var s={width:0,height:0,rank:i,borderType:e},a=o[e][i-1],u=jm.addDummyNode(t,"border",s,r);o[e][i]=u,t.setParent(u,n),a&&t.setEdge(a,u,{weight:1})}var zm=by,Rm={adjust:function(t){var e=t.graph().rankdir.toLowerCase();"lr"!==e&&"rl"!==e||Im(t)},undo:function(t){var e=t.graph().rankdir.toLowerCase();"bt"!==e&&"rl"!==e||function(t){zm.forEach(t.nodes(),(function(e){Pm(t.node(e))})),zm.forEach(t.edges(),(function(e){var r=t.edge(e);zm.forEach(r.points,Pm),zm.has(r,"y")&&Pm(r)}))}(t);"lr"!==e&&"rl"!==e||(!function(t){zm.forEach(t.nodes(),(function(e){Dm(t.node(e))})),zm.forEach(t.edges(),(function(e){var r=t.edge(e);zm.forEach(r.points,Dm),zm.has(r,"x")&&Dm(r)}))}(t),Im(t))}};function Im(t){zm.forEach(t.nodes(),(function(e){Cm(t.node(e))})),zm.forEach(t.edges(),(function(e){Cm(t.edge(e))}))}function Cm(t){var e=t.width;t.width=t.height,t.height=e}function Pm(t){t.y=-t.y}function Dm(t){var e=t.x;t.x=t.y,t.y=e}var Tm=by,Fm=function(t){var e={},r=Tm.filter(t.nodes(),(function(e){return!t.children(e).length})),n=Tm.max(Tm.map(r,(function(e){return t.node(e).rank}))),o=Tm.map(Tm.range(n+1),(function(){return[]}));var i=Tm.sortBy(r,(function(e){return t.node(e).rank}));return Tm.forEach(i,(function r(n){if(Tm.has(e,n))return;e[n]=!0;var i=t.node(n);o[i.rank].push(n),Tm.forEach(t.successors(n),r)})),o};var Lm=by,qm=function(t,e){for(var r=0,n=1;n<e.length;++n)r+=Vm(t,e[n-1],e[n]);return r};function Vm(t,e,r){for(var n=Lm.zipObject(r,Lm.map(r,(function(t,e){return e}))),o=Lm.flatten(Lm.map(e,(function(e){return Lm.sortBy(Lm.map(t.outEdges(e),(function(e){return{pos:n[e.w],weight:t.edge(e).weight}})),"pos")})),!0),i=1;i<r.length;)i<<=1;var s=2*i-1;i-=1;var a=Lm.map(new Array(s),(function(){return 0})),u=0;return Lm.forEach(o.forEach((function(t){var e=t.pos+i;a[e]+=t.weight;for(var r=0;e>0;)e%2&&(r+=a[e+1]),a[e=e-1>>1]+=t.weight;u+=t.weight*r}))),u}var Gm=by;var Bm=by;var Um=by,$m=Ty;function Wm(t,e,r){for(var n;e.length&&(n=Um.last(e)).i<=r;)e.pop(),t.push(n.vs),r++;return r}var Ym=by,Hm=function(t,e){return Gm.map(e,(function(e){var r=t.inEdges(e);if(r.length){var n=Gm.reduce(r,(function(e,r){var n=t.edge(r),o=t.node(r.v);return{sum:e.sum+n.weight*o.order,weight:e.weight+n.weight}}),{sum:0,weight:0});return{v:e,barycenter:n.sum/n.weight,weight:n.weight}}return{v:e}}))},Km=function(t,e){var r={};return Bm.forEach(t,(function(t,e){var n=r[t.v]={indegree:0,in:[],out:[],vs:[t.v],i:e};Bm.isUndefined(t.barycenter)||(n.barycenter=t.barycenter,n.weight=t.weight)})),Bm.forEach(e.edges(),(function(t){var e=r[t.v],n=r[t.w];Bm.isUndefined(e)||Bm.isUndefined(n)||(n.indegree++,e.out.push(r[t.w]))})),function(t){var e=[];function r(t){return function(e){e.merged||(Bm.isUndefined(e.barycenter)||Bm.isUndefined(t.barycenter)||e.barycenter>=t.barycenter)&&function(t,e){var r=0,n=0;t.weight&&(r+=t.barycenter*t.weight,n+=t.weight);e.weight&&(r+=e.barycenter*e.weight,n+=e.weight);t.vs=e.vs.concat(t.vs),t.barycenter=r/n,t.weight=n,t.i=Math.min(e.i,t.i),e.merged=!0}(t,e)}}function n(e){return function(r){r.in.push(e),0===--r.indegree&&t.push(r)}}for(;t.length;){var o=t.pop();e.push(o),Bm.forEach(o.in.reverse(),r(o)),Bm.forEach(o.out,n(o))}return Bm.map(Bm.filter(e,(function(t){return!t.merged})),(function(t){return Bm.pick(t,["vs","i","barycenter","weight"])}))}(Bm.filter(r,(function(t){return!t.indegree})))},Jm=function(t,e){var r=$m.partition(t,(function(t){return Um.has(t,"barycenter")})),n=r.lhs,o=Um.sortBy(r.rhs,(function(t){return-t.i})),i=[],s=0,a=0,u=0;n.sort((c=!!e,function(t,e){return t.barycenter<e.barycenter?-1:t.barycenter>e.barycenter?1:c?e.i-t.i:t.i-e.i})),u=Wm(i,o,u),Um.forEach(n,(function(t){u+=t.vs.length,i.push(t.vs),s+=t.barycenter*t.weight,a+=t.weight,u=Wm(i,o,u)}));var c;var h={vs:Um.flatten(i,!0)};a&&(h.barycenter=s/a,h.weight=a);return h},Qm=function t(e,r,n,o){var i=e.children(r),s=e.node(r),a=s?s.borderLeft:void 0,u=s?s.borderRight:void 0,c={};a&&(i=Ym.filter(i,(function(t){return t!==a&&t!==u})));var h=Hm(e,i);Ym.forEach(h,(function(r){if(e.children(r.v).length){var i=t(e,r.v,n,o);c[r.v]=i,Ym.has(i,"barycenter")&&(s=r,a=i,Ym.isUndefined(s.barycenter)?(s.barycenter=a.barycenter,s.weight=a.weight):(s.barycenter=(s.barycenter*s.weight+a.barycenter*a.weight)/(s.weight+a.weight),s.weight+=a.weight))}var s,a}));var d=Km(h,n);!function(t,e){Ym.forEach(t,(function(t){t.vs=Ym.flatten(t.vs.map((function(t){return e[t]?e[t].vs:t})),!0)}))}(d,c);var l=Jm(d,o);if(a&&(l.vs=Ym.flatten([a,l.vs,u],!0),e.predecessors(a).length)){var f=e.node(e.predecessors(a)[0]),g=e.node(e.predecessors(u)[0]);Ym.has(l,"barycenter")||(l.barycenter=0,l.weight=0),l.barycenter=(l.barycenter*l.weight+f.order+g.order)/(l.weight+2),l.weight+=2}return l};var Xm=by,Zm=iy.Graph;var tw=by;var ew=by,rw=Fm,nw=qm,ow=Qm,iw=function(t,e,r){var n=function(t){var e;for(;t.hasNode(e=Xm.uniqueId("_root")););return e}(t),o=new Zm({compound:!0}).setGraph({root:n}).setDefaultNodeLabel((function(e){return t.node(e)}));return Xm.forEach(t.nodes(),(function(i){var s=t.node(i),a=t.parent(i);(s.rank===e||s.minRank<=e&&e<=s.maxRank)&&(o.setNode(i),o.setParent(i,a||n),Xm.forEach(t[r](i),(function(e){var r=e.v===i?e.w:e.v,n=o.edge(r,i),s=Xm.isUndefined(n)?0:n.weight;o.setEdge(r,i,{weight:t.edge(e).weight+s})})),Xm.has(s,"minRank")&&o.setNode(i,{borderLeft:s.borderLeft[e],borderRight:s.borderRight[e]}))})),o},sw=function(t,e,r){var n,o={};tw.forEach(r,(function(r){for(var i,s,a=t.parent(r);a;){if((i=t.parent(a))?(s=o[i],o[i]=a):(s=n,n=a),s&&s!==a)return void e.setEdge(s,a);a=i}}))},aw=iy.Graph,uw=Ty,cw=function(t){var e=uw.maxRank(t),r=hw(t,ew.range(1,e+1),"inEdges"),n=hw(t,ew.range(e-1,-1,-1),"outEdges"),o=rw(t);lw(t,o);for(var i,s=Number.POSITIVE_INFINITY,a=0,u=0;u<4;++a,++u){dw(a%2?r:n,a%4>=2),o=uw.buildLayerMatrix(t);var c=nw(t,o);c<s&&(u=0,i=ew.cloneDeep(o),s=c)}lw(t,i)};function hw(t,e,r){return ew.map(e,(function(e){return iw(t,e,r)}))}function dw(t,e){var r=new aw;ew.forEach(t,(function(t){var n=t.graph().root,o=ow(t,n,r,e);ew.forEach(o.vs,(function(e,r){t.node(e).order=r})),sw(t,r,o.vs)}))}function lw(t,e){ew.forEach(e,(function(e){ew.forEach(e,(function(e,r){t.node(e).order=r}))}))}var fw=by,gw=iy.Graph,pw=Ty;function vw(t,e,r){if(e>r){var n=e;e=r,r=n}var o=t[e];o||(t[e]=o={}),o[r]=!0}function yw(t,e,r){if(e>r){var n=e;e=r,r=n}return fw.has(t[e],r)}var mw=by,ww=Ty,bw=function(t){var e,r=pw.buildLayerMatrix(t),n=fw.merge(function(t,e){var r={};function n(e,n){var o=0,i=0,s=e.length,a=fw.last(n);return fw.forEach(n,(function(e,u){var c=function(t,e){if(t.node(e).dummy)return fw.find(t.predecessors(e),(function(e){return t.node(e).dummy}))}(t,e),h=c?t.node(c).order:s;(c||e===a)&&(fw.forEach(n.slice(i,u+1),(function(e){fw.forEach(t.predecessors(e),(function(n){var i=t.node(n),s=i.order;!(s<o||h<s)||i.dummy&&t.node(e).dummy||vw(r,n,e)}))})),i=u+1,o=h)})),n}return fw.reduce(e,n),r}(t,r),function(t,e){var r={};function n(e,n,o,i,s){var a;fw.forEach(fw.range(n,o),(function(n){a=e[n],t.node(a).dummy&&fw.forEach(t.predecessors(a),(function(e){var n=t.node(e);n.dummy&&(n.order<i||n.order>s)&&vw(r,e,a)}))}))}function o(e,r){var o,i=-1,s=0;return fw.forEach(r,(function(a,u){if("border"===t.node(a).dummy){var c=t.predecessors(a);c.length&&(o=t.node(c[0]).order,n(r,s,u,i,o),s=u,i=o)}n(r,s,r.length,o,e.length)})),r}return fw.reduce(e,o),r}(t,r)),o={};fw.forEach(["u","d"],(function(i){e="u"===i?r:fw.values(r).reverse(),fw.forEach(["l","r"],(function(r){"r"===r&&(e=fw.map(e,(function(t){return fw.values(t).reverse()})));var s=("u"===i?t.predecessors:t.successors).bind(t),a=function(t,e,r,n){var o={},i={},s={};return fw.forEach(e,(function(t){fw.forEach(t,(function(t,e){o[t]=t,i[t]=t,s[t]=e}))})),fw.forEach(e,(function(t){var e=-1;fw.forEach(t,(function(t){var a=n(t);if(a.length)for(var u=((a=fw.sortBy(a,(function(t){return s[t]}))).length-1)/2,c=Math.floor(u),h=Math.ceil(u);c<=h;++c){var d=a[c];i[t]===t&&e<s[d]&&!yw(r,t,d)&&(i[d]=t,i[t]=o[t]=o[d],e=s[d])}}))})),{root:o,align:i}}(0,e,n,s),u=function(t,e,r,n,o){var i={},s=function(t,e,r,n){var o=new gw,i=t.graph(),s=function(t,e,r){return function(n,o,i){var s,a=n.node(o),u=n.node(i),c=0;if(c+=a.width/2,fw.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":s=-a.width/2;break;case"r":s=a.width/2}if(s&&(c+=r?s:-s),s=0,c+=(a.dummy?e:t)/2,c+=(u.dummy?e:t)/2,c+=u.width/2,fw.has(u,"labelpos"))switch(u.labelpos.toLowerCase()){case"l":s=u.width/2;break;case"r":s=-u.width/2}return s&&(c+=r?s:-s),s=0,c}}(i.nodesep,i.edgesep,n);return fw.forEach(e,(function(e){var n;fw.forEach(e,(function(e){var i=r[e];if(o.setNode(i),n){var a=r[n],u=o.edge(a,i);o.setEdge(a,i,Math.max(s(t,e,n),u||0))}n=e}))})),o}(t,e,r,o),a=o?"borderLeft":"borderRight";function u(t,e){for(var r=s.nodes(),n=r.pop(),o={};n;)o[n]?t(n):(o[n]=!0,r.push(n),r=r.concat(e(n))),n=r.pop()}function c(t){i[t]=s.inEdges(t).reduce((function(t,e){return Math.max(t,i[e.v]+s.edge(e))}),0)}function h(e){var r=s.outEdges(e).reduce((function(t,e){return Math.min(t,i[e.w]-s.edge(e))}),Number.POSITIVE_INFINITY),n=t.node(e);r!==Number.POSITIVE_INFINITY&&n.borderType!==a&&(i[e]=Math.max(i[e],r))}return u(c,s.predecessors.bind(s)),u(h,s.successors.bind(s)),fw.forEach(n,(function(t){i[t]=i[r[t]]})),i}(t,e,a.root,a.align,"r"===r);"r"===r&&(u=fw.mapValues(u,(function(t){return-t}))),o[i+r]=u}))}));var i=function(t,e){return fw.minBy(fw.values(e),(function(e){var r=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY;return fw.forIn(e,(function(e,o){var i=function(t,e){return t.node(e).width}(t,o)/2;r=Math.max(e+i,r),n=Math.min(e-i,n)})),r-n}))}(t,o);return function(t,e){var r=fw.values(e),n=fw.min(r),o=fw.max(r);fw.forEach(["u","d"],(function(r){fw.forEach(["l","r"],(function(i){var s,a=r+i,u=t[a];if(u!==e){var c=fw.values(u);(s="l"===i?n-fw.min(c):o-fw.max(c))&&(t[a]=fw.mapValues(u,(function(t){return t+s})))}}))}))}(o,i),function(t,e){return fw.mapValues(t.ul,(function(r,n){if(e)return t[e.toLowerCase()][n];var o=fw.sortBy(fw.map(t,n));return(o[1]+o[2])/2}))}(o,t.graph().align)};var xw=by,Ew=Cy,Nw=Gy,_w=mm,Mw=Ty.normalizeRanks,kw=Em,Aw=Ty.removeEmptyRanks,jw=Mm,Sw=Sm,Ow=Rm,zw=cw,Rw=function(t){(function(t){var e=ww.buildLayerMatrix(t),r=t.graph().ranksep,n=0;mw.forEach(e,(function(e){var o=mw.max(mw.map(e,(function(e){return t.node(e).height})));mw.forEach(e,(function(e){t.node(e).y=n+o/2})),n+=o+r}))})(t=ww.asNonCompoundGraph(t)),mw.forEach(bw(t),(function(e,r){t.node(r).x=e}))},Iw=Ty,Cw=iy.Graph,Pw=function(t,e){var r=e&&e.debugTiming?Iw.time:Iw.notime;r("layout",(function(){var e=r("  buildLayoutGraph",(function(){return function(t){var e=new Cw({multigraph:!0,compound:!0}),r=$w(t.graph());return e.setGraph(xw.merge({},Tw,Uw(r,Dw),xw.pick(r,Fw))),xw.forEach(t.nodes(),(function(r){var n=$w(t.node(r));e.setNode(r,xw.defaults(Uw(n,Lw),qw)),e.setParent(r,t.parent(r))})),xw.forEach(t.edges(),(function(r){var n=$w(t.edge(r));e.setEdge(r,xw.merge({},Gw,Uw(n,Vw),xw.pick(n,Bw)))})),e}(t)}));r("  runLayout",(function(){!function(t,e){e("    makeSpaceForEdgeLabels",(function(){!function(t){var e=t.graph();e.ranksep/=2,xw.forEach(t.edges(),(function(r){var n=t.edge(r);n.minlen*=2,"c"!==n.labelpos.toLowerCase()&&("TB"===e.rankdir||"BT"===e.rankdir?n.width+=n.labeloffset:n.height+=n.labeloffset)}))}(t)})),e("    removeSelfEdges",(function(){!function(t){xw.forEach(t.edges(),(function(e){if(e.v===e.w){var r=t.node(e.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:e,label:t.edge(e)}),t.removeEdge(e)}}))}(t)})),e("    acyclic",(function(){Ew.run(t)})),e("    nestingGraph.run",(function(){jw.run(t)})),e("    rank",(function(){_w(Iw.asNonCompoundGraph(t))})),e("    injectEdgeLabelProxies",(function(){!function(t){xw.forEach(t.edges(),(function(e){var r=t.edge(e);if(r.width&&r.height){var n=t.node(e.v),o={rank:(t.node(e.w).rank-n.rank)/2+n.rank,e:e};Iw.addDummyNode(t,"edge-proxy",o,"_ep")}}))}(t)})),e("    removeEmptyRanks",(function(){Aw(t)})),e("    nestingGraph.cleanup",(function(){jw.cleanup(t)})),e("    normalizeRanks",(function(){Mw(t)})),e("    assignRankMinMax",(function(){!function(t){var e=0;xw.forEach(t.nodes(),(function(r){var n=t.node(r);n.borderTop&&(n.minRank=t.node(n.borderTop).rank,n.maxRank=t.node(n.borderBottom).rank,e=xw.max(e,n.maxRank))})),t.graph().maxRank=e}(t)})),e("    removeEdgeLabelProxies",(function(){!function(t){xw.forEach(t.nodes(),(function(e){var r=t.node(e);"edge-proxy"===r.dummy&&(t.edge(r.e).labelRank=r.rank,t.removeNode(e))}))}(t)})),e("    normalize.run",(function(){Nw.run(t)})),e("    parentDummyChains",(function(){kw(t)})),e("    addBorderSegments",(function(){Sw(t)})),e("    order",(function(){zw(t)})),e("    insertSelfEdges",(function(){!function(t){var e=Iw.buildLayerMatrix(t);xw.forEach(e,(function(e){var r=0;xw.forEach(e,(function(e,n){var o=t.node(e);o.order=n+r,xw.forEach(o.selfEdges,(function(e){Iw.addDummyNode(t,"selfedge",{width:e.label.width,height:e.label.height,rank:o.rank,order:n+ ++r,e:e.e,label:e.label},"_se")})),delete o.selfEdges}))}))}(t)})),e("    adjustCoordinateSystem",(function(){Ow.adjust(t)})),e("    position",(function(){Rw(t)})),e("    positionSelfEdges",(function(){!function(t){xw.forEach(t.nodes(),(function(e){var r=t.node(e);if("selfedge"===r.dummy){var n=t.node(r.e.v),o=n.x+n.width/2,i=n.y,s=r.x-o,a=n.height/2;t.setEdge(r.e,r.label),t.removeNode(e),r.label.points=[{x:o+2*s/3,y:i-a},{x:o+5*s/6,y:i-a},{x:o+s,y:i},{x:o+5*s/6,y:i+a},{x:o+2*s/3,y:i+a}],r.label.x=r.x,r.label.y=r.y}}))}(t)})),e("    removeBorderNodes",(function(){!function(t){xw.forEach(t.nodes(),(function(e){if(t.children(e).length){var r=t.node(e),n=t.node(r.borderTop),o=t.node(r.borderBottom),i=t.node(xw.last(r.borderLeft)),s=t.node(xw.last(r.borderRight));r.width=Math.abs(s.x-i.x),r.height=Math.abs(o.y-n.y),r.x=i.x+r.width/2,r.y=n.y+r.height/2}})),xw.forEach(t.nodes(),(function(e){"border"===t.node(e).dummy&&t.removeNode(e)}))}(t)})),e("    normalize.undo",(function(){Nw.undo(t)})),e("    fixupEdgeLabelCoords",(function(){!function(t){xw.forEach(t.edges(),(function(e){var r=t.edge(e);if(xw.has(r,"x"))switch("l"!==r.labelpos&&"r"!==r.labelpos||(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset}}))}(t)})),e("    undoCoordinateSystem",(function(){Ow.undo(t)})),e("    translateGraph",(function(){!function(t){var e=Number.POSITIVE_INFINITY,r=0,n=Number.POSITIVE_INFINITY,o=0,i=t.graph(),s=i.marginx||0,a=i.marginy||0;function u(t){var i=t.x,s=t.y,a=t.width,u=t.height;e=Math.min(e,i-a/2),r=Math.max(r,i+a/2),n=Math.min(n,s-u/2),o=Math.max(o,s+u/2)}xw.forEach(t.nodes(),(function(e){u(t.node(e))})),xw.forEach(t.edges(),(function(e){var r=t.edge(e);xw.has(r,"x")&&u(r)})),e-=s,n-=a,xw.forEach(t.nodes(),(function(r){var o=t.node(r);o.x-=e,o.y-=n})),xw.forEach(t.edges(),(function(r){var o=t.edge(r);xw.forEach(o.points,(function(t){t.x-=e,t.y-=n})),xw.has(o,"x")&&(o.x-=e),xw.has(o,"y")&&(o.y-=n)})),i.width=r-e+s,i.height=o-n+a}(t)})),e("    assignNodeIntersects",(function(){!function(t){xw.forEach(t.edges(),(function(e){var r,n,o=t.edge(e),i=t.node(e.v),s=t.node(e.w);o.points?(r=o.points[0],n=o.points[o.points.length-1]):(o.points=[],r=s,n=i),o.points.unshift(Iw.intersectRect(i,r)),o.points.push(Iw.intersectRect(s,n))}))}(t)})),e("    reversePoints",(function(){!function(t){xw.forEach(t.edges(),(function(e){var r=t.edge(e);r.reversed&&r.points.reverse()}))}(t)})),e("    acyclic.undo",(function(){Ew.undo(t)}))}(e,r)})),r("  updateInputGraph",(function(){!function(t,e){xw.forEach(t.nodes(),(function(r){var n=t.node(r),o=e.node(r);n&&(n.x=o.x,n.y=o.y,e.children(r).length&&(n.width=o.width,n.height=o.height))})),xw.forEach(t.edges(),(function(r){var n=t.edge(r),o=e.edge(r);n.points=o.points,xw.has(o,"x")&&(n.x=o.x,n.y=o.y)})),t.graph().width=e.graph().width,t.graph().height=e.graph().height}(t,e)}))}))};var Dw=["nodesep","edgesep","ranksep","marginx","marginy"],Tw={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Fw=["acyclicer","ranker","rankdir","align"],Lw=["width","height"],qw={width:0,height:0},Vw=["minlen","weight","width","height","labeloffset"],Gw={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Bw=["labelpos"];function Uw(t,e){return xw.mapValues(xw.pick(t,e),Number)}function $w(t){var e={};return xw.forEach(t,(function(t,r){e[r.toLowerCase()]=t})),e}var Ww=by,Yw=Ty,Hw=iy.Graph;var Kw={graphlib:iy,layout:Pw,debug:{debugOrdering:function(t){var e=Yw.buildLayerMatrix(t),r=new Hw({compound:!0,multigraph:!0}).setGraph({});return Ww.forEach(t.nodes(),(function(e){r.setNode(e,{label:e}),r.setParent(e,"layer"+t.node(e).rank)})),Ww.forEach(t.edges(),(function(t){r.setEdge(t.v,t.w,{},t.name)})),Ww.forEach(e,(function(t,e){var n="layer"+e;r.setNode(n,{rank:"same"}),Ww.reduce(t,(function(t,e){return r.setEdge(t,e,{style:"invis"}),e}))})),r}},util:{time:Ty.time,notime:Ty.notime},version:"0.8.5"},Jw=jr(Kw);class Qw{constructor(t){this.id="dagre",this.options={},Object.assign(this.options,Qw.defaultOptions,t)}execute(t,e){return o(this,void 0,void 0,(function*(){return this.genericDagreLayout(!1,t,Object.assign(Object.assign({},this.options),e))}))}assign(t,e){return o(this,void 0,void 0,(function*(){yield this.genericDagreLayout(!0,t,Object.assign(Object.assign({},this.options),e))}))}genericDagreLayout(t,e,r){return o(this,void 0,void 0,(function*(){const{nodeSize:n}=r,o=new Kw.graphlib.Graph;o.setGraph(r),o.setDefaultEdgeLabel((()=>({})));[...e.getAllNodes(),...e.getAllEdges()].some((({id:t})=>D(t))),e.getAllNodes().forEach((t=>{const{id:e}=t,r=Object.assign({},t.data);if(void 0!==n){const[e,o]=Ve(O(n)?n(t):n);Object.assign(r,{width:e,height:o})}o.setNode(e.toString(),r)})),e.getAllEdges().forEach((({id:t,source:e,target:r})=>{o.setEdge(e.toString(),r.toString(),{id:t})})),Jw.layout(o);const i={nodes:[],edges:[]};return o.nodes().forEach((r=>{const n=o.node(r);i.nodes.push({id:r,data:n}),t&&e.mergeNodeData(r,n)})),o.edges().forEach((r=>{const n=o.edge(r),{id:s}=n,a=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}(n,["id"]),{v:u,w:c}=r;i.edges.push({id:s,source:u,target:c,data:a}),t&&e.mergeEdgeData(s,a)})),i}))}}Qw.defaultOptions={};class Xw{constructor(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}distanceTo(t){const e=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(e,r)}setPos(t,e){this.rx=t,this.ry=e}resetForce(){this.fx=0,this.fy=0}addForce(t){const e=t.rx-this.rx,r=t.ry-this.ry;let n=Math.hypot(e,r);n=n<1e-4?1e-4:n;const o=this.g*(this.degree+1)*(t.degree+1)/n;this.fx+=o*e/n,this.fy+=o*r/n}in(t){return t.contains(this.rx,this.ry)}add(t){const e=this.mass+t.mass,r=(this.rx*this.mass+t.rx*t.mass)/e,n=(this.ry*this.mass+t.ry*t.mass)/e,o=this.degree+t.degree;return new Xw({rx:r,ry:n,mass:e,degree:o})}}class Zw{constructor(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}getLength(){return this.length}contains(t,e){const r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r}NW(){const t=this.xmid-this.length/4,e=this.ymid+this.length/4,r=this.length/2;return new Zw({xmid:t,ymid:e,length:r})}NE(){const t=this.xmid+this.length/4,e=this.ymid+this.length/4,r=this.length/2;return new Zw({xmid:t,ymid:e,length:r})}SW(){const t=this.xmid-this.length/4,e=this.ymid-this.length/4,r=this.length/2;return new Zw({xmid:t,ymid:e,length:r})}SE(){const t=this.xmid+this.length/4,e=this.ymid-this.length/4,r=this.length/2;return new Zw({xmid:t,ymid:e,length:r})}}class tb{constructor(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}insert(t){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new tb(this.quad.NW()),this.NE=new tb(this.quad.NE()),this.SW=new tb(this.quad.SW()),this.SE=new tb(this.quad.SE())),this._putBody(this.body),this._putBody(t),this.body=this.body.add(t)):(this.body=this.body.add(t),this._putBody(t)):this.body=t}_putBody(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))}_isExternal(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE}updateForce(t){if(null!=this.body&&t!==this.body)if(this._isExternal())t.addForce(this.body);else{(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t))}}}const eb={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1};const rb={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"};const nb={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300};const ob=(t,e)=>{let r;const n=t.rows||5,o=t.cols||5;if(null==e)r=Math.min(n,o);else{Math.min(n,o)===t.rows?t.rows=e:t.cols=e}return r},ib=(t,e)=>{let r;const n=t.rows||5,o=t.cols||5;if(null==e)r=Math.max(n,o);else{Math.max(n,o)===t.rows?t.rows=e:t.cols=e}return r},sb=(t,e)=>t[`c-${e.row}-${e.col}`]||!1,ab=(t,e)=>t[`c-${e.row}-${e.col}`]=!0,ub=(t,e)=>{const r=t.cols||5;e.col++,e.col>=r&&(e.col=0,e.row++)},cb=(t,e,r,n,o,i,s,a)=>{let u,c;const h=o[t.id];if(h)u=h.col*r+r/2+e[0],c=h.row*n+n/2+e[1];else{for(;sb(a,s);)ub(i,s);u=s.col*r+r/2+e[0],c=s.row*n+n/2+e[1],ab(a,s),ub(i,s)}t.data.x=u,t.data.y=c},hb={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},db=(t,e,r,n,o,i)=>{e.forEach(((s,a)=>{r[a]={x:0,y:0},e.forEach(((e,u)=>{if(a===u)return;if(o[a]!==o[u])return;let c=s.x-e.x,h=s.y-e.y,d=Math.sqrt(c*c+h*h);if(0===d){d=1;const t=a>u?1:-1;c=.01*t,h=.01*t}if(d<i(t[a])/2+i(t[u])/2){const t=n*n/d;r[a].x+=c/d*t,r[a].y+=h/d*t}}))}))},lb=(t,e,r,n,o,i,s,a)=>{const u=i||s/10;return n&&e.forEach(((e,r)=>{const n=t[r].x-t[o].x,i=t[r].y-t[o].y,s=Math.sqrt(n*n+i*i);let a=i/s,u=-n/s;const c=Math.sqrt(e.x*e.x+e.y*e.y);let h=Math.acos((a*e.x+u*e.y)/c);h>Math.PI/2&&(h-=Math.PI/2,a*=-1,u*=-1);const d=Math.cos(h)*c;e.x=a*d,e.y=u*d})),t.forEach(((i,s)=>{if(s===o)return;const c=Math.sqrt(e[s].x*e[s].x+e[s].y*e[s].y);if(c>0&&s!==o){const h=Math.min(u*(r/800),c);if(i.x+=e[s].x/c*h,i.y+=e[s].y/c*h,n){let e=i.x-t[o].x,r=i.y-t[o].y;const n=Math.sqrt(e*e+r*r);e=e/n*a[s],r=r/n*a[s],i.x=t[o].x+e,i.y=t[o].y+r}}})),t},fb={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10};const gb=(t,e,r,n,o,i,s)=>{if(!t)return[];const a=[];if(e){const u={};e.forEach(((e,c)=>{const h=[];e.forEach(((e,a)=>{var d,l;if(c===a)h.push(0);else if(n[c]===n[a])if("data"===i)h.push(e*(Math.abs(c-a)*s)/(n[c]/o));else if(i){let r,f;if(u[t[c].id])r=u[t[c].id];else{const e=("id"===i?t[c].id:null===(d=t[c].data)||void 0===d?void 0:d[i])||0;r=P(e)?e.charCodeAt(0):e,u[t[c].id]=r}if(u[t[a].id])f=u[t[a].id];else{const e=("id"===i?t[a].id:null===(l=t[a].data)||void 0===l?void 0:l[i])||0;f=P(e)?e.charCodeAt(0):e,u[t[a].id]=f}h.push(e*(Math.abs(r-f)*s)/(n[c]/o))}else h.push(e*r/(n[c]/o));else{const t=(r+o)/2;h.push(e*t)}})),a.push(h)}))}return a},pb=t=>{const e=t.length,r=t[0].length,n=[];for(let o=0;o<e;o++){const e=[];for(let n=0;n<r;n++)0!==t[o][n]?e.push(1/(t[o][n]*t[o][n])):e.push(0);n.push(e)}return n},vb=(t,e)=>{let r=-1;return t.forEach(((t,n)=>{t.id===e&&(r=n)})),Math.max(r,0)},yb=(t,e,r)=>{const n=t.length;for(let o=0;o<n;o++)if(t[e][o]===1/0){t[e][o]=r,t[o][e]=r;for(let i=0;i<n;i++)t[o][i]!==1/0&&t[e][i]===1/0&&(t[e][i]=r+t[o][i],t[i][e]=r+t[o][i])}for(let o=0;o<n;o++)if(o!==e)for(let r=0;r<n;r++)if(t[o][r]===1/0){let n=Math.abs(t[e][o]-t[e][r]);n=0===n?1:n,t[o][r]=n}},mb=(t,e)=>{let r=0;for(let n=0;n<t[e].length;n++)t[e][n]!==1/0&&(r=t[e][n]>r?t[e][n]:r);return r},wb={center:[0,0],width:300,height:300};const bb={circular:class{constructor(t={}){this.options=t,this.id="circular",this.options=Object.assign(Object.assign({},He),t)}execute(t,e){return o(this,void 0,void 0,(function*(){return this.genericCircularLayout(!1,t,e)}))}assign(t,e){return o(this,void 0,void 0,(function*(){yield this.genericCircularLayout(!0,t,e)}))}genericCircularLayout(t,e,r){return o(this,void 0,void 0,(function*(){const n=Object.assign(Object.assign({},this.options),r),{width:o,height:i,center:s,divisions:a,startAngle:u=0,endAngle:c=2*Math.PI,angleRatio:h,ordering:d,clockwise:l,nodeSpacing:f,nodeSize:g}=n,p=e.getAllNodes(),v=e.getAllEdges(),[y,m,w]=Je(o,i,s),b=null==p?void 0:p.length;if(!b||1===b)return Ye(e,t,w);const x=(c-u)/b;let{radius:E,startRadius:N,endRadius:_}=n;if(f){const t=Ge(10,f),e=Be(10,g);let r=-1/0;p.forEach((t=>{const n=e(t);r<n&&(r=n)}));let n=0;p.forEach(((e,o)=>{n+=0===o?r||10:(t(e)||0)+(r||10)})),E=n/(2*Math.PI)}else E||N||_?!N&&_?N=_:N&&!_&&(_=N):E=Math.min(m,y)/2;const M=x*h;let k=[];k="topology"===d?Ke(e,p):"topology-directed"===d?Ke(e,p,!0):"degree"===d?function(t,e){const r=[];return e.forEach(((t,e)=>{r.push(qe(t))})),r.sort(((e,r)=>t.getDegree(e.id,"both")-t.getDegree(r.id,"both"))),r}(e,p):p.map((t=>qe(t)));const A=Math.ceil(b/a);for(let t=0;t<b;++t){let e=E;e||null===N||null===_||(e=N+t*(_-N)/(b-1)),e||(e=10+100*t/(b-1));let r=u+t%A*M+2*Math.PI/a*Math.floor(t/A);l||(r=c-t%A*M-2*Math.PI/a*Math.floor(t/A)),k[t].data.x=w[0]+Math.cos(r)*e,k[t].data.y=w[1]+Math.sin(r)*e}t&&k.forEach((t=>{e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}));return{nodes:k,edges:v}}))}},concentric:Xe,mds:jn,random:class{constructor(t={}){this.options=t,this.id="random",this.options=Object.assign(Object.assign({},wb),t)}execute(t,e){return o(this,void 0,void 0,(function*(){return this.genericRandomLayout(!1,t,e)}))}assign(t,e){return o(this,void 0,void 0,(function*(){yield this.genericRandomLayout(!0,t,e)}))}genericRandomLayout(t,e,r){return o(this,void 0,void 0,(function*(){const n=Object.assign(Object.assign({},this.options),r),{center:o,width:i,height:s}=n,a=e.getAllNodes(),u=i||"undefined"==typeof window?i:window.innerWidth,c=s||"undefined"==typeof window?s:window.innerHeight,h=o||[u/2,c/2],d=[];a&&a.forEach((t=>{d.push({id:t.id,data:{x:.9*(Math.random()-.5)*u+h[0],y:.9*(Math.random()-.5)*c+h[1]}})})),t&&d.forEach((t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})));return{nodes:d,edges:e.getAllEdges()}}))}},grid:class{constructor(t={}){this.options=t,this.id="grid",this.options=Object.assign(Object.assign({},nb),t)}execute(t,e){return o(this,void 0,void 0,(function*(){return this.genericGridLayout(!1,t,e)}))}assign(t,e){return o(this,void 0,void 0,(function*(){yield this.genericGridLayout(!0,t,e)}))}genericGridLayout(t,e,r){return o(this,void 0,void 0,(function*(){const n=Object.assign(Object.assign({},this.options),r),{begin:o=[0,0],condense:i,preventOverlapPadding:s,preventOverlap:a,rows:u,cols:c,nodeSpacing:h,nodeSize:d,width:l,height:f,position:g}=n;let{sortBy:p}=n;const v=e.getAllNodes(),y=e.getAllEdges(),m=null==v?void 0:v.length;if(!m||1===m)return Ye(e,t,o);const w=v.map((t=>qe(t)));"id"===p||P(p)&&void 0!==w[0].data[p]||(p="degree"),"degree"===p?w.sort(((t,r)=>e.getDegree(r.id,"both")-e.getDegree(t.id,"both"))):"id"===p?w.sort(((t,e)=>D(e.id)&&D(t.id)?e.id-t.id:`${t.id}`.localeCompare(`${e.id}`))):w.sort(((t,e)=>e.data[p]-t.data[p]));const b=l||"undefined"==typeof window?l:window.innerWidth,x=f||"undefined"==typeof window?f:window.innerHeight,E=m,N={rows:u,cols:c};if(null!=u&&null!=c)N.rows=u,N.cols=c;else if(null!=u&&null==c)N.rows=u,N.cols=Math.ceil(E/N.rows);else if(null==u&&null!=c)N.cols=c,N.rows=Math.ceil(E/N.cols);else{const t=Math.sqrt(E*x/b);N.rows=Math.round(t),N.cols=Math.round(b/x*t)}if(N.rows=Math.max(N.rows,1),N.cols=Math.max(N.cols,1),N.cols*N.rows>E){const t=ob(N),e=ib(N);(t-1)*e>=E?ob(N,t-1):(e-1)*t>=E&&ib(N,e-1)}else for(;N.cols*N.rows<E;){const t=ob(N),e=ib(N);(e+1)*t>=E?ib(N,e+1):ob(N,t+1)}let _=i?0:b/N.cols,M=i?0:x/N.rows;if(a||h){const t=Ge(10,h),r=Be(30,d,!1);w.forEach((n=>{n.data.x&&n.data.y||(n.data.x=0,n.data.y=0);const o=e.getNode(n.id),[i,a]=Ve(r(o)||30),u=void 0!==t?t(n):s,c=i+u,h=a+u;_=Math.max(_,c),M=Math.max(M,h)}))}const k={},A={row:0,col:0},j={};for(let t=0;t<w.length;t++){const r=w[t];let n;if(g&&(n=g(e.getNode(r.id))),n&&(void 0!==n.row||void 0!==n.col)){const t={row:n.row,col:n.col};if(void 0===t.col)for(t.col=0;sb(k,t);)t.col++;else if(void 0===t.row)for(t.row=0;sb(k,t);)t.row++;j[r.id]=t,ab(k,t)}cb(r,o,_,M,j,N,A,k)}const S={nodes:w,edges:y};return t&&w.forEach((t=>{e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),S}))}},radial:class{constructor(t={}){this.options=t,this.id="radial",this.options=Object.assign(Object.assign({},fb),t)}execute(t,e){return o(this,void 0,void 0,(function*(){return this.genericRadialLayout(!1,t,e)}))}assign(t,e){return o(this,void 0,void 0,(function*(){yield this.genericRadialLayout(!0,t,e)}))}genericRadialLayout(t,e,r){return o(this,void 0,void 0,(function*(){const n=Object.assign(Object.assign({},this.options),r),{width:o,height:i,center:s,focusNode:a,unitRadius:u,nodeSize:c,nodeSpacing:h,strictRadial:d,preventOverlap:l,maxPreventOverlapIteration:f,sortBy:g,linkDistance:p=50,sortStrength:v=10,maxIteration:y=1e3}=n,m=e.getAllNodes(),w=e.getAllEdges(),b=o||"undefined"==typeof window?o:window.innerWidth,x=i||"undefined"==typeof window?i:window.innerHeight,E=s||[b/2,x/2];if(!(null==m?void 0:m.length)||1===m.length)return Ye(e,t,E);let N=m[0];if(P(a)){for(let t=0;t<m.length;t++)if(m[t].id===a){N=m[t];break}}else N=a||m[0];const _=vb(m,N.id),M=De({nodes:m,edges:w}),k=Pe(M),A=mb(k,_);yb(k,_,A+1);const j=k[_];let S=b-E[0]>E[0]?E[0]:b-E[0],O=x-E[1]>E[1]?E[1]:x-E[1];0===S&&(S=b/2),0===O&&(O=x/2);const z=Math.min(S,O),R=Math.max(...j),I=[],C=u||z/R;j.forEach(((t,e)=>{I[e]=t*C}));const D=gb(m,k,p,I,C,g,v),T=pb(D),F=((t,e,r)=>{try{const r=Mn.mul(Mn.pow(e,2),-.5),n=r.mean("row"),o=r.mean("column"),i=r.mean();r.add(i).subRowVector(n).subColumnVector(o);const s=new kn(r),a=Mn.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((e=>Mn.mul([e],[a]).toJSON()[0].splice(0,t)))}catch(n){const t=[];for(let o=0;o<e.length;o++){const e=Math.random()*r,n=Math.random()*r;t.push([e,n])}return t}})(p,D,p);let L,q=F.map((([t,e])=>({x:(isNaN(t)?Math.random()*p:t)-F[_][0],y:(isNaN(e)?Math.random()*p:e)-F[_][1]})));if(this.run(y,q,T,D,I,_),l){L=Ue(c,h);const t={nodes:m,nodeSizeFunc:L,positions:q,radii:I,height:x,width:b,strictRadial:Boolean(d),focusIdx:_,iterations:f||200,k:q.length/4.5};q=((t,e)=>{const r=Object.assign(Object.assign({},hb),e),{positions:n,iterations:o,width:i,k:s,speed:a=100,strictRadial:u,focusIdx:c,radii:h=[],nodeSizeFunc:d}=r,l=t.getAllNodes(),f=[],g=i/10;for(let p=0;p<o;p++)n.forEach(((t,e)=>{f[e]={x:0,y:0}})),db(l,n,f,s,h,d),lb(n,f,a,u,c,g,i,h);return n})(e,t)}const V=[];q.forEach(((t,e)=>{const r=qe(m[e]);r.data.x=t.x+E[0],r.data.y=t.y+E[1],V.push(r)})),t&&V.forEach((t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})));return{nodes:V,edges:w}}))}run(t,e,r,n,o,i){for(let s=0;s<=t;s++){const a=s/t;this.oneIteration(a,e,o,n,r,i)}}oneIteration(t,e,r,n,o,i){const s=1-t;e.forEach(((a,u)=>{const c=Te(a,{x:0,y:0}),h=0===c?0:1/c;if(u===i)return;let d=0,l=0,f=0;e.forEach(((t,e)=>{if(u===e)return;const r=Te(a,t),i=0===r?0:1/r,s=n[e][u];f+=o[u][e],d+=o[u][e]*(t.x+s*(a.x-t.x)*i),l+=o[u][e]*(t.y+s*(a.y-t.y)*i)}));const g=0===r[u]?0:1/r[u];f*=s,f+=t*g*g,d*=s,d+=t*g*a.x*h,a.x=d/f,l*=s,l+=t*g*a.y*h,a.y=l/f}))}},force:xr,d3force:Eo,"d3-force-3d":class extends Eo{constructor(){super(...arguments),this.id="d3-force-3d",this.config={inputNodeAttrs:["x","y","z","vx","vy","vz","fx","fy","fz"],outputNodeAttrs:["x","y","z","vx","vy","vz"],simulationAttrs:["alpha","alphaMin","alphaDecay","alphaTarget","velocityDecay","randomSource","numDimensions"]},this.forceMap={link:qo,manyBody:Hs,center:_o,collide:To,radial:Ks,x:Js,y:Qs,z:Xs},this.options={numDimensions:3,link:{id:t=>t.id},manyBody:{},center:{x:0,y:0,z:0}}}initSimulation(){return Ys()}},fruchterman:class{constructor(t={}){this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=Object.assign(Object.assign({},rb),t)}execute(t,e){return o(this,void 0,void 0,(function*(){return this.genericFruchtermanLayout(!1,t,e)}))}assign(t,e){return o(this,void 0,void 0,(function*(){yield this.genericFruchtermanLayout(!0,t,e)}))}stop(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1}tick(t=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let r=0;r<t;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);const e={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&e.nodes.forEach((t=>this.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===this.options.dimensions?t.data.z:void 0}))),e}genericFruchtermanLayout(t,e,r){return o(this,void 0,void 0,(function*(){if(this.running)return;const n=this.formatOptions(r),{dimensions:o,width:i,height:s,center:a,clustering:u,nodeClusterBy:c,maxIteration:d,onTick:l}=n,f=e.getAllNodes(),g=e.getAllEdges();if(!(null==f?void 0:f.length)){const t={nodes:[],edges:g};return this.lastResult=t,t}if(1===f.length){t&&e.mergeNodeData(f[0].id,{x:a[0],y:a[1],z:3===o?a[2]:void 0});const r={nodes:[Object.assign(Object.assign({},f[0]),{data:Object.assign(Object.assign({},f[0].data),{x:a[0],y:a[1],z:3===o?a[2]:void 0})})],edges:g};return this.lastResult=r,r}const p=f.map((t=>qe(t,[i,s]))),v=new h({nodes:p,edges:g}),y={};if(u&&p.forEach((t=>{const e=t.data[c];y[e]||(y[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=p,this.lastLayoutEdges=g,this.lastAssign=t,this.lastGraph=v,this.lastOptions=n,this.lastClusterMap=y,"undefined"==typeof window)return;let m=0;return new Promise((r=>{this.timeInterval=window.setInterval((()=>{this.running?(this.runOneStep(v,y,n),t&&p.forEach((({id:t,data:r})=>e.mergeNodeData(t,{x:r.x,y:r.y,z:3===o?r.z:void 0}))),null==l||l({nodes:p,edges:g}),m++,m>=d&&(window.clearInterval(this.timeInterval),r({nodes:p,edges:g}))):r({nodes:p,edges:g})}),0),this.running=!0}))}))}formatOptions(t={}){const e=Object.assign(Object.assign({},this.options),t),{clustering:r,nodeClusterBy:n}=e,{center:o,width:i,height:s}=e;return e.width=i||"undefined"==typeof window?i:window.innerWidth,e.height=s||"undefined"==typeof window?s:window.innerHeight,e.center=o||[e.width/2,e.height/2],e.clustering=r&&!!n,e}runOneStep(t,e,r){const{dimensions:n,height:o,width:i,gravity:s,center:a,speed:u,clustering:c,nodeClusterBy:h,clusterGravity:d}=r,l=o*i,f=Math.sqrt(l)/10,g=t.getAllNodes(),p=l/(g.length+1),v=Math.sqrt(p),y={};if(this.applyCalculate(t,y,v,p),c){for(const r in e)e[r].cx=0,e[r].cy=0,e[r].count=0;g.forEach((t=>{const{data:r}=t,n=e[r[h]];D(r.x)&&(n.cx+=r.x),D(r.y)&&(n.cy+=r.y),n.count++}));for(const r in e)e[r].cx/=e[r].count,e[r].cy/=e[r].count;const t=d||s;g.forEach(((r,n)=>{const{id:o,data:i}=r;if(!D(i.x)||!D(i.y))return;const s=e[i[h]],a=Math.sqrt((i.x-s.cx)*(i.x-s.cx)+(i.y-s.cy)*(i.y-s.cy)),u=v*t;y[o].x-=u*(i.x-s.cx)/a,y[o].y-=u*(i.y-s.cy)/a}))}g.forEach(((t,e)=>{const{id:r,data:o}=t;if(!D(o.x)||!D(o.y))return;const i=.01*v*s;y[r].x-=i*(o.x-a[0]),y[r].y-=i*(o.y-a[1]),3===n&&(y[r].z-=i*(o.z-a[2]))})),g.forEach(((e,r)=>{const{id:o,data:i}=e;if(D(i.fx)&&D(i.fy))return i.x=i.fx,i.y=i.fy,void(3===n&&(i.z=i.fz));if(!D(i.x)||!D(i.y))return;const s=Math.sqrt(y[o].x*y[o].x+y[o].y*y[o].y+(3===n?y[o].z*y[o].z:0));if(s>0){const e=Math.min(f*(u/800),s);t.mergeNodeData(o,{x:i.x+y[o].x/s*e,y:i.y+y[o].y/s*e,z:3===n?i.z+y[o].z/s*e:void 0})}}))}applyCalculate(t,e,r,n){this.calRepulsive(t,e,n),this.calAttractive(t,e,r)}calRepulsive(t,e,r){const n=t.getAllNodes();n.forEach((({data:t,id:o},i)=>{e[o]={x:0,y:0,z:0},n.forEach((({data:n,id:s},a)=>{if(i<=a||!D(t.x)||!D(n.x)||!D(t.y)||!D(n.y))return;let u=t.x-n.x,c=t.y-n.y,h=3===this.options.dimensions?t.z-n.z:0,d=u*u+c*c+h*h;0===d&&(d=1,u=.01,c=.01,h=.01);const l=r/d,f=u*l,g=c*l,p=h*l;e[o].x+=f,e[o].y+=g,e[s].x-=f,e[s].y-=g,3===this.options.dimensions&&(e[o].z+=p,e[s].z-=p)}))}))}calAttractive(t,e,r){t.getAllEdges().forEach((n=>{const{source:o,target:i}=n;if(!o||!i||o===i)return;const{data:s}=t.getNode(o),{data:a}=t.getNode(i);if(!(D(a.x)&&D(s.x)&&D(a.y)&&D(s.y)))return;const u=a.x-s.x,c=a.y-s.y,h=3===this.options.dimensions?a.z-s.z:0,d=Math.sqrt(u*u+c*c+h*h)/r,l=u*d,f=c*d,g=h*d;e[o].x+=l,e[o].y+=f,e[i].x-=l,e[i].y-=f,3===this.options.dimensions&&(e[o].z+=g,e[i].z-=g)}))}},forceAtlas2:class{constructor(t={}){this.options=t,this.id="forceAtlas2",this.options=Object.assign(Object.assign({},eb),t)}execute(t,e){return o(this,void 0,void 0,(function*(){return this.genericForceAtlas2Layout(!1,t,e)}))}assign(t,e){return o(this,void 0,void 0,(function*(){yield this.genericForceAtlas2Layout(!0,t,e)}))}genericForceAtlas2Layout(t,e,r){return o(this,void 0,void 0,(function*(){const n=e.getAllEdges(),o=e.getAllNodes(),i=this.formatOptions(r,o.length),{width:s,height:a,prune:u,maxIteration:c,nodeSize:d,center:l}=i;if(!(null==o?void 0:o.length)||1===o.length)return Ye(e,t,l);const f=o.map((t=>qe(t,[s,a]))),g=n.filter((t=>{const{source:e,target:r}=t;return e!==r})),p=new h({nodes:f,edges:g}),v=this.getSizes(p,d);if(this.run(p,e,c,v,t,i),u){for(let t=0;t<g.length;t+=1){const{source:e,target:r}=g[t],n=p.getDegree(e),o=p.getDegree(e);if(n<=1){const t=p.getNode(r);p.mergeNodeData(e,{x:t.data.x,y:t.data.y})}else if(o<=1){const t=p.getNode(e);p.mergeNodeData(r,{x:t.data.x,y:t.data.y})}}const r=Object.assign(Object.assign({},i),{prune:!1,barnesHut:!1});this.run(p,e,100,v,t,r)}return{nodes:f,edges:n}}))}getSizes(t,e){const r=t.getAllNodes(),n={};for(let o=0;o<r.length;o+=1){const t=r[o];n[t.id]=Ue(e,void 0)(t)}return n}formatOptions(t={},e){const r=Object.assign(Object.assign({},this.options),t),{center:n,width:o,height:i,barnesHut:s,prune:a,maxIteration:u,kr:c,kg:h}=r;return r.width=o||"undefined"==typeof window?o:window.innerWidth,r.height=i||"undefined"==typeof window?i:window.innerHeight,r.center=n||[r.width/2,r.height/2],void 0===s&&e>250&&(r.barnesHut=!0),void 0===a&&e>100&&(r.prune=!0),0!==u||a?0===u&&a&&(r.maxIteration=100,e<=200&&e>100?r.maxIteration=500:e>200&&(r.maxIteration=950)):(r.maxIteration=250,e<=200&&e>100?r.maxIteration=1e3:e>200&&(r.maxIteration=1200)),c||(r.kr=50,e>100&&e<=500?r.kr=20:e>500&&(r.kr=1)),h||(r.kg=20,e>100&&e<=500?r.kg=10:e>500&&(r.kg=1)),r}run(t,e,r,n,o,i){const{kr:s,barnesHut:a,onTick:u}=i,c=t.getAllNodes();let h=0,d=r;const l={},f={},g={};for(let p=0;p<c.length;p+=1){const{data:e,id:r}=c[p];if(l[r]=[0,0],a){const n={id:p,rx:e.x,ry:e.y,mass:1,g:s,degree:t.getDegree(r)};g[r]=new Xw(n)}}for(;d>0;)h=this.oneStep(t,{iter:d,preventOverlapIters:50,krPrime:100,sg:h,forces:l,preForces:f,bodies:g,sizes:n},i),d--,null==u||u({nodes:c,edges:e.getAllEdges()});return t}oneStep(t,e,r){const{iter:n,preventOverlapIters:o,krPrime:i,sg:s,preForces:a,bodies:u,sizes:c}=e;let{forces:h}=e;const{preventOverlap:d,barnesHut:l}=r,f=t.getAllNodes();for(let g=0;g<f.length;g+=1){const{id:t}=f[g];a[t]=[...h[t]],h[t]=[0,0]}return h=this.getAttrForces(t,n,o,c,h,r),h=l&&(d&&n>o||!d)?this.getOptRepGraForces(t,h,u,r):this.getRepGraForces(t,n,o,h,i,c,r),this.updatePos(t,h,a,s,r)}getAttrForces(t,e,r,n,o,i){const{preventOverlap:s,dissuadeHubs:a,mode:u,prune:c}=i,h=t.getAllEdges();for(let d=0;d<h.length;d+=1){const{source:i,target:l}=h[d],f=t.getNode(i),g=t.getNode(l),p=t.getDegree(i),v=t.getDegree(l);if(c&&(p<=1||v<=1))continue;const y=[g.data.x-f.data.x,g.data.y-f.data.y];let m=Math.hypot(y[0],y[1]);m=m<1e-4?1e-4:m,y[0]=y[0]/m,y[1]=y[1]/m,s&&e<r&&(m=m-n[i]-n[l]);let w=m,b=w;"linlog"===u&&(w=Math.log(1+m),b=w),a&&(w=m/p,b=m/v),s&&e<r&&m<=0?(w=0,b=0):s&&e<r&&m>0&&(w=m,b=m),o[i][0]+=w*y[0],o[l][0]-=b*y[0],o[i][1]+=w*y[1],o[l][1]-=b*y[1]}return o}getOptRepGraForces(t,e,r,n){const{kg:o,center:i,prune:s}=n,a=t.getAllNodes(),u=a.length;let c=9e10,h=-9e10,d=9e10,l=-9e10;for(let v=0;v<u;v+=1){const{id:e,data:n}=a[v];s&&t.getDegree(e)<=1||(r[e].setPos(n.x,n.y),n.x>=h&&(h=n.x),n.x<=c&&(c=n.x),n.y>=l&&(l=n.y),n.y<=d&&(d=n.y))}const f=Math.max(h-c,l-d),g=new Zw({xmid:(h+c)/2,ymid:(l+d)/2,length:f,massCenter:i,mass:u}),p=new tb(g);for(let v=0;v<u;v+=1){const{id:e}=a[v];s&&t.getDegree(e)<=1||r[e].in(g)&&p.insert(r[e])}for(let v=0;v<u;v+=1){const{id:n,data:u}=a[v],c=t.getDegree(n);if(s&&c<=1)continue;r[n].resetForce(),p.updateForce(r[n]),e[n][0]-=r[n].fx,e[n][1]-=r[n].fy;const h=[u.x-i[0],u.y-i[1]];let d=Math.hypot(h[0],h[1]);d=d<1e-4?1e-4:d,h[0]=h[0]/d,h[1]=h[1]/d;const l=o*(c+1);e[n][0]-=l*h[0],e[n][1]-=l*h[1]}return e}getRepGraForces(t,e,r,n,o,i,s){const{preventOverlap:a,kr:u,kg:c,center:h,prune:d}=s,l=t.getAllNodes(),f=l.length;for(let g=0;g<f;g+=1){const s=l[g],p=t.getDegree(s.id);for(let c=g+1;c<f;c+=1){const h=l[c],f=t.getDegree(h.id);if(d&&(p<=1||f<=1))continue;const g=[h.data.x-s.data.x,h.data.y-s.data.y];let v=Math.hypot(g[0],g[1]);v=v<1e-4?1e-4:v,g[0]=g[0]/v,g[1]=g[1]/v,a&&e<r&&(v=v-i[s.id]-i[h.id]);let y=u*(p+1)*(f+1)/v;a&&e<r&&v<0?y=o*(p+1)*(f+1):a&&e<r&&0===v?y=0:a&&e<r&&v>0&&(y=u*(p+1)*(f+1)/v),n[s.id][0]-=y*g[0],n[h.id][0]+=y*g[0],n[s.id][1]-=y*g[1],n[h.id][1]+=y*g[1]}const v=[s.data.x-h[0],s.data.y-h[1]],y=Math.hypot(v[0],v[1]);v[0]=v[0]/y,v[1]=v[1]/y;const m=c*(p+1);n[s.id][0]-=m*v[0],n[s.id][1]-=m*v[1]}return n}updatePos(t,e,r,n,o){const{ks:i,tao:s,prune:a,ksmax:u}=o,c=t.getAllNodes(),h=c.length,d=[],l=[];let f=0,g=0,p=n;for(let y=0;y<h;y+=1){const{id:n}=c[y],o=t.getDegree(n);if(a&&o<=1)continue;const i=[e[n][0]-r[n][0],e[n][1]-r[n][1]],s=Math.hypot(i[0],i[1]),u=[e[n][0]+r[n][0],e[n][1]+r[n][1]],h=Math.hypot(u[0],u[1]);d[y]=s,l[y]=h/2,f+=(o+1)*d[y],g+=(o+1)*l[y]}const v=p;p=s*g/f,0!==v&&(p=p>1.5*v?1.5*v:p);for(let y=0;y<h;y+=1){const{id:r,data:n}=c[y],o=t.getDegree(r);if(a&&o<=1)continue;if(D(n.fx)&&D(n.fy))continue;let s=i*p/(1+p*Math.sqrt(d[y])),h=Math.hypot(e[r][0],e[r][1]);h=h<1e-4?1e-4:h;const l=u/h;s=s>l?l:s;const f=s*e[r][0],g=s*e[r][1];t.mergeNodeData(r,{x:n.x+f,y:n.y+g})}return p}},dagre:Qw,antvDagre:class{constructor(t={}){this.options=t,this.id="antv-dagre",this.options=Object.assign(Object.assign({},$e),t)}execute(t,e){return o(this,void 0,void 0,(function*(){return this.genericDagreLayout(!1,t,e)}))}assign(t,e){return o(this,void 0,void 0,(function*(){yield this.genericDagreLayout(!0,t,e)}))}genericDagreLayout(t,e,r){return o(this,void 0,void 0,(function*(){const n=Object.assign(Object.assign({},this.options),r),{nodeSize:o,align:i,rankdir:s="TB",ranksep:a,nodesep:u,ranksepFunc:c,nodesepFunc:d,edgeLabelSpace:l,ranker:f,nodeOrder:g,begin:p,controlPoints:v,radial:y,sortByCombo:m,preset:w}=n,b=new h({tree:[]}),x=Ge(a||50,c),E=Ge(u||50,d);let N=E,_=x;"LR"!==s&&"RL"!==s||(N=x,_=E);const M=Be(10,o,!1),k=e.getAllNodes(),A=e.getAllEdges();let j;k.forEach((t=>{const e=Ve(M(t)),r=_(t),n=N(t),o=e[0]+2*n,i=e[1]+2*r,s=t.data.layer;D(s)?b.addNode({id:t.id,data:{width:o,height:i,layer:s}}):b.addNode({id:t.id,data:{width:o,height:i}})})),m&&(b.attachTreeStructure("combo"),k.forEach((t=>{const{parentId:e}=t.data;void 0!==e&&b.hasNode(e)&&b.setParent(t.id,e,"combo")}))),A.forEach((t=>{b.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),(null==w?void 0:w.length)&&(j=new h({nodes:w})),((t,e)=>{const{edgeLabelSpace:r,keepNodeOrder:n,prevGraph:o,rankdir:i,ranksep:s}=e;!n&&o&&le(t,o);const a=we(t);let u;r&&(e.ranksep=be(a,{rankdir:i,ranksep:s}));try{u=de(a,e)}catch(Eb){if("Not possible to find intersection inside of the rectangle"===Eb.message)return;throw Eb}fe(t,a)})(b,{prevGraph:j,edgeLabelSpace:l,keepNodeOrder:!!g,nodeOrder:g||[],acyclicer:"greedy",ranker:f,rankdir:s,nodesep:u,align:i});const S=[0,0];if(p){let t=1/0,e=1/0;b.getAllNodes().forEach((r=>{t>r.data.x&&(t=r.data.x),e>r.data.y&&(e=r.data.y)})),b.getAllEdges().forEach((r=>{var n;null===(n=r.data.points)||void 0===n||n.forEach((r=>{t>r.x&&(t=r.x),e>r.y&&(e=r.y)}))})),S[0]=p[0]-t,S[1]=p[1]-e}const O="LR"===s||"RL"===s;if(y);else{const t=new Set,e="BT"===s||"RL"===s?(t,e)=>e-t:(t,e)=>t-e;b.getAllNodes().forEach((e=>{e.data.x=e.data.x+S[0],e.data.y=e.data.y+S[1],t.add(O?e.data.x:e.data.y)}));const r=Array.from(t).sort(e),n=O?(t,e)=>t.x!==e.x:(t,e)=>t.y!==e.y,o=O?(t,e,r)=>{const n=Math.max(e.y,r.y),o=Math.min(e.y,r.y);return t.filter((t=>t.y<=n&&t.y>=o))}:(t,e,r)=>{const n=Math.max(e.x,r.x),o=Math.min(e.x,r.x);return t.filter((t=>t.x<=n&&t.x>=o))};b.getAllEdges().forEach(((t,e)=>{var i;l&&v&&"loop"!==t.data.type&&(t.data.controlPoints=We(null===(i=t.data.points)||void 0===i?void 0:i.map((({x:t,y:e})=>({x:t+S[0],y:e+S[1]}))),b.getNode(t.source),b.getNode(t.target),r,O,n,o))}))}let z=[];z=b.getAllNodes().map((t=>qe(t)));const R=b.getAllEdges();t&&(z.forEach((t=>{e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),R.forEach((t=>{e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})})));return{nodes:z,edges:R}}))}},comboCombined:class{constructor(t={}){this.options=t,this.id="comboCombined",this.options=Object.assign(Object.assign({},In),t)}execute(t,e){return o(this,void 0,void 0,(function*(){return this.genericComboCombinedLayout(!1,t,e)}))}assign(t,e){return o(this,void 0,void 0,(function*(){yield this.genericComboCombinedLayout(!0,t,e)}))}genericComboCombinedLayout(t,e,r){return o(this,void 0,void 0,(function*(){const n=this.initVals(Object.assign(Object.assign({},this.options),r)),{center:o,treeKey:i,outerLayout:s}=n,a=e.getAllNodes().filter((t=>!t.data._isCombo)),u=e.getAllNodes().filter((t=>t.data._isCombo)),c=e.getAllEdges(),d=null==a?void 0:a.length;if(!d||1===d)return Ye(e,t,o);const l=[],f=new Map;a.forEach((t=>{f.set(t.id,t)}));const g=new Map;u.forEach((t=>{g.set(t.id,t)}));const p=new Map,v=this.getInnerGraphs(e,i,f,g,c,n,p);yield Promise.all(v);const y=new Map,m=[],w=new Map;let b=!0;e.getRoots(i).forEach((t=>{const r=p.get(t.id),n=g.get(t.id)||f.get(t.id),o={id:t.id,data:Object.assign(Object.assign({},t.data),{x:r.data.x||n.data.x,y:r.data.y||n.data.y,fx:r.data.fx||n.data.fx,fy:r.data.fy||n.data.fy,mass:r.data.mass||n.data.mass,size:r.data.size})};m.push(o),y.set(t.id,!0),isNaN(o.data.x)||0===o.data.x||isNaN(o.data.y)||0===o.data.y?(o.data.x=100*Math.random(),o.data.y=100*Math.random()):b=!1,Fe(e,[t],(e=>{e.id!==t.id&&w.set(e.id,t.id)}),"TB",i)}));const x=[];let E;if(c.forEach((t=>{const e=w.get(t.source)||t.source,r=w.get(t.target)||t.target;e!==r&&y.has(e)&&y.has(r)&&x.push({id:t.id,source:e,target:r,data:{}})})),null==m?void 0:m.length){if(1===m.length)m[0].data.x=o[0],m[0].data.y=o[1];else{const t=new h({nodes:m,edges:x}),e=s||new xr;if(b&&Rn[e.id]){const e=m.length<100?new jn:new Xe;yield e.assign(t)}const r=Object.assign({center:o,kg:5,preventOverlap:!0,animate:!1},"force"===e.id?{gravity:1,factor:4,linkDistance:(t,e,r)=>(Math.max(...e.data.size)||32)/2+(Math.max(...r.data.size)||32)/2+200}:{});E=yield Cn(e,t,r)}p.forEach((t=>{var e;const r=E.nodes.find((e=>e.id===t.id));if(r){const{x:e,y:n}=r.data;t.data.visited=!0,t.data.x=e,t.data.y=n,l.push({id:t.id,data:{x:e,y:n}})}const{x:n,y:o}=t.data;null===(e=t.data.nodes)||void 0===e||e.forEach((t=>{l.push({id:t.id,data:{x:t.data.x+n,y:t.data.y+o}})}))})),p.forEach((({data:t})=>{const{x:e,y:r,visited:n,nodes:o}=t;null==o||o.forEach((t=>{if(!n){const n=l.find((e=>e.id===t.id));n.data.x+=e||0,n.data.y+=r||0}}))}))}t&&l.forEach((t=>{e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}));return{nodes:l,edges:c}}))}initVals(t){const e=Object.assign({},t),{nodeSize:r,spacing:n,comboPadding:o}=t;let i,s,a;if(s=D(n)?()=>n:O(n)?n:()=>0,e.spacing=s,r)if(O(r))i=t=>{const e=r(t),n=s(t);if(Ce(t.size)){return((t.size[0]>t.size[1]?t.size[0]:t.size[1])+n)/2}return((e||32)+n)/2};else if(Ce(r)){const t=(r[0]>r[1]?r[0]:r[1])/2;i=e=>t+s(e)/2}else{const t=r/2;i=e=>t+s(e)/2}else i=t=>{const e=s(t);if(t.size){if(Ce(t.size)){return((t.size[0]>t.size[1]?t.size[0]:t.size[1])+e)/2}if(R(t.size)){return((t.size.width>t.size.height?t.size.width:t.size.height)+e)/2}return(t.size+e)/2}return 32+e/2};return e.nodeSize=i,a=D(o)?()=>o:Ce(o)?()=>Math.max.apply(null,o):O(o)?o:()=>0,e.comboPadding=a,e}getInnerGraphs(t,e,r,n,i,s,a){const{nodeSize:u,comboPadding:c,spacing:d,innerLayout:l}=s,f=l||new Xe({}),g={center:[0,0],preventOverlap:!0,nodeSpacing:d},p=[],v=t=>{let e=(null==c?void 0:c(t))||10;return Ce(e)&&(e=Math.max(...e)),{size:e?[2*e,2*e]:[30,30],padding:e}};return t.getRoots(e).forEach((s=>{a.set(s.id,{id:s.id,data:{nodes:[],size:v(s).size}});let c=Promise.resolve();Fe(t,[s],(s=>{var d;if(!s.data._isCombo)return;const{size:l,padding:p}=v(s);if(null===(d=t.getChildren(s.id,e))||void 0===d?void 0:d.length){const d=a.get(s.id);a.set(s.id,{id:s.id,data:Object.assign({nodes:[]},null==d?void 0:d.data)});const l=new Map,v=t.getChildren(s.id,e).map((t=>{if(t.data._isCombo)return a.has(t.id)||a.set(t.id,{id:t.id,data:Object.assign({},t.data)}),l.set(t.id,!0),a.get(t.id);const e=r.get(t.id)||n.get(t.id);return l.set(t.id,!0),{id:t.id,data:Object.assign(Object.assign({},e.data),t.data)}})),y={nodes:v,edges:i.filter((t=>l.has(t.source)&&l.has(t.target)))};let m=1/0;v.forEach((t=>{var e;let{size:r}=t.data;r||(r=(null===(e=a.get(t.id))||void 0===e?void 0:e.data.size)||(null==u?void 0:u(t))||[30,30]),D(r)&&(r=[r,r]);const[n,o]=r;m>n&&(m=n),m>o&&(m=o),t.data.size=r})),c=c.then((()=>o(this,void 0,void 0,(function*(){const t=new h(y);yield Cn(f,t,g,!0);const{minX:e,minY:r,maxX:n,maxY:o}=(t=>{let e=1/0,r=1/0,n=-1/0,o=-1/0;return t.forEach((t=>{let i=t.data.size;Ce(i)?1===i.length&&(i=[i[0],i[0]]):D(i)?i=[i,i]:(void 0===i||isNaN(i))&&(i=[30,30]);const s=[i[0]/2,i[1]/2],a=t.data.x-s[0],u=t.data.x+s[0],c=t.data.y-s[1],h=t.data.y+s[1];e>a&&(e=a),r>c&&(r=c),n<u&&(n=u),o<h&&(o=h)})),{minX:e,minY:r,maxX:n,maxY:o}})(v),i=(n+e)/2,u=(o+r)/2;y.nodes.forEach((t=>{t.data.x-=i,t.data.y-=u}));const c=[Math.max(n-e,m)+2*p,Math.max(o-r,m)+2*p];a.get(s.id).data.size=c,a.get(s.id).data.nodes=v}))))}else a.set(s.id,{id:s.id,data:Object.assign(Object.assign({},s.data),{size:l})});return!0}),"BT",e),p.push(c)})),p}}};let xb;m({stopLayout(){(null==xb?void 0:xb.stop)&&xb.stop()},calculateLayout(t,e){return o(this,void 0,void 0,(function*(){const{layout:{id:r,options:n,iterations:o},nodes:i,edges:s}=t,a=new h({nodes:i,edges:s}),u=bb[r];if(!u)throw new Error(`Unknown layout id: ${r}`);xb=new u(n);let c=yield xb.execute(a);return zn(xb)&&(xb.stop(),c=xb.tick(o)),[c,e]}))}})}();
